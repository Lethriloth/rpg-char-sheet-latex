\InitializeCohort
\centering\begin{picture}(420,558)

\ProvideDocumentCommand{\exbox}{d() m}{\color{blue!30}\framebox(#1){#2}}
%\RenewDocumentCommand{\exbos}{d() m}{}

\put(0,0){\exbox(420,558){}}
\put(0,505){
	\titlebox{0}{43}{143}{Leadership}{Score}
	\ScaleAttributeLabels(48,38){TOTAL,Level,\AbilityFullName{\CharLeadershipKeyAbility},Reputation,Misc}{20}
	\put(0,27){%
		\titlebox{0}{0}{45}{BASE}{Leadership Score}
		\equalattributes{43}{0}{\arabic{CharTotalLevelCount},\arabic{Char\CharLeadershipKeyAbility ModCount}, \arabic{CharLeadershipScoreReputationCount},\arabic{CharLeadershipScoreMiscCount}}{20}
	}
	\put(0,14){
		\titlebox{0}{0}{45}{COHORT}{Leadership Score}
		\equalattributes{43}{0}{\arabic{CharTotalLevelCount},\arabic{Char\CharLeadershipKeyAbility ModCount}, \arabic{CharCohortLeadershipScoreReputationCount},\arabic{CharCohortLeadershipScoreMiscCount}}{20}
	}
	\put(0,1){
		\titlebox{0}{0}{45}{FOLLOWER}{Leadership Score}
		\equalattributes{43}{0}{\arabic{CharTotalLevelCount},\arabic{Char\CharLeadershipKeyAbility ModCount}, \arabic{CharFollowerLeadershipScoreReputationCount},\arabic{CharFollowerLeadershipScoreMiscCount}}{20}
	}
}

\DeclareDocumentCommand{\PrintListItemInternal}{m m m m}{%
	\IfBooleanTF{#1}{%
		#2\ifthenelse{#3=1}{}{ ($\times #3$)}\dotfill\MathPM{#3 * #4}\\%
	}{
		\grayout{#2\ifthenelse{#3=1}{}{ ($\times #3$)}\dotfill\MathPM{#3 * #4}\\}%
	}
}
\DeclareDocumentCommand{\PrintListItem}{>{\SplitArgument{3}{|}} m}{%
	\PrintListItemInternal #1%
}
\put(145,505) {%
	\parbox[b][53\unitlength][t]{135\unitlength}{\centering\itshape%
			{\fmmfamily\large Reputation Modifiers}\\%
			\footnotesize%
			\forlistloop{\PrintListItem}{\CharLeadershipReputationModifiersList}%
	}%
}
\put(283,505) {%
	\parbox[b][53\unitlength][t]{135\unitlength}{\centering\itshape%
		{\fmmfamily \normalsize Cohort Reputation Modifiers}\\%
		\scriptsize%
		\forlistloop{\PrintListItem}{\CharCohortLeadershipReputationModifiersList}%
		{\fmmfamily \normalsize Follower Reputation Modifiers}\\%
		\forlistloop{\PrintListItem}{\CharFollowerLeadershipReputationModifiersList}%
	}
}

\put(0,456){%% Cohort Name, Description, etc.
	\singletitlebox{0}{34}{420}{12}{COHORT}
	\setlength\tabcolsep{3\unitlength}%
	\setlength\cmidrulekern{\tabcolsep}%
	\put(0,1){%
		\renewcommand{\arraystretch}{.9}%
		\begin{tabular}[b]{ @{} D{55} D{55} D{55} D{55} D{55}  D{55}@{}}%
		\multicolumn{2}{@{}D{116}}{\CohortName} &\CohortAlignment & \multicolumn{3}{D{170}}{\CohortLevel} \\[-3\unitlength]
		\cmidrule(r){1-2}\cmidrule(lr){3-3}\cmidrule(lr){4-6}\\
		\CohortSize &  \CohortRace & \CohortHomeland & \CohortGender & \CohortReligion &\CohortAge \\[-3\unitlength]
		\cmidrule(r){1-1}\cmidrule(lr){2-2}\cmidrule(lr){3-3}\cmidrule(lr){4-4} \cmidrule(lr){5-5}\cmidrule(lr){6-6}
		\end{tabular}%
	}%
	\put(0,0){\renewcommand{\arraystretch}{1.9}%
		\begin{tabular}[b]{ @{} D{55} D{55} D{55} D{55} D{55}  D{55}@{}}%
		\multicolumn{2}{@{}D{116}}{\lfont Cohort Name} & \lfont Cohort Alignment & \multicolumn{3}{D{170}}{\lfont Cohort Class and Level} \\
		\lfont Cohort Size & \lfont Cohort Race/Species & \lfont Cohort Homeland  & \lfont Cohort Gender & \lfont Cohort Religion & \lfont Cohort Age
		\end{tabular}
	}
}

\put(0,433){%% Ability Scores
	%% STR
	\put(0,0){
		\titlebox{0}{10}{35}{Str}{}
		\scaleattributelabels{-5}{7}{Score,Modifier}{20}
		\scaleattributes{-5}{0}{\Arabic{CohortStrCount},\PlusMinus{CohortStrModCount}}{20}
	}
	\put(40,0){
		\titlebox{0}{10}{35}{Dex}{}
		\scaleattributelabels{-5}{7}{Score,Modifier}{20}
		\scaleattributes{-5}{0}{\Arabic{CohortDexCount},\PlusMinus{CohortDexModCount}}{20}
	}
	\put(80,0){
		\titlebox{0}{10}{35}{Con}{}
		\scaleattributelabels{-5}{7}{Score,Modifier}{20}
		\scaleattributes{-5}{0}{\Arabic{CohortConCount},\PlusMinus{CohortConModCount}}{20}
	}
	\put(120,0){
		\titlebox{0}{10}{35}{Int}{}
		\scaleattributelabels{-5}{7}{Score,Modifier}{20}
		\scaleattributes{-5}{0}{\Arabic{CohortIntCount},\PlusMinus{CohortIntModCount}}{20}
	}
	\put(160,0){
		\titlebox{0}{10}{35}{Wis}{}
		\scaleattributelabels{-5}{7}{Score,Modifier}{20}
		\scaleattributes{-5}{0}{\Arabic{CohortWisCount},\PlusMinus{CohortWisModCount}}{20}
	}
	\put(200,0){
		\titlebox{0}{10}{35}{Cha}{}
		\scaleattributelabels{-5}{7}{Score,Modifier}{20}
		\scaleattributes{-5}{0}{\Arabic{CohortChaCount},\PlusMinus{CohortChaModCount}}{20}
	}
}



\put(0,390){%% AC
	\scaleattributelabels{29}{31}{TOTAL,Base,Armor ,Shield, Natural, Dex ,Dodge, Misc}{20}
	\put(0,24){
		\titlebox{0}{0}{32}{AC}{Armour Class}
		\EqualAttributes{34}{0}{10,\value{CohortArmorBonusCount},\value{CohortShieldBonusCount},\arabic{CohortNaturalArmorModCount}, \arabic{CohortDextoACCount} , \arabic{CohortDodgeModCount},\arabic{CohortSizeModCount} + \arabic{CohortDeflectionModCount} + \arabic{CohortACMiscCount}}{20}
	}
	
	% Touch, Flat footed
	\put(0,12){
		\titlebox{0}{0}{32}{TOUCH}{Armour Class}
		\EqualAttributes{34}{0}{10,{},{},{}, \arabic{CohortDextoACCount} , \arabic{CohortDodgeModCount},\arabic{CohortSizeModCount} + \arabic{CohortDeflectionModCount} + \arabic{CohortACMiscCount}}{20}
	}
	\put(0,0){
		\titlebox{0}{0}{32}{\fontsize{6}{7}\selectfont Flat-Footed}{Armour Class}
		\EqualAttributes{34}{0}{10,\value{CohortArmorBonusCount},\value{CohortShieldBonusCount},\arabic{CohortNaturalArmorModCount},{},{},\arabic{CohortSizeModCount} + \arabic{CohortDeflectionModCount} + \arabic{CohortACMiscCount}}{20}
	}
}
\put(192,390){% % Saves
	\scaleattributelabels{46}{33}{\phantom{\&}\\TOTAL, Base\\Save, Ability\\Modifier, Misc\\Modifier}{20}
	\put(0,24){
		\titlebox{0}{0}{48}{Fortitude}{(Constitution)}
		\equalattributes{46}{0}{\arabic{CohortFortitudeCount},\arabic{CohortConModCount},\arabic{CohortFortitudeMiscCount}}{20}
	}
	\put(0,12){
		\titlebox{0}{0}{48}{Reflex}{(Dexterity)}
		\equalattributes{46}{0}{\arabic{CohortReflexCount},\arabic{CohortDexModCount},\arabic{CohortReflexMiscCount}}{20}
	}
	\put(0,0){
		\titlebox{0}{0}{48}{Will}{(Wisdom)}  
		\equalattributes{46}{0}{\arabic{CohortWillCount},\arabic{CohortWisModCount},\arabic{CohortWillMiscCount}}{20}
	}
}

\put(321,390){% % BAB, CMB/CMD or Grapple
	\IfCounter{CohortCMBMiscCount}{
		\put(0,0){\exbox(99,40){}}
		\put(0,30){
			\titlebox{0}{0}{23}{INIT}{Initiative}
			\put(25,0){\framebox(15,9){\MathPM{\value{CohortInitiativeMiscCount} + \value{CohortDexModCount}}}}
		}
		\put(42,30){
			\titlebox{0}{0}{40}{BAB}{Base Attack Bonus}
			\put(42,0){\framebox(15,9){\Arabic{CohortBABCount}}}
		}
		\ScaleAttributeLabels(30,25){TOTAL,Base, Ability, Misc}{18}
		\put(0,14){
			\singletitlebox{0}{-1}{28}{11}{CMB}
			\EqualAttributes{30}{0}{\arabic{CohortBABCount},\arabic{CohortStrModCount},\arabic{CohortSpecialSizeModCount}+\arabic{CohortCMBMiscCount}}{18}
		}
		\put(0,1){
			\singletitlebox{0}{-1}{28}{11}{CMD}
			\EqualAttributes{30}{0}{\arabic{CohortBABCount}+10,\value{CohortStrModCount}+\value{CohortDexModCount},\arabic{CohortSpecialSizeModCount}+\arabic{CohortCMDMiscCount}}{18}
		}
	}{\IfCounter{CohortGrappleMiscCount}{%
		\put(0,0){\exbox(99,40){}}
		\put(0,31){
			\singletitlebox{0}{0}{82}{9}{Base Attack Bonus}
			\put(84,0){\framebox(15,9){\Arabic{CohortBABCount}}}
		}

		\put(0,17){
			\ScaleAttributeLabels(30,11){TOTAL,BAB, Str, Misc}{18}
			\titlebox{0}{0}{28}{\footnotesize Grapple}{Modifier}
			\EqualAttributes{30}{0}{\arabic{CohortBABCount},\arabic{CohortStrModCount},\arabic{CohortSpecialSizeModCount}+\arabic{CohortGrappleMiscCount}}{18}
		}
		\put(0,1){
			\titlebox{0}{0}{42}{Initiative}{Modifier}
			\ScaleAttributeLabels(44,11){TOTAL, Dex, Misc}{20}
			\EqualAttributes{44}{0}{\arabic{CohortDexModCount},\arabic{CohortInitiativeMiscCount}}{20}
		}
	}}
}


\newcommand{\PrintCohortSkill}[1]{\IfSkillDefaultF[Cohort]{#1}{\IfBooleanTF\PrintListFirstItem{\let\PrintListFirstItem\BooleanFalse}{, }\cs{Skill#1DisplayName} \PlusMinus{Cohort#1Count}}}
\let\PrintListFirstItem\BooleanTrue

\put(192,347){
	\put(0,0){\exbox(228,40){}}
	\put(1,1){\parbox[b][38\unitlength][t]{226\unitlength}{\textit{%
		\textbf{Skills: }%
		\forlistloop{%
			\PrintCohortSkill%
		}{\SkillsList}%
	}}}
}

\put(192,304){
	\put(0,0){\exbox(228,40){}}
	\put(1,1){\parbox[b][38\unitlength][t]{226\unitlength}{\textit{\textbf{Feats: }\PrintList{\CohortFeatsList}}}}
}
\put(192,261){
	\put(0,0){\exbox(228,40){}}
	\put(1,1){\parbox[b][38\unitlength][t]{226\unitlength}{\textit{\textbf{Special Qualitites: }\PrintList{\CohortSpecialQualityList}}}}
}
\newcommand{\PrintCohortAttack}[1]{%
	\begin{tabular}[b]{A{15}A{25}A{55}A{45}A{25}A{25}}%
	\multicolumn{3}{A{95}}{\itshape \cs{CohortAttack#1Name}} & \cs{CohortAttack#1AttackBonus} & \cs{CohortAttack#1Damage} &\cs{CohortAttack#1Critical} \tabularnewline\hline\\[-16pt]
	\multicolumn{3}{A{95}}{\tiny\scshape ATTACK} &\tiny\scshape  attack Bonus &\tiny\scshape Damage &\tiny\scshape  Critical  \tabularnewline
	\itshape \cs{CohortAttack#1Type} &  \cs{CohortAttack#1Range} & \multicolumn{4}{A{150}}{\cs{CohortAttack#1Notes}}  \tabularnewline\hline\\[-16pt]
	\tiny\scshape Type & \tiny\scshape Range &\multicolumn{4}{A{150}} {\tiny\scshape ammunition \& Notes } \tabularnewline
	\end{tabular}
}
\put(0,279){%
	\put(0,76){\PrintCohortAttack{One}}
	\put(0,38){\PrintCohortAttack{Two}}
	\put(0,0){\PrintCohortAttack{Three}}
}
\put(0,236){
	\put(0,0){\exbox(190,40){}}
	\put(1,1){\parbox[b][38\unitlength][t]{188\unitlength}{\textit{\textbf{Special Attacks: }\PrintList{\CohortSpecialAttackList}}}}
}


\put(240,433){\exbox(120,21){Bro.}}
\put(360,433){\exbox(60,57){Whitespace bad.}}

\end{picture}