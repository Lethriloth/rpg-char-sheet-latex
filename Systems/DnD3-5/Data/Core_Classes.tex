% % Core Classes
\def\BarbarianBAB{g}
\def\BarbarianFort{g}
\def\BarbarianRef{p}
\def\BarbarianWill{p}
\newCounter{BarbarianSkillRanksPerLevelCount}
\setCounter{BarbarianSkillRanksPerLevelCount}{2}
\newCounter{BarbarianHitDieSize}
\setCounter{BarbarianHitDieSize}{12}
\edef\BarbarianClassSkillsList{}
\forcsvlist{\listadd{\BarbarianClassSkillsList}}{Climb, Craft, HandleAnimal, Intimidate, Jump, Listen, Ride, Survival, Swim}
\newcommand{\addBarbarianClassFeatures}[1]{
		\addClassFeature{Fast Movement}\addToCounter{charBaseSpeedCount}{10}
		\addLimitedUse{%
			\ifthenelse{#1 > 10}{\ifthenelse{#1 > 19}{Mighty }{Greater }}{}%
			Rage}{\domath{#1 / 4 + 1}}
			\newcommand{\IWouldLikeToRage}{
				\TmpBonus{AC}{-2}
				\ifthenelse{#1 > 10}{\ifthenelse{#1 > 19}{
					\TmpBonus{Con}{8}\TmpBonus{str}{8}\TmpBonus[morale]{Will}{4} %Mighty Rage
				}{
					\TmpBonus{Con}{6}\TmpBonus{str}{6}\TmpBonus[morale]{Will}{3} %Greater Rage
				}}{
					\TmpBonus{Con}{4}\TmpBonus{str}{4}\TmpBonus[morale]{Will}{2} %Rage
				}
				\ifthenelse{#1 > 13}{
					\addConditionalDefMod{+4 vs. Enchantments}
				}{}
			}
	\ifthenelse{#1 > 1}{
		\addClassFeature{\ifthenelse{#1 > 4}{Improved }{}Uncanny Dodge}
			\ifthenelse{#1 > 4}{\addConditionalDefMod{Improved Uncanny Dodge}}{\addConditionalDefMod{Uncanny Dodge}}
	\ifthenelse{#1 > 2}{
		\addClassFeature{Trap Sense +\domath{#1 / 3}}\addConditionalDefMod{+\domath{#1 / 3} vs. traps}
	\ifthenelse{#1 > 6}{
		\addClassFeature{Damage Reduction}\domath*{(#1 - 4) / 3}\addDR{--}{\value{@domathCounter}}
	\ifthenelse{#1 > 13}{
		\addClassFeature{Indomitable Will}
	\ifthenelse{#1 > 16}{
		\addClassFeature{Tireless Rage}
	}{}}{}}{}}{}}{}
}

\def\BardBAB{a}
\def\BardFort{p}
\def\BardRef{g}
\def\BardWill{g}
\newCounter{BardSkillRanksPerLevelCount}
\setCounter{BardSkillRanksPerLevelCount}{6}
\newCounter{BardHitDieSize}
\setCounter{BardHitDieSize}{6}
\edef\BardClassSkillsList{}
\forcsvlist{\listadd{\BardClassSkillsList}}{Appraise, Balance, Bluff, Climb, Concentration, Craft, DecipherScript, Diplomacy, Disguise, EscapeArtist, GatherInformation, Hide, Jump, KnowledgeAll, Listen, MoveSilently, Perform, Profession, SenseMotive, SleightOfHand, SpeakLanguage, Spellcraft, Swim, Tumble, UseMagicDevice}
\newcommand{\addBardClassFeatures}[1]{
	\edef\charBardicMusicList{}
	\addClassFeature{Bardic Music\forlistloop{\\~~~~}{\charBardicMusicList}}
	\addLimitedUse{Bardic Music}{#1}
		\appto{\Initialize}{ %Bardic music dependent on # of Perform Ranks goes here
			\ifthenelse{\value{charPerformOneRanksCount} > 2}{
				\listadd{\charBardicMusicList}{Countersong}
				\listadd{\charBardicMusicList}{Fascinate}
				\listadd{\charBardicMusicList}{Inspire Courage +\domath{(#1 - 2) / 6 + 1}}
			}{}
		}
	\ifthenelse{\value{charKnowledgeHistoryRanksCount} > 4}{
		\addClassFeature{Bardic Knowledge +\domath{#1 + \value{charIntModCount} + 2}}
	}{
		\addClassFeature{Bardic Knowledge +\domath{#1 + \value{charIntModCount}}}
	}
	\ifthenelse{#1 > 2}{
		\appto{\Initialize}{ %Bardic music dependent on # of Perform Ranks goes here
			\ifthenelse{\value{charPerformOneRanksCount} > 5}{
				\listadd{\charBardicMusicList}{Inspire Competence}
			}{}}
	\ifthenelse{#1 > 5}{
		\appto{\Initialize}{ %Bardic music dependent on # of Perform Ranks goes here
			\ifthenelse{\value{charPerformOneRanksCount} > 8}{
				\listadd{\charBardicMusicList}{\ifthenelse{#1 > 17}{\ifthenelse{\value{charPerformOneRanksCount} > 20}{Mass }{}}{}Suggestion}
			}{}}
	\ifthenelse{#1 > 8}{
		\appto{\Initialize}{ %Bardic music dependent on # of Perform Ranks goes here
			\ifthenelse{\value{charPerformOneRanksCount} > 11}{
				\listadd{\charBardicMusicList}{Inspire Greatness}
			}{}}
	\ifthenelse{#1 > 11}{
		\appto{\Initialize}{ %Bardic music dependent on # of Perform Ranks goes here
			\ifthenelse{\value{charPerformOneRanksCount} > 14}{
				\listadd{\charBardicMusicList}{Song of Freedom}
			}{}}
	\ifthenelse{#1 > 14}{
		\appto{\Initialize}{ %Bardic music dependent on # of Perform Ranks goes here
			\ifthenelse{\value{charPerformOneRanksCount} > 17}{
				\listadd{\charBardicMusicList}{Inspire Heroics}
			}{}}
	}{}}{}}{}}{}}{}
	\newcommand{\addBardSpellcasting}[1]{
		\ifthenelse{##1 < 2}{\setCounter{@i}{0}}{
		\ifthenelse{##1 < 4}{\setCounter{@i}{1}}{
		\ifthenelse{##1 < 7}{\setCounter{@i}{2}}{
		\ifthenelse{##1 < 10}{\setCounter{@i}{3}}{
		\ifthenelse{##1 < 13}{\setCounter{@i}{4}}{
		\ifthenelse{##1 < 16}{\setCounter{@i}{5}}{\setCounter{@i}{6}}}}}}}
		\newSpellcasting[\value{@i}]{Bard}{##1}{cha}
		\addtwothirdsSpellcasing{##1}
	}
}

\def\ClericBAB{a}
\def\ClericFort{g}
\def\ClericRef{p}
\def\ClericWill{g}
\newCounter{ClericSkillRanksPerLevelCount}
\setCounter{ClericSkillRanksPerLevelCount}{2}
\newCounter{ClericHitDieSize}
\setCounter{ClericHitDieSize}{8}
\edef\ClericClassSkillsList{}
\forcsvlist{\listadd{\ClericClassSkillsList}}{Concentration, Craft, Diplomacy, Heal, KnowledgeArcana, KnowledgeHistory, KnowledgePlanes, KnowledgeReligion, Profession, Spellcraft}
\newcommand{\addClericClassFeatures}[1]{
	\newCounter{charturnrebukeundeadusesCount}
	\setCounter{charturnrebukeundeadusesCount}{3 + \value{charChaModCount}}
	\addLimitedUse{Turn/Rebuke Undead}{\arabic{charturnrebukeundeadusesCount}}
	\newcommand{\addClericSpellcasting}[3]{
		\newSpellcasting[(##1 + 1) / 2]{Cleric}{##1}{Wis}
		\addprimarySpellcasting{##1}
		\forloop{@i}{1}{\value{@i}<10}{
			\addBonusSpellSlots{\arabic{@i}}{1}
		}
		\addSpellcastingSpecialization[Domain]{##2}
		\addSpellcastingSpecialization[Domain]{##3}
	}
}

\def\DruidBAB{a}
\def\DruidFort{g}
\def\DruidRef{p}
\def\DruidWill{g}
\newCounter{DruidSkillRanksPerLevelCount}
\setCounter{DruidSkillRanksPerLevelCount}{4}
\newCounter{DruidHitDieSize}
\setCounter{DruidHitDieSize}{8}
\edef\DruidClassSkillsList{}
\forcsvlist{\listadd{\DruidClassSkillsList}}{Concentration, Craft, Diplomacy, HandleAnimal, Heal, KnowledgeNature, Listen, Profession, Ride, Spellcraft, Spot, Survival, Swim}
\newcommand{\addDruidClassFeatures}[1]{
	\addClassFeature{Animal Companion}
	\addClassFeature{Nature Sense}\MiscBonus{KnowledgeNature}{2}\MiscBonus{Survival}{2}
	\ifthenelse{\value{charHandleAnimalRanksCount} > 4}{
		\addClassFeature{Wild Empathy +\domath{#1 + \value{charChaModCount} + 2}}
	}{
		\addClassFeature{Wild Empathy +\domath{#1 + \value{charChaModCount}}}
	}
	\ifthenelse{#1 > 1}{
		\addClassFeature{Woodland Stride}
	\ifthenelse{#1 > 2}{
		\addClassFeature{Trackless Step}
	\ifthenelse{#1 > 3}{
		\addClassFeature{Resist Nature's Lure}
			\addConditionalDefMod{+4 to saves vs. Spell-like abilities of fey}
	\ifthenelse{#1 > 4}{
		\newCounter{charWildShapeUsesCount}
		\stepCounter{charWildShapeUsesCount}
		\addLimitedUse{Wild Shape}{\arabic{charWildShapeUsesCount}}
		\addClassFeature{Wild Shape \ifthenelse{#1 > 7}{(\ifthenelse{#1 > 14}{Huge}{Large}\ifthenelse{#1 > 10}{, Tiny}{}\ifthenelse{#1 > 11}{, Plant}{})}{}}
	\ifthenelse{#1 > 5}{
		\stepCounter{charWildShapeUsesCount}
	\ifthenelse{#1 > 6}{
		\stepCounter{charWildShapeUsesCount}
	\ifthenelse{#1 > 8}{
		\addClassFeature{Venom Immunity}
		\addImmunity{poison}
	\ifthenelse{#1 > 9}{
		\stepCounter{charWildShapeUsesCount}
	\ifthenelse{#1 > 12}{
		\addClassFeature{A Thousand Faces}
	\ifthenelse{#1 > 13}{
		\stepCounter{charWildShapeUsesCount}
	\ifthenelse{#1 > 14}{
		\addClassFeature{Timeless Body}
	\ifthenelse{#1 > 15}{
		\addClassFeature{\ifthenelse{#1 > 19}{Huge }{}Elemental Wild Shape}
		\addLimitedUse{Elemental Wild Shape}{\domath{(#1 - 14) / 2}}
	\ifthenelse{#1 > 17}{
		\stepCounter{charWildShapeUsesCount}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
	\newcommand{\addDruidSpellcasting}[1]{
		\newSpellcasting[(##1 + 1) / 2]{Druid}{##1}{Wis}
		\addprimarySpellcasting{##1}
	}
}

\def\FighterBAB{g}
\def\FighterFort{g}
\def\FighterRef{p}
\def\FighterWill{p}
\newCounter{FighterSkillRanksPerLevelCount}
\setCounter{FighterSkillRanksPerLevelCount}{2}
\newCounter{FighterHitDieSize}
\setCounter{FighterHitDieSize}{10}
\edef\FighterClassSkillsList{}
\forcsvlist{\listadd{\FighterClassSkillsList}}{Climb, Craft, HandleAnimal, Intimidate, Jump, Ride, Swim}
\newcommand{\addFighterClassFeatures}[1]{
	\addToCounter{charBonusFeatsCount}{#1 / 2 +1}
	\addClassFeature{Fighter Bonus Feat\ifthenelse{#1 > 1}{ $\times\domath{#1 / 2 +1}$}{}}
}

\def\MonkBAB{a}
\def\MonkFort{g}
\def\MonkRef{g}
\def\MonkWill{g}
\newCounter{MonkSkillRanksPerLevelCount}
\setCounter{MonkSkillRanksPerLevelCount}{4}
\newCounter{MonkHitDieSize}
\setCounter{MonkHitDieSize}{8}
\edef\MonkClassSkillsList{}
\forcsvlist{\listadd{\MonkClassSkillsList}}{Balance, Climb, Concentration, Craft, Diplomacy, EscapeArtist, Hide, Jump, KnowledgeArcana, KnowledgeReligion, Listen, MoveSilently, Perform, Profession, SenseMotive, Spot, Swim, Tumble}
\newcommand{\addMonkClassFeatures}[1]{
		\addClassFeature{\ifthenelse{#1 > 10}{Greater }Flurry of Blows}
			\newCounter{charFlurryOfBlowsPenaltyCount}\setCounter{charFlurryOfBlowsPenaltyCount}{-2}
			\newCounter{charFlurryOfBlowsAttacksCount}\stepCounter{charFlurryOfBlowsAttacksCount}
%			\addAutoWeapon[\value{charFlurryOfBlowsAttacksCount}]{Flurry of Blows}{\value{charFlurryOfBlowsPenaltyCount}}{\charUnarmedStrikeDamage + \arabic{charStrModCount}}{20}{B}{melee}{}{str}
		\addClassFeature{Monk Bonus Feat\ifthenelse{#1 > 1}{$\times \ifthenelse{#1 > 5}{3}{2}$}{}}
		\addToCounter{charBonusFeatsCount}{2}
			\newcommand{\charUnarmedStrikeDamage}{
				\ifthenelse{\equal{\charSize}{Small}}{%
					\ifthenelse{#1 > 15}{2d\domath{6 + ((#1 - 16)/ 4) * 2}}{1d\domath{4 + (#1 / 4) * 2}}%
				}{%
				\ifthenelse{\equal{\charSize}{Medium}}{%
					\ifthenelse{#1 > 11}{2d\domath{6 + ((#1 - 12)/ 4) * 2}}{1d\domath{6 + (#1 / 4) * 2}}%
				}{%
				\ifthenelse{\equal{\charSize}{Large}}{%
					\ifthenelse{#1 > 3}{%
						\ifthenelse{#1 > 11}{%
							\ifthenelse{#1 > 19}{4d8}{%
							3d\domath{6 + ((#1 - 12)/ 4) * 2}}%
						}{%
							2d\domath{6 + ((#1 - 4)/ 4) * 2}%
						}%
					}{%
						1d8%
					}%
				}{}}{}}{}
			}
		\addClassFeature{Unarmed Strike \charUnarmedStrikeDamage}
			\addFeat*{Improved Unarmed Strike}
		\addClassFeature{Monk AC Bonus}
			\appto\Initialize{
				\ifthenelse{\equal{\charArmorType}{}}{
					\MiscBonus{AC}{#1 / 5 + \value{charWisModCount}}
					\MiscBonus{TouchAC}{#1 / 5 + \value{charWisModCount}}
					\MiscBonus{FlatFootedAC}{#1 / 5 + \value{charWisModCount}}
				}{}
			}
	\ifthenelse{#1 > 1}{
		\addClassFeature{\ifthenelse{#1 > 8}{Improved }{}Evasion}
		\ifthenelse{#1 > 8}{\addSpecialDefense{Improved Evasion}}{\addSpecialDefense{Evasion}}
		\stepCounter{charBonusFeatsCount}
	\ifthenelse{#1 > 2}{
		\addClassFeature{Still Mind}\addConditionalDefMod{+2 on saves vs. Enchantment}
		\EnhancementBonus{Speed}{#1 / 3 * 10}
	\ifthenelse{#1 > 3}{
		\addClassFeature{Ki Strike (magic\ifthenelse{#1 > 9}{%
			, lawful%
			\ifthenelse{#1 > 15}{, adamantine}{}%
			}{})
		}
		\addClassFeature{Slow Fall \ifthenelse{#1 < 20}{\domath{#1 / 2}0 ft.}{any distance}}
	\ifthenelse{#1 > 4}{
		\addClassFeature{Purity of Body}\addImmunity{Disease}
		\stepCounter{charFlurryOfBlowsPenaltyCount}
	\ifthenelse{#1 > 5}{
		\stepCounter{charBonusFeatsCount}
	\ifthenelse{#1 > 6}{
		\addLimitedUse{Wholeness of Body (hit points)}{\domath{#1 * 2}}
	\ifthenelse{#1 > 8}{
		\stepCounter{charFlurryOfBlowsPenaltyCount}
	\ifthenelse{#1 > 10}{
		\stepCounter{charFlurryOfBlowsAttacksCount}
		\addClassFeature{Diamond Body}
			\addImmunity{poison}
	\ifthenelse{#1 > 11}{
		\addLimitedUse{Abundant Step (\domath{(#1 / 2) * 40 + 400} ft.)}{1}
	\ifthenelse{#1 > 12}{
		\addClassFeature{Diamond Soul}
			\addSpellResistance{#1 + 10}
	\ifthenelse{#1 > 14}{
		\addLimitedUse{Quivering Palm (DC \domath{10 + #1 / 2 + \value{charWisModCount}}; (1/week))}{1}
	\ifthenelse{#1 > 16}{
		\addClassFeature{Timeless Body}
		\addClassFeature{Tongue of the Sun and Moon}\listadd{\charLanguagesList}{Can speak with any living creature}
	\ifthenelse{#1 > 18}{
		\addLimitedUse{Empty Body (rounds)}{#1}
	\ifthenelse{#1 > 19}{
		\addClassFeature{Perfect Self}\addDR{magic}{10}
	}{}
}{}
}{}
}{}
}{}
}{}
}{}
}{}
}{}
}{}
}{}
}{}
}{}
}{}
}

\def\PaladinBAB{g}
\def\PaladinFort{g}
\def\PaladinRef{p}
\def\PaladinWill{p}
\newCounter{PaladinSkillRanksPerLevelCount}
\setCounter{PaladinSkillRanksPerLevelCount}{2}
\newCounter{PaladinHitDieSize}
\setCounter{PaladinHitDieSize}{10}
\edef\PaladinClassSkillsList{}
\forcsvlist{\listadd{\PaladinClassSkillsList}}{Concentration, Craft, Diplomacy, HandleAnimal, Heal, KnowledgeNobility, KnowledgeReligion, Profession, Ride, SenseMotive}
\newcommand{\addPaladinClassFeatures}[1]{
		\addClassFeature{Aura of Good}
		\addClassFeature{Detect Evil}
		\addLimitedUse{Smite Evil}{\domath{#1 / 5 + 1}}
	\ifthenelse{#1 > 1}{
		\addClassFeature{Divine Grace}{
			\gappto\Initialize{
				\MiscBonus{Fortitude}{\value{charChaModCount}}
				\MiscBonus{Reflex}{\value{charChaModCount}}
				\MiscBonus{Will}{\value{charChaModCount}}
			}
		}
		\addLimitedUse{Lay on Hands (hp)}{\domath{#1 * \value{charChaModCount}}}
	\ifthenelse{#1 > 2}{
		\addClassFeature{Aura of Courage}\addImmunity{fear}
		\addClassFeature{Divine Health}\addImmunity{Disease}
	\ifthenelse{#1 > 3}{
		\newCounter{charturnundeadusesCount}
		\setCounter{charturnundeadusesCount}{3 + \value{charChaModCount}}
		\addLimitedUse{Turn Undead}{\arabic{charturnundeadusesCount}}
		\newcommand{\addPaladinSpellcasting}[1]{
			\setCounter{@i}{0}
			\ifthenelse{##1 > 3}{
				\stepCounter{@i}
			\ifthenelse{##1 > 7}{
				\stepCounter{@i}
			\ifthenelse{##1 > 11}{
				\stepCounter{@i}
			\ifthenelse{##1 > 13}{
				\stepCounter{@i}
			}{}}{}}{}}{}
			\newSpellcasting*[\value{@i}]{Paladin}{##1 / 2}{Wis}
			\addhalfSpellcasting{##1}
		}
	\ifthenelse{#1 > 4}{
		\addClassFeature{Special Mount}
	\ifthenelse{#1 > 6}{
		\addLimitedUse{Remove Disease (per week)}{\domath{#1 / 3 - 1}}
	}{}}{}}{}}{}}{}
}

\def\RangerBAB{g}
\def\RangerFort{g}
\def\RangerRef{g}
\def\RangerWill{p}
\newCounter{RangerSkillRanksPerLevelCount}
\setCounter{RangerSkillRanksPerLevelCount}{6}
\newCounter{RangerHitDieSize}
\setCounter{RangerHitDieSize}{8}
\edef\RangerClassSkillsList{}
\forcsvlist{\listadd{\RangerClassSkillsList}}{Climb, Concentration, Craft, HandleAnimal, Heal, Hide, Jump, KnowledgeDungeoneering, KnowledgeGeography, KnowledgeNature, Listen, MoveSilently, Profession, Ride, Search, Spot, Survival, Swim, UseRope}
\newcommand{\addRangerClassFeatures}[1]{
		\addClassFeature{Favored Enemy\forlistloop{\\~~~~}{\charFavoredEnemiesList}}
			\edef\charFavoredEnemiesList{}
			\newCounter{charFavoredEnemiesCount}
			\setCounter{charFavoredEnemiesCount}{#1 / 5 + 1}
			\newCounter{charFavoredEnemiesTotalBonusCount}
			\setCounter{charFavoredEnemiesTotalBonusCount}{(#1 / 5) * 4 + 2}
			\newcommand{\addFavoredEnemy}[2]{
				\listinsert{\charFavoredEnemiesList}{+##2 vs ##1s}
				\addToCounter{charFavoredEnemiesTotalBonusCount}{-##2}
				\addToCounter{charFavoredEnemiesCount}{-1}
				\addConditionalSkillMod{+##2 to Bluff, Listen, Sense Motive, Spot, and Survival vs. ##1s}
				\addConditionalAttackMod{+##2 damage vs. ##1s}
			}
			\appto{\RunChecks}{%
				%%Check Favored Enemies
				\ifthenelse{\value{charFavoredEnemiesCount} > 0}{
					\addnotice{Choose \arabic{charFavoredEnemiesCount} more favored enemies. Use the command \texttt{$\backslash$addFavoredEnemy\{enemy\}\{Bonus\}}}
				}{
				\ifthenelse{\value{charFavoredEnemiesCount} < 0}{
					\addnotice{\domath{-\value{charFavoredEnemiesCount}} too many favored enemies}
				}{}}
				\ifthenelse{\value{charFavoredEnemiesTotalBonusCount} > 0}{
					\addnotice{You have \arabic{charFavoredEnemiesTotalBonusCount} points of favored enemy Bonus to allocate}
				}{
				\ifthenelse{\value{charFavoredEnemiesTotalBonusCount} < 0}{
					\addnotice{Total favored enemy Bonus is \domath{-\value{charFavoredEnemiesTotalBonusCount}} points too high}
				}{}}
			}
		\addClassFeature{Track}\stepCounter{charBonusFeatsCount}\addFeat*{Track}
		\ifthenelse{\value{charHandleAnimalRanksCount} > 4}{
			\addClassFeature{Wild Empathy +\domath{#1 + \value{charChaModCount} + 2}}
		}{
			\addClassFeature{Wild Empathy +\domath{#1 + \value{charChaModCount}}}
		}
	\ifthenelse{#1 > 1}{
		\addClassFeature{Combat Style: \charCombatStyle}
			\stepCounter{charBonusFeatsCount}
			\newcommand\charCombatStyle{}
			\newcommand\addCombatStyle[1]{%
				\renewcommand{\charCombatStyle}{##1}%
				\ifthenelse{\equal{##1}{Two-Weapon Combat}}{%
						\addFeat*{Two-Weapon Fighting}%
					\ifthenelse{#1 > 5}{
						\addFeat*{Improved Two-Weapon Fighting}
					\ifthenelse{#1 > 10}{
						\addFeat*{Greater Two-Weapon Fighting}
					}{}}{}
				}{%
				\ifthenelse{\equal{##1}{Archery}}{%
						\addFeat*{Rapid Shot}%
					\ifthenelse{#1 > 5}{
						\addFeat*{Manyshot}
					\ifthenelse{#1 > 10}{
						\addFeat*{Improved Precise Shot}
				}{}}{}%
				}{}}
			}
			\appto{\RunChecks}{%
				%%Check Ranger Combat Style
				\ifthenelse{\equal{\charCombatStyle}{}}{
					\addnotice{Choose a Ranger combat style. Use the command \texttt{$\backslash$addCombatStyle\{combat style\}}}
				}{
				\ifthenelse{\equal{\charCombatStyle}{Two-Weapon Combat}}{}{
				\ifthenelse{\equal{\charCombatStyle}{Archery}}{}{
					\addnotice{Unrecognized Ranger combat style: ``\caselower{\charCombatStyle}'' is not ``\caselower{two-weapon combat}'' or ''\caselower{archery}''}
				}}}
			}
	\ifthenelse{#1 > 2}{
		\addClassFeature{Endurance}
			\stepCounter{charBonusFeatsCount}
			\addFeat*{Endurance}
	\ifthenelse{#1 > 3}{
		\addClassFeature{Animal Companion}
		\newcommand{\addRangerSpellcasting}[1]{
			\setCounter{@i}{0}
			\ifthenelse{##1 > 3}{
				\stepCounter{@i}
			\ifthenelse{##1 > 7}{
				\stepCounter{@i}
			\ifthenelse{##1 > 11}{
				\stepCounter{@i}
			\ifthenelse{##1 > 13}{
				\stepCounter{@i}
			}{}}{}}{}}{}
			\newSpellcasting*[\value{@i}]{Ranger}{##1 / 2}{Wis}
			\addhalfSpellcasting{##1}
		}
	\ifthenelse{#1 > 5}{
		\stepCounter{charBonusFeatsCount}
	\ifthenelse{#1 > 6}{
		\addClassFeature{Woodland Stride}
	\ifthenelse{#1 > 7}{
		\addClassFeature{Swift Tracker}
			\addConditionalSkillMod{No Penalty for tracking at full Speed}
			\addConditionalSkillMod{half Penalty for tracking at twice Speed}
	\ifthenelse{#1 > 8}{
		\addClassFeature{Evasion}
			\addSpecialDefense{Evasion}
	\ifthenelse{#1 > 10}{
		\stepCounter{charBonusFeatsCount}
	\ifthenelse{#1 > 12}{
		\addClassFeature{Camouflage}
	\ifthenelse{#1 > 16}{
		\addClassFeature{Hide in Plain Sight}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}

\def\RogueBAB{a}
\def\RogueFort{p}
\def\RogueRef{g}
\def\RogueWill{p}
\newCounter{RogueSkillRanksPerLevelCount}
\setCounter{RogueSkillRanksPerLevelCount}{8}
\newCounter{RogueHitDieSize}
\setCounter{RogueHitDieSize}{6}
\edef\RogueClassSkillsList{}
\forcsvlist{\listadd{\RogueClassSkillsList}}{Appraise, Balance, Bluff, Climb, Craft, DecipherScript, Diplomacy, DisableDevice, Disguise, EscapeArtist, Forgery, GatherInformation, Hide, Intimidate, Jump, KnowledgeLocal, Listen, MoveSilently, OpenLock, Perform, Profession, Search, SenseMotive, SleightOfHand, Spot, Swim, Tumble, UseMagicDevice, UseRope}
\newcommand{\addRogueClassFeatures}[1]{
	\addClassFeature{Sneak Attack +\domath{(#1 + 1)/2}d6}
	\addClassFeature{Trapfinding}
	\edef\charRogueSpecialAbilitiesList{}
	\edef\charSkillMasteryList{}
	\newCounter{charRogueSpecialAbilitiesCount}
	\ifthenelse{#1 > 1}{
		\addClassFeature{Evasion}
			\ifinlist{Improved Evasion}{\charRogueSpecialAbilitiesList}{
				\addSpecialDefense{Improved Evasion}
			}{
				\addSpecialDefense{Evasion}
			}
	\ifthenelse{#1 > 2}{
		\addClassFeature{Trap Sense +\domath{#1 / 3}}
			\addConditionalDefMod{+\domath{#1 / 3} to Reflex and AC vs. traps}
	\ifthenelse{#1 > 3}{
		\addClassFeature{\ifthenelse{#1 > 7}{Improved }{}Uncanny Dodge}
			\ifthenelse{#1 > 7}{\addSpecialDefense{Improved Uncanny Dodge}}{\addSpecialDefense{Uncanny Dodge}}
	\ifthenelse{#1 > 9}{
		\addToCounter{charRogueSpecialAbilitiesCount}{(#1 - 7) / 3}
		\addClassFeature{Rogue Special Abilities\forlistloop{\\~~~~}{\charRogueSpecialAbilitiesList}}
		\DeclareDocumentCommand{\addRogueSpecialAbility}{m}{
			\listinsert{\charRogueSpecialAbilitiesList}{##1}
			\addToCounter{charRogueSpecialAbilitiesCount}{-1}
		}
		\gappto{\RunChecks}{%
			%%CHECK ROGUE SPECIAL ABILITIES
			\ifthenelse{\value{charRogueSpecialAbilitiesCount} < 0}{
				\addnotice{\domath{-\value{charRogueSpecialAbilitiesCount}} too many Rogue special abilities}
			}{
			\ifthenelse{\value{charRogueSpecialAbilitiesCount} > 0}{
				\addnotice{Choose \arabic{charRogueSpecialAbilitiesCount} more Rogue special abilities}
			}{}}
		}
	}{}}{}}{}}{}
}

\def\SorcererBAB{p}
\def\SorcererFort{p}
\def\SorcererRef{p}
\def\SorcererWill{g}
\newCounter{SorcererSkillRanksPerLevelCount}
\setCounter{SorcererSkillRanksPerLevelCount}{2}
\newCounter{SorcererHitDieSize}
\setCounter{SorcererHitDieSize}{4}
\edef\SorcererClassSkillsList{}
\forcsvlist{\listadd{\SorcererClassSkillsList}}{Bluff, Concentration, Craft, KnowledgeArcana, Profession, Spellcraft}
\newcommand{\addSorcererClassFeatures}[1]{
	\addClassFeature{Summon Familiar}
	\newcommand{\addSorcererSpellcasting}[1]{
		\ifthenelse{##1 = 1}{
			\newSpellcasting[1]{Sorcerer}{##1}{cha}
		}{
			\newSpellcasting[##1 / 2]{Sorcerer}{##1}{cha}
		}
		\addspontaneousprimarySpellcasting{##1}
		\ifthenelse{##1 > 9}{\addSpellsknown{0}{9}}{\addSpellsknown{0}{{##1/2 + 4}}}
		\ifthenelse{##1 > 6}{\addSpellsknown{1}{5}}{\addSpellsknown{1}{##1/3 + 2}}
		\ifthenelse{##1 > 10}{
			\addSpellsknown{2}{5}
			\addSpellsknown{3}{4}
		}{
			\addSpellsknown{2}{(##1 - 1)/2}
			\addSpellsknown{3}{(##1 - 3)/2}
		}
		\ifthenelse{##1 > 12}{\addSpellsknown{4}{4}}{\addSpellsknown{4}{(##1 - 5)/2}}
		\ifthenelse{##1 > 14}{
			\addSpellsknown{5}{4}
			\addSpellsknown{6}{3}
		}{
			\addSpellsknown{5}{(##1 - 7)/2}
			\addSpellsknown{6}{(##1 - 9)/2}
		}
		\ifthenelse{##1 > 16}{\addSpellsknown{7}{3}}{\addSpellsknown{7}{(##1 - 11)/2}}
		\addSpellsknown{8}{(##1 - 13) / 2}
		\addSpellsknown{9}{##1 - 17}
	}
}

\def\WizardBAB{p}
\def\WizardFort{p}
\def\WizardRef{p}
\def\WizardWill{g}
\newCounter{WizardSkillRanksPerLevelCount}
\setCounter{WizardSkillRanksPerLevelCount}{2}
\newCounter{WizardHitDieSize}
\setCounter{WizardHitDieSize}{4}
\edef\WizardClassSkillsList{}
\forcsvlist{\listadd{\WizardClassSkillsList}}{Concentration, Craft, DecipherScript, KnowledgeArcana, KnowledgeDungeoneering, KnowledgeEngineering, KnowledgeHistory, KnowledgeGeography, KnowledgeHistory, KnowledgeLocal, KnowledgeNature, KnowledgeNobility, KnowledgePlanes, KnowledgeReligion, Profession, Spellcraft}
\newcommand{\addWizardClassFeatures}[1]{
	\addClassFeature{Summon Familiar}
	\addClassFeature{Scribe Scroll}
	\addToCounter{charBonusFeatsCount}{#1 / 5 + 1}
	\addFeat*{Scribe Scroll}
	\ifthenelse{#1 > 4}{
		\addClassFeature{Wizard Bonus Feat\ifthenelse{#1 > 9}{ $\times\domath{#1 / 5}$}{}}
	}{}
	\DeclareDocumentCommand{\addWizardSpellcasting}{m O{} O{} O{}}{
		\newSpellcasting[(##1 + 1) / 2]{Wizard}{##1}{Int}
		\newCounter{charWizardforbiddenschoolsCount}
		\addprimarySpellcasting{##1}
		\ifthenelse{\equal{##2}{}}{}{
			\forloop{@i}{1}{\value{@i}<10}{
				\addBonusSpellSlots{\arabic{@i}}{1}
			}
			\addSpellcastingSpecialization[Focus School]{##2}
			\ifthenelse{\equal{##2}{Divination}}{
				\addToCounter{charWizardforbiddenschoolsCount}{1}
			}{
				\addToCounter{charWizardforbiddenschoolsCount}{2}
			}
			\ifthenelse{\equal{##3}{}}{}{
				\addSpellcastingProhibition[Banned School]{##3}
				\addToCounter{charWizardforbiddenschoolsCount}{-1}
			}
			\ifthenelse{\equal{##4}{}}{}{
				\addSpellcastingProhibition[Banned School]{##4}
				\addToCounter{charWizardforbiddenschoolsCount}{-1}
			}
		}
		\appto{\RunChecks}{
			%%CHECK NUMBER OF PROHIBITED SCHOOLS
			\ifthenelse{\value{charWizardforbiddenschoolsCount} > 0}{
				\addnotice{Choose \arabic{charWizardforbiddenschoolsCount} more prohibited schools}
			}{
			\ifthenelse{\value{charWizardforbiddenschoolsCount} < 0}{
				\addnotice{You can remove \domath{-\value{charWizardforbiddenschoolsCount}} prohibited schools}
			}{}}
		}
	}
}

\newcommand{\addprimarySpellcasting}[1]{
\addSpellSlots{0}{3}
	\addSpellSlots{1}{1}
	\ifthenelse{#1 > 1}{
		\addSpellSlots{0}{1}
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 2}{
		\addSpellSlots{2}{1}
	\ifthenelse{#1 > 3}{
		\addSpellSlots{0}{1}
		\addSpellSlots{1}{1}
		\addSpellSlots{2}{1}
	\ifthenelse{#1 > 4}{
		\addSpellSlots{3}{1}
	\ifthenelse{#1 > 5}{
		\addSpellSlots{2}{1}
		\addSpellSlots{3}{1}
	\ifthenelse{#1 > 6}{
		\addSpellSlots{4}{1}
		\addSpellSlots{0}{1}
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 7}{
		\addSpellSlots{3}{1}
		\addSpellSlots{4}{1}
	\ifthenelse{#1 > 8}{
		\addSpellSlots{5}{1}
		\addSpellSlots{2}{1}
	\ifthenelse{#1 > 9}{
		\addSpellSlots{4}{1}
		\addSpellSlots{5}{1}	
	\ifthenelse{#1 > 10}{
		\addSpellSlots{6}{1}
		\addSpellSlots{3}{1}
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 11}{
		\addSpellSlots{5}{1}
		\addSpellSlots{6}{1}
	\ifthenelse{#1 > 12}{
		\addSpellSlots{7}{1}
		\addSpellSlots{4}{1}
		\addSpellSlots{2}{1}
	\ifthenelse{#1 > 13}{
		\addSpellSlots{6}{1}
		\addSpellSlots{7}{1}
	\ifthenelse{#1 > 14}{
		\addSpellSlots{8}{1}
		\addSpellSlots{5}{1}
		\addSpellSlots{3}{1}
	\ifthenelse{#1 > 15}{
		\addSpellSlots{7}{1}
		\addSpellSlots{8}{1}
	\ifthenelse{#1 > 16}{
		\addSpellSlots{9}{1}
		\addSpellSlots{6}{1}
		\addSpellSlots{4}{1}
	\ifthenelse{#1 > 17}{
		\addSpellSlots{8}{1}
		\addSpellSlots{9}{1}
	\ifthenelse{#1 > 18}{
		\addSpellSlots{7}{1}
		\addSpellSlots{9}{1}
		\addSpellSlots{5}{1}
	\ifthenelse{#1 > 19}{
		\addSpellSlots{8}{1}
		\addSpellSlots{9}{1}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\addspontaneousprimarySpellcasting}[1]{
	\addSpellSlots{0}{5}
	\addSpellSlots{1}{3}
	\ifthenelse{#1 > 1}{
		\addSpellSlots{0}{1}
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 2}{
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 3}{
		\addSpellSlots{1}{1}
		\addSpellSlots{2}{3}
	\ifthenelse{#1 > 4}{
		\addSpellSlots{2}{1}
	\ifthenelse{#1 > 5}{
		\addSpellSlots{2}{1}
		\addSpellSlots{3}{3}
	\ifthenelse{#1 > 6}{
		\addSpellSlots{2}{1}
		\addSpellSlots{3}{1}
	\ifthenelse{#1 > 7}{
		\addSpellSlots{3}{1}
		\addSpellSlots{4}{3}
	\ifthenelse{#1 > 8}{
		\addSpellSlots{3}{1}
		\addSpellSlots{4}{1}
	\ifthenelse{#1 > 9}{
		\addSpellSlots{4}{1}
		\addSpellSlots{5}{3}	
	\ifthenelse{#1 > 10}{
		\addSpellSlots{4}{1}
		\addSpellSlots{5}{1}
	\ifthenelse{#1 > 11}{
		\addSpellSlots{5}{1}
		\addSpellSlots{6}{3}
	\ifthenelse{#1 > 12}{
		\addSpellSlots{5}{1}
		\addSpellSlots{6}{1}
	\ifthenelse{#1 > 13}{
		\addSpellSlots{6}{1}
		\addSpellSlots{7}{3}
	\ifthenelse{#1 > 14}{
		\addSpellSlots{6}{1}
		\addSpellSlots{7}{1}
	\ifthenelse{#1 > 15}{
		\addSpellSlots{7}{1}
		\addSpellSlots{8}{3}
	\ifthenelse{#1 > 16}{
		\addSpellSlots{7}{1}
		\addSpellSlots{8}{1}
	\ifthenelse{#1 > 17}{
		\addSpellSlots{8}{1}
		\addSpellSlots{9}{3}
	\ifthenelse{#1 > 18}{
		\addSpellSlots{8}{1}
		\addSpellSlots{9}{1}
	\ifthenelse{#1 > 19}{
		\addSpellSlots{9}{2}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}

}
\newcommand{\addtwothirdsSpellcasing}[1]{
		\addSpellSlots{0}{2}
		\addSpellsknown{0}{4}
		\ifthenelse{#1 > 1}{
			\addSpellSlots{0}{1}
			\addSpellsknown{0}{1}
			\addSpellsknown{1}{2}
		\ifthenelse{#1 > 2}{
			\addSpellSlots{1}{1}
			\addSpellsknown{0}{1}
			\addSpellsknown{1}{1}
		\ifthenelse{#1 > 3}{
			\addSpellSlots{1}{1}
			\addSpellsknown{2}{2}
		\ifthenelse{#1 > 4}{
			\addSpellSlots{1}{1}
			\addSpellSlots{2}{1}
			\addSpellsknown{1}{1}
			\addSpellsknown{2}{1}
		\ifthenelse{#1 > 5}{
			\addSpellSlots{2}{1}
		\ifthenelse{#1 > 6}{
			\addSpellsknown{2}{1}
			\addSpellsknown{3}{2}
		\ifthenelse{#1 > 7}{
			\addSpellSlots{2}{1}
			\addSpellSlots{3}{1}
			\addSpellsknown{3}{1}
		\ifthenelse{#1 > 8}{
			\addSpellSlots{3}{1}
		\ifthenelse{#1 > 9}{
			\addSpellsknown{3}{1}
			\addSpellsknown{4}{2}
		\ifthenelse{#1 > 10}{
			\addSpellSlots{3}{1}
			\addSpellSlots{4}{1}
			\addSpellsknown{4}{1}
		\ifthenelse{#1 > 11}{
			\addSpellSlots{4}{1}
		\ifthenelse{#1 > 12}{
			\addSpellsknown{4}{1}
			\addSpellsknown{5}{2}
		\ifthenelse{#1 > 13}{
			\addSpellSlots{0}{1}
			\addSpellSlots{4}{1}
			\addSpellSlots{5}{1}
			\addSpellsknown{5}{1}
		\ifthenelse{#1 > 14}{
			\addSpellSlots{1}{1}
			\addSpellSlots{5}{1}
		\ifthenelse{#1 > 15}{
			\addSpellSlots{2}{1}
			\addSpellsknown{1}{1}
			\addSpellsknown{5}{1}
			\addSpellsknown{6}{2}
		\ifthenelse{#1 > 16}{
			\addSpellSlots{3}{1}
			\addSpellSlots{5}{1}
			\addSpellSlots{6}{1}
			\addSpellsknown{2}{1}
			\addSpellsknown{6}{1}
		\ifthenelse{#1 > 17}{
			\addSpellSlots{4}{1}
			\addSpellSlots{6}{1}
			\addSpellsknown{3}{1}
		\ifthenelse{#1 > 18}{
			\addSpellSlots{5}{1}
			\addSpellSlots{6}{1}
			\addSpellsknown{4}{1}
			\addSpellsknown{6}{1}
		\ifthenelse{#1 > 19}{
			\addSpellSlots{6}{1}
			\addSpellsknown{5}{1}
		}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\addhalfSpellcasting}[1]{
	\ifthenelse{#1 > 5}{
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 9}{
		\addSpellSlots{2}{1}
	\ifthenelse{#1 > 11}{
		\addSpellSlots{3}{1}
	\ifthenelse{#1 > 13}{
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 14}{
		\addSpellSlots{4}{1}
	\ifthenelse{#1 > 15}{
		\addSpellSlots{2}{1}
	\ifthenelse{#1 > 16}{
		\addSpellSlots{3}{1}
	\ifthenelse{#1 > 17}{
		\addSpellSlots{1}{1}
	\ifthenelse{#1 > 18}{
		\addSpellSlots{2}{1}
		\addSpellSlots{3}{1}
		\addSpellSlots{4}{1}
	\ifthenelse{#1 > 19}{
		\addSpellSlots{4}{1}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}