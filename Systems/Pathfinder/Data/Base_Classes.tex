% % Base Classes
\def\AlchemistBAB{a}
\def\AlchemistFort{g}
\def\AlchemistRef{g}
\def\AlchemistWill{p}
\NewCounter{AlchemistSkillRanksPerLevelCount}
\SetCounter{AlchemistSkillRanksPerLevelCount}{4}
\NewCounter{AlchemistHitDieSize}
\SetCounter{AlchemistHitDieSize}{8}
\edef\AlchemistClassSkillsList{}\forcsvlist\listadd{\AlchemistClassSkillsList}{Appraise, Craft, DisableDevice, Fly, Heal, KnowledgeArcana, KnowledgeNature, Perception, Profession, SleightOfHand, Spellcraft, Survival, UseMagicDevice}
\NewDocumentCommand{\AddAlchemitsClassFeatures}{m}{
		\AddClassFeature{\ifthenelse{#1 > 2}{\ifthenelse{#1 > 17}{Instant}{Swift} }{}Alchemy}
			\AddConditionalSkillMod{+#1 to Craft (Alchemy) checks to create alchemical items}
			\AddConditionalSkillMod{Can use Craft (Alchemy) to identify potions as if using \textit{detect magic}}
			\newcommand{\AddAlchemistSpellcasting}[1]{
				\ifthenelse{##1 < 2}{\SetCounter{@i}{0}}{
				\ifthenelse{##1 < 4}{\SetCounter{@i}{1}}{
				\ifthenelse{##1 < 7}{\SetCounter{@i}{2}}{
				\ifthenelse{##1 < 10}{\SetCounter{@i}{3}}{
				\ifthenelse{##1 < 13}{\SetCounter{@i}{4}}{
				\ifthenelse{##1 < 16}{\SetCounter{@i}{5}}{\SetCounter{@i}{6}}}}}}}
				\newSpellcasting[\value{@i}]{Alchemist}{##1}{Int}
				\AddTwoThirdsSpellcasing{##1}
			}
			\ifthenelse{#1 > 2}{
				\AddConditionalSkillMod{Can create alchemical items \ifthenelse{#1 > 17}{instantly}{in half the normal time}}
			}{}
		\AddClassFeature{Bomb \DoMath{(#1 + 1) / 2}d6}
		\AddClassFeature{\ifthenelse{#1 > 13}{Persistent }{}Mutagen}
		\Addtocounter{CharBonusFeatsCount}{2}
			\AddClassFeature{Brew Potion}\AddFeat*{Brew Potion}
			\AddClassFeature{Throw Anything}\AddFeat*{Throw Anything}
	\ifthenelse{#1 > 1}{
		\edef\CharAlchemistDiscoveriesList{}
			\NewCounter{CharAlchemistDiscoveriesCount}
			\AddClassFeature{Discoveries\forlistloop{\\~~~~}{\CharAlchemistDiscoveriesList}}
			\AddToCounter{CharAlchemistDiscoveriesCount}{#1 / 2}
			\NewDocumentCommand{\AddAlchemistDiscovery}{m}{
				\listinsert{\CharAlchemistDiscoveriesList}{##1}
				\AddToCounter{CharAlchemistDiscoveriesCount}{-1}
			}
			\gappto{\RunChecks}{%
				%%CHECK DISCOVERIES
				\ifthenelse{\value{CharAlchemistDiscoveriesCount} < 0}{
					\AddWarning{\DoMath{-\value{CharAlchemistDiscoveriesCount}} too many alchemist Discoveries}
				}{
				\ifthenelse{\value{CharAlchemistDiscoveriesCount} > 0}{
					\AddWarning{Choose \arabic{CharAlchemistDiscoveriesCount} more alchemist Discoveries}
				}{}}
			}
		\AddClassFeature{Poison \ifthenelse{#1 > 9}{Immunity}{Resistance +\DoMath{(#1 + 1) / 3 * 2}}}
			\ifthenelse{#1 > 9}{
				\AddImmunity{Poison}
			}{
				\AddConditionalDefMod{+\DoMath{(#1 + 1) / 3 * 2} vs. poison}
			}
		\AddClassFeature{Poison Use}	
	\ifthenelse{#1 > 5}{
		\AddClassFeature{Swift Poisoning}
	\ifthenelse{#1 > 19}{
		\edef\CharGrandDiscovery{}
		\AddClassFeature{Grand Discovery\ifthenelse{\equal{\CharGrandDiscovery}{}}{}{: \CharGrandDiscovery}}
			\stepcounter{CharAlchemistDiscoverisCount}
			\NewDocumentCommand{\SetGrandDiscovery}{m}{
				\def\CharGrandDiscovery{#1}
			}
			\appto{\runchecks}{
				%% Check Grand Discovery
				\ifthenelse{\equal{\CharGrandDiscovery}{}}{
					\AddWarning{Choose an alchemist Grand Discovery using \texttt{$\backslash$setGrandDiscovery}}
				}{}
			}
	}{}}{}}{}
}

\def\CavalierBAB{g}
\def\CavalierFort{g}
\def\CavalierRef{p}
\def\CavalierWill{p}
\NewCounter{CavalierSkillRanksPerLevelCount}
\SetCounter{CavalierSkillRanksPerLevelCount}{4}
\NewCounter{CavalierHitDieSize}
\SetCounter{CavalierHitDieSize}{10}
\edef\CavalierClassSkillsList{}\forcsvlist\listadd{\CavalierClassSkillsList}{Bluff, Climb, Craft, Diplomacy, HandleAnimal, Intimidate, Profession, Ride, SenseMotive, Swim}
\NewDocumentCommand{\AddCavalierClassFeatures}{m}{
		\AddLimitedUse{Challenge}{\DoMath{(#1 + 2) / 3}}
		\AddClassFeature{Mount}
		\def\CharCavalierOrder{Order}
			\edef\CharCavalierOrderAbilitiesList{}
			\AddClassFeature{\CharCavalierOrder\forlistloop{\\~~~~}{\CharCavalierOrderAbilitiesList}}
			\NewCounter{CharCavalierOrderAbilitiesCount}
			\NewDocumentCommand{\AddCavalierOrderAbility}{m}{
				\listadd{\CharCavalierOrderAbilitiesList}{##1}
				\AddToCounter{CharCavalierOrderAbilitiesCount}{-1}
			}
			\NewDocumentCommand{\SetCavalierOrder}{m}{
				\def\CharCavalierOrder{##1}
			}
			\gappto{\RunChecks}{%
				%%CHECK Cavalier order choice
				\ifthenelse{\equal{\CharCavalierOrder}{Order}}{
					\AddWarning{Choose a cavalier order using \texttt{$\backslash$setCavalierOrder}}
				}{}
				%%CHECK Order Abilities
				\ifthenelse{\value{CharCavalierOrderAbilitiesCount} < 0}{
					\AddWarning{\DoMath{-\value{CharCavalierOrderAbilitiesCount}} too many cavalier order abilities}
				}{
				\ifthenelse{\value{CharCavalierOrderAbilitiesCount} > 0}{
					\AddWarning{Remember to input cavalier order abilities. Input \arabic{CharCavalierOrderAbilitiesCount} more order abilities using \texttt{$\backslash$addCavalierOrderAbility}}
				}{}}
			}
		\AddClassFeature{\ifthenelse{#1 > 8}{\ifthenelse{#1 > 16}{Master}{Greater} }{}Tactician}
			\AddlimitedUse{Tactician}{\DoMath{#1 / 5 + 1}}
			\stepcounter{CharBonusFeatsCount}
	\ifthenelse{#1 > 1}{
		\stepcounter{CharCavalierOrderAbilitiesCount}
	\ifthenelse{#1 > 2}{
		\AddClassFeature{Cavalier's Charge}
	\ifthenelse{#1 > 3}{
		\AddClassFeature{Expert Trainer}
			\AddConditionalSkillMod{+\DoMath{#1 / 2} to Handle Animal to train mounts}
			\AddConditionalSkillMod{Can train multiple mounts at once for +2 DC per extra animal}
			\AddConditionalSkillMod{Can train mounts in one-seventh of the usual time (days instead of weeks) for +5 to DC}
	\ifthenelse{#1 > 4}{
		\AddClassFeature{\ifthenelse{#1 > 13}{Greater }{}Banner +\DoMath{#1 / 5}}
	\ifthenelse{#1 > 5}{
		\AddClassFeature{Cavalier Bonus Feat\ifthenelse{#1 > 11}{ $\times \DoMath{#1 / 6}$}
		\Addtocounter{CharBonusFeatsCount}{#1 / 6}
	\ifthenelse{#1 > 10}{
		\AddClassFeature{Mighty Charge}
	\ifthenelse{#1 > 11}{
		\AddClassFeature{Demanding Challenge}
	\ifthenelse{#1 > 19}{
		\AddClassFeature{Supreme Charge}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}
}


\def\GunslingerBAB{g}
\def\GunslingerFort{g}
\def\GunslingerRef{g}
\def\GunslingerWill{p}
\NewCounter{GunslingerSkillRanksPerLevelCount}
\SetCounter{GunslingerSkillRanksPerLevelCount}{4}
\NewCounter{GunslingerHitDieSize}
\SetCounter{GunslingerHitDieSize}{10}
\edef\GunslingerClassSkillsList{}\forcsvlist\listadd{\GunslingerClassSkillsList}{Acrobatics, Bluff, Climb, Craft, HandleAnimal, Heal, Intimidate, KnowledgeEngineering, KnowledgeLocal, Perception, Profession, Ride, SleightOfHand, Survival, Swim}

\def\InquisitorBAB{a}
\def\InquisitorFort{g}
\def\InquisitorRef{p}
\def\InquisitorWill{g}
\NewCounter{InquisitorSkillRanksPerLevelCount}
\SetCounter{InquisitorSkillRanksPerLevelCount}{6}
\NewCounter{InquisitorHitDieSize}
\SetCounter{InquisitorHitDieSize}{8}
\edef\InquisitorClassSkillsList{}\forcsvlist\listadd{\InquisitorClassSkillsList}{Bluff, Climb, Craft, Diplomacy, Disguise, Heal, Intimidate, KnowledgeArcana, KnowledgeDungeoneering, KnowledgeNature, KnowledgePlanes, KnowledgeReligion, Perception, Profession, Ride, SenseMotive, Spellcraft, Stealth, Survival, Swim}

\def\MagusBAB{a}
\def\MagusFort{g}
\def\MagusRef{p}
\def\MagusWill{g}
\NewCounter{MagusSkillRanksPerLevelCount}
\SetCounter{MagusSkillRanksPerLevelCount}{2}
\NewCounter{MagusHitDieSize}
\SetCounter{MagusHitDieSize}{8}
\edef\MagusClassSkillsList{}\forcsvlist\listadd{\MagusClassSkillsList}{Climb, Craft, Fly, Intimidate, KnowledgeArcana, KnowledgeDungeoneering, KnowledgePlanes, Profession, Ride, Spellcraft, Swim, UseMagicDevice}

\def\OracleBAB{a}
\def\OracleFort{p}
\def\OracleRef{p}
\def\OracleWill{g}
\NewCounter{OracleSkillRanksPerLevelCount}
\SetCounter{OracleSkillRanksPerLevelCount}{4}
\NewCounter{OracleHitDieSize}
\SetCounter{OracleHitDieSize}{8}
\edef\OracleClassSkillsList{}\forcsvlist\listadd{\OracleClassSkillsList}{Craft, Diplomacy, Heal, KnowledgeHistory, KnowledgePlanes, KnowledgeReligion, Profession, SenseMotive, Spellcraft}

\def\SummonerBAB{a}
\def\SummonerFort{p}
\def\SummonerRef{p}
\def\SummonerWill{g}
\NewCounter{SummonerSkillRanksPerLevelCount}
\SetCounter{SummonerSkillRanksPerLevelCount}{2}
\NewCounter{SummonerHitDieSize}
\SetCounter{SummonerHitDieSize}{8}
\edef\SummonerClassSkillsList{}\forcsvlist\listadd{\SummonerClassSkillsList}{Craft, Fly, HandleAnimal, KnowledgeAll, Linguistics, Profession, Ride, Spellcraft, UseMagicDevice}

\def\VigilanteBAB{a}
\def\VigilanteFort{p}
\def\VigilanteRef{g}
\def\VigilanteWill{g}
\NewCounter{VigilanteSkillRanksPerLevelCount}
\SetCounter{VigilanteSkillRanksPerLevelCount}{6}
\NewCounter{VigilanteHitDieSize}
\SetCounter{VigilanteHitDieSize}{8}
\edef\VigilanteClassSkillsList{}\forcsvlist\listadd{\VigilanteClassSkillsList}{Acrobatics, Appraise, Bluff, Climb, Craft, Diplomacy, DisableDevice, Disguise, EscapeArtist, Intimidate, KnowledgeDungeoneering, KnowledgeEngineering, KnowledgeLocal, Perception, Perform, Profession, Ride, SenseMotive, SleightOfHand, Stealth, Survival, Swim, UseMagicDevice}

\def\WitchBAB{p}
\def\WitchFort{p}
\def\WitchRef{p}
\def\WitchWill{g}
\NewCounter{WitchSkillRanksPerLevelCount}
\SetCounter{WitchSkillRanksPerLevelCount}{2}
\NewCounter{WitchHitDieSize}
\SetCounter{WitchHitDieSize}{6}
\edef\WitchClassSkillsList{}\forcsvlist\listadd{\WitchClassSkillsList}{Craft, Fly, Heal, Intimidate, KnowledgeArcana, KnowledgeHistory, KnowledgeNature, KnowledgePlanes, Profession, Spellcraft, UseMagicDevice}

% % Prestige Classes

\newcommand{\AddPrimarySpellcasting}[1]{
	\AddSpellslots{0}{3}
	\AddSpellslots{1}{1}
	\ifthenelse{#1 > 1}{
		\AddSpellslots{0}{1}
		\AddSpellslots{1}{1}
		\ifthenelse{#1 > 2}{
			\AddSpellslots{2}{1}
			\ifthenelse{#1 > 3}{
				\AddSpellslots{0}{1}
				\AddSpellslots{1}{1}
				\AddSpellslots{2}{1}
				\ifthenelse{#1 > 4}{
					\AddSpellslots{3}{1}
					\ifthenelse{#1 > 5}{
						\AddSpellslots{2}{1}
						\AddSpellslots{3}{1}
						\ifthenelse{#1 > 6}{
							\AddSpellslots{4}{1}
							\AddSpellslots{0}{1}
							\AddSpellslots{1}{1}
							\ifthenelse{#1 > 7}{
								\AddSpellslots{3}{1}
								\AddSpellslots{4}{1}
								\ifthenelse{#1 > 8}{
									\AddSpellslots{5}{1}
									\AddSpellslots{2}{1}
									\ifthenelse{#1 > 9}{
										\AddSpellslots{4}{1}
										\AddSpellslots{5}{1}	
										\ifthenelse{#1 > 10}{
											\AddSpellslots{6}{1}
											\AddSpellslots{3}{1}
											\AddSpellslots{1}{1}
											\ifthenelse{#1 > 11}{
												\AddSpellslots{5}{1}
												\AddSpellslots{6}{1}
												\ifthenelse{#1 > 12}{
													\AddSpellslots{7}{1}
													\AddSpellslots{4}{1}
													\AddSpellslots{2}{1}
													\ifthenelse{#1 > 13}{
														\AddSpellslots{6}{1}
														\AddSpellslots{7}{1}
														\ifthenelse{#1 > 14}{
															\AddSpellslots{8}{1}
															\AddSpellslots{5}{1}
															\AddSpellslots{3}{1}
															\ifthenelse{#1 > 15}{
																\AddSpellslots{7}{1}
																\AddSpellslots{8}{1}
																\ifthenelse{#1 > 16}{
																	\AddSpellslots{9}{1}
																	\AddSpellslots{6}{1}
																	\AddSpellslots{4}{1}
																	\ifthenelse{#1 > 17}{
																		\AddSpellslots{8}{1}
																		\AddSpellslots{9}{1}
																		\ifthenelse{#1 > 18}{
																			\AddSpellslots{7}{1}
																			\AddSpellslots{9}{1}
																			\AddSpellslots{5}{1}
																			\ifthenelse{#1 > 19}{
																				\AddSpellslots{8}{1}
																				\AddSpellslots{9}{1}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\AddSpontaneousPrimarySpellcasting}[1]{
	\AddSpellslots{0}{5}
	\AddSpellslots{1}{3}
	\ifthenelse{#1 > 1}{
		\AddSpellslots{0}{1}
		\AddSpellslots{1}{1}
		\ifthenelse{#1 > 2}{
			\AddSpellslots{1}{1}
			\ifthenelse{#1 > 3}{
				\AddSpellslots{1}{1}
				\AddSpellslots{2}{3}
				\ifthenelse{#1 > 4}{
					\AddSpellslots{2}{1}
					\ifthenelse{#1 > 5}{
						\AddSpellslots{2}{1}
						\AddSpellslots{3}{3}
						\ifthenelse{#1 > 6}{
							\AddSpellslots{2}{1}
							\AddSpellslots{3}{1}
							\ifthenelse{#1 > 7}{
								\AddSpellslots{3}{1}
								\AddSpellslots{4}{3}
								\ifthenelse{#1 > 8}{
									\AddSpellslots{3}{1}
									\AddSpellslots{4}{1}
									\ifthenelse{#1 > 9}{
										\AddSpellslots{4}{1}
										\AddSpellslots{5}{3}	
										\ifthenelse{#1 > 10}{
											\AddSpellslots{4}{1}
											\AddSpellslots{5}{1}
											\ifthenelse{#1 > 11}{
												\AddSpellslots{5}{1}
												\AddSpellslots{6}{3}
												\ifthenelse{#1 > 12}{
													\AddSpellslots{5}{1}
													\AddSpellslots{6}{1}
													\ifthenelse{#1 > 13}{
														\AddSpellslots{6}{1}
														\AddSpellslots{7}{3}
														\ifthenelse{#1 > 14}{
															\AddSpellslots{6}{1}
															\AddSpellslots{7}{1}
															\ifthenelse{#1 > 15}{
																\AddSpellslots{7}{1}
																\AddSpellslots{8}{3}
																\ifthenelse{#1 > 16}{
																	\AddSpellslots{7}{1}
																	\AddSpellslots{8}{1}
																	\ifthenelse{#1 > 17}{
																		\AddSpellslots{8}{1}
																		\AddSpellslots{9}{3}
																		\ifthenelse{#1 > 18}{
																			\AddSpellslots{8}{1}
																			\AddSpellslots{9}{1}
																			\ifthenelse{#1 > 19}{
																				\AddSpellslots{9}{2}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
	
}
\newcommand{\AddTwoThirdsSpellcasing}[1]{
	\AddSpellslots{0}{2}
	\AddSpellsKnown{0}{4}
	\ifthenelse{#1 > 1}{
		\AddSpellslots{0}{1}
		\AddSpellsKnown{0}{1}
		\AddSpellsKnown{1}{2}
		\ifthenelse{#1 > 2}{
			\AddSpellslots{1}{1}
			\AddSpellsKnown{0}{1}
			\AddSpellsKnown{1}{1}
			\ifthenelse{#1 > 3}{
				\AddSpellslots{1}{1}
				\AddSpellsKnown{2}{2}
				\ifthenelse{#1 > 4}{
					\AddSpellslots{1}{1}
					\AddSpellslots{2}{1}
					\AddSpellsKnown{1}{1}
					\AddSpellsKnown{2}{1}
					\ifthenelse{#1 > 5}{
						\AddSpellslots{2}{1}
						\ifthenelse{#1 > 6}{
							\AddSpellsKnown{2}{1}
							\AddSpellsKnown{3}{2}
							\ifthenelse{#1 > 7}{
								\AddSpellslots{2}{1}
								\AddSpellslots{3}{1}
								\AddSpellsKnown{3}{1}
								\ifthenelse{#1 > 8}{
									\AddSpellslots{3}{1}
									\ifthenelse{#1 > 9}{
										\AddSpellsKnown{3}{1}
										\AddSpellsKnown{4}{2}
										\ifthenelse{#1 > 10}{
											\AddSpellslots{3}{1}
											\AddSpellslots{4}{1}
											\AddSpellsKnown{4}{1}
											\ifthenelse{#1 > 11}{
												\AddSpellslots{4}{1}
												\ifthenelse{#1 > 12}{
													\AddSpellsKnown{4}{1}
													\AddSpellsKnown{5}{2}
													\ifthenelse{#1 > 13}{
														\AddSpellslots{0}{1}
														\AddSpellslots{4}{1}
														\AddSpellslots{5}{1}
														\AddSpellsKnown{5}{1}
														\ifthenelse{#1 > 14}{
															\AddSpellslots{1}{1}
															\AddSpellslots{5}{1}
															\ifthenelse{#1 > 15}{
																\AddSpellslots{2}{1}
																\AddSpellsKnown{1}{1}
																\AddSpellsKnown{5}{1}
																\AddSpellsKnown{6}{2}
																\ifthenelse{#1 > 16}{
																	\AddSpellslots{3}{1}
																	\AddSpellslots{5}{1}
																	\AddSpellslots{6}{1}
																	\AddSpellsKnown{2}{1}
																	\AddSpellsKnown{6}{1}
																	\ifthenelse{#1 > 17}{
																		\AddSpellslots{4}{1}
																		\AddSpellslots{6}{1}
																		\AddSpellsKnown{3}{1}
																		\ifthenelse{#1 > 18}{
																			\AddSpellslots{5}{1}
																			\AddSpellslots{6}{1}
																			\AddSpellsKnown{4}{1}
																			\AddSpellsKnown{6}{1}
																			\ifthenelse{#1 > 19}{
																				\AddSpellslots{6}{1}
																				\AddSpellsKnown{5}{1}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\AddHalfSpellcasting}[1]{
	\ifthenelse{#1 > 5}{
		\AddSpellslots{1}{1}
		\ifthenelse{#1 > 9}{
			\AddSpellslots{2}{1}
			\ifthenelse{#1 > 11}{
				\AddSpellslots{3}{1}
				\ifthenelse{#1 > 13}{
					\AddSpellslots{1}{1}
					\ifthenelse{#1 > 14}{
						\AddSpellslots{4}{1}
						\ifthenelse{#1 > 15}{
							\AddSpellslots{2}{1}
							\ifthenelse{#1 > 16}{
								\AddSpellslots{3}{1}
								\ifthenelse{#1 > 17}{
									\AddSpellslots{1}{1}
									\ifthenelse{#1 > 18}{
										\AddSpellslots{2}{1}
										\AddSpellslots{3}{1}
										\AddSpellslots{4}{1}
										\ifthenelse{#1 > 19}{
											\AddSpellslots{4}{1}
										}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
