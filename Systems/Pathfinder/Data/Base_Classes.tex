% % Base Classes
\def\AlchemistBAB{a}
\def\AlchemistFort{g}
\def\AlchemistRef{g}
\def\AlchemistWill{p}
\NewCounter{AlchemistSkillRanksPerLevelCount}
\SetCounter{AlchemistSkillRanksPerLevelCount}{4}
\NewCounter{AlchemistHitDieSize}
\SetCounter{AlchemistHitDieSize}{8}
\edef\AlchemistClassSkillsList{}\forcsvlist\listadd{\AlchemistClassSkillsList}{Appraise, Craft, DisableDevice, Fly, Heal, KnowledgeArcana, KnowledgeNature, Perception, Profession, SleightOfHand, Spellcraft, Survival, UseMagicDevice}
\NewDocumentCommand{\addAlchemitsClassFeatures}{m}{
		\addClassFeature{\ifthenelse{#1 > 2}{\ifthenelse{#1 > 17}{Instant}{Swift} }{}Alchemy}
			\addConditionalSkillMod{+#1 to Craft (Alchemy) checks to create alchemical items}
			\addConditionalSkillMod{Can use Craft (Alchemy) to identify potions as if using \textit{detect magic}}
			\newcommand{\addAlchemistSpellcasting}[1]{
				\ifthenelse{##1 < 2}{\SetCounter{@i}{0}}{
				\ifthenelse{##1 < 4}{\SetCounter{@i}{1}}{
				\ifthenelse{##1 < 7}{\SetCounter{@i}{2}}{
				\ifthenelse{##1 < 10}{\SetCounter{@i}{3}}{
				\ifthenelse{##1 < 13}{\SetCounter{@i}{4}}{
				\ifthenelse{##1 < 16}{\SetCounter{@i}{5}}{\SetCounter{@i}{6}}}}}}}
				\newSpellcasting[\value{@i}]{Alchemist}{##1}{Int}
				\addTwoThirdsSpellcasing{##1}
			}
			\ifthenelse{#1 > 2}{
				\addConditionalSkillMod{Can create alchemical items \ifthenelse{#1 > 17}{instantly}{in half the normal time}}
			}{}
		\addClassFeature{Bomb \DoMath{(#1 + 1) / 2}d6}
		\addClassFeature{\ifthenelse{#1 > 13}{Persistent }{}Mutagen}
		\addtocounter{charBonusFeatsCount}{2}
			\addClassFeature{Brew Potion}\addFeat*{Brew Potion}
			\addClassFeature{Throw Anything}\addFeat*{Throw Anything}
	\ifthenelse{#1 > 1}{
		\edef\charAlchemistDiscoveriesList{}
			\NewCounter{charAlchemistDiscoveriesCount}
			\addClassFeature{Discoveries\forlistloop{\\~~~~}{\charAlchemistDiscoveriesList}}
			\AddToCounter{charAlchemistDiscoveriesCount}{#1 / 2}
			\NewDocumentCommand{\addAlchemistDiscovery}{m}{
				\listinsert{\charAlchemistDiscoveriesList}{##1}
				\AddToCounter{charAlchemistDiscoveriesCount}{-1}
			}
			\gappto{\RunChecks}{%
				%%CHECK DISCOVERIES
				\ifthenelse{\value{charAlchemistDiscoveriesCount} < 0}{
					\AddWarning{\DoMath{-\value{charAlchemistDiscoveriesCount}} too many alchemist Discoveries}
				}{
				\ifthenelse{\value{charAlchemistDiscoveriesCount} > 0}{
					\AddWarning{Choose \arabic{charAlchemistDiscoveriesCount} more alchemist Discoveries}
				}{}}
			}
		\addClassFeature{Poison \ifthenelse{#1 > 9}{Immunity}{Resistance +\DoMath{(#1 + 1) / 3 * 2}}}
			\ifthenelse{#1 > 9}{
				\addImmunity{Poison}
			}{
				\addConditionalDefMod{+\DoMath{(#1 + 1) / 3 * 2} vs. poison}
			}
		\addClassFeature{Poison Use}	
	\ifthenelse{#1 > 5}{
		\addClassFeature{Swift Poisoning}
	\ifthenelse{#1 > 19}{
		\edef\charGrandDiscovery{}
		\addClassFeature{Grand Discovery\ifthenelse{\equal{\charGrandDiscovery}{}}{}{: \charGrandDiscovery}}
			\stepcounter{charAlchemistDiscoverisCount}
			\NewDocumentCommand{\setGrandDiscovery}{m}{
				\def\charGrandDiscovery{#1}
			}
			\appto{\runchecks}{
				%% Check Grand Discovery
				\ifthenelse{\equal{\charGrandDiscovery}{}}{
					\AddWarning{Choose an alchemist Grand Discovery using \texttt{$\backslash$setGrandDiscovery}}
				}{}
			}
	}{}}{}}{}
}

\def\CavalierBAB{g}
\def\CavalierFort{g}
\def\CavalierRef{p}
\def\CavalierWill{p}
\NewCounter{CavalierSkillRanksPerLevelCount}
\SetCounter{CavalierSkillRanksPerLevelCount}{4}
\NewCounter{CavalierHitDieSize}
\SetCounter{CavalierHitDieSize}{10}
\edef\CavalierClassSkillsList{}\forcsvlist\listadd{\CavalierClassSkillsList}{Bluff, Climb, Craft, Diplomacy, HandleAnimal, Intimidate, Profession, Ride, SenseMotive, Swim}
\NewDocumentCommand{\addCavalierClassFeatures}{m}{
		\addLimitedUse{Challenge}{\DoMath{(#1 + 2) / 3}}
		\addClassFeature{Mount}
		\def\charCavalierOrder{Order}
			\edef\charCavalierOrderAbilitiesList{}
			\addClassFeature{\charCavalierOrder\forlistloop{\\~~~~}{\charCavalierOrderAbilitiesList}}
			\NewCounter{charCavalierOrderAbilitiesCount}
			\NewDocumentCommand{\addCavalierOrderAbility}{m}{
				\listadd{\charCavalierOrderAbilitiesList}{##1}
				\AddToCounter{charCavalierOrderAbilitiesCount}{-1}
			}
			\NewDocumentCommand{\setCavalierOrder}{m}{
				\def\charCavalierOrder{##1}
			}
			\gappto{\RunChecks}{%
				%%CHECK Cavalier order choice
				\ifthenelse{\equal{\charCavalierOrder}{Order}}{
					\AddWarning{Choose a cavalier order using \texttt{$\backslash$setCavalierOrder}}
				}{}
				%%CHECK Order Abilities
				\ifthenelse{\value{charCavalierOrderAbilitiesCount} < 0}{
					\AddWarning{\DoMath{-\value{charCavalierOrderAbilitiesCount}} too many cavalier order abilities}
				}{
				\ifthenelse{\value{charCavalierOrderAbilitiesCount} > 0}{
					\AddWarning{Remember to input cavalier order abilities. Input \arabic{charCavalierOrderAbilitiesCount} more order abilities using \texttt{$\backslash$addCavalierOrderAbility}}
				}{}}
			}
		\addClassFeature{\ifthenelse{#1 > 8}{\ifthenelse{#1 > 16}{Master}{Greater} }{}Tactician}
			\addlimitedUse{Tactician}{\DoMath{#1 / 5 + 1}}
			\stepcounter{charBonusFeatsCount}
	\ifthenelse{#1 > 1}{
		\stepcounter{charCavalierOrderAbilitiesCount}
	\ifthenelse{#1 > 2}{
		\addClassFeature{Cavalier's Charge}
	\ifthenelse{#1 > 3}{
		\addClassFeature{Expert Trainer}
			\addConditionalSkillMod{+\DoMath{#1 / 2} to Handle Animal to train mounts}
			\addConditionalSkillMod{Can train multiple mounts at once for +2 DC per extra animal}
			\addConditionalSkillMod{Can train mounts in one-seventh of the usual time (days instead of weeks) for +5 to DC}
	\ifthenelse{#1 > 4}{
		\addClassFeature{\ifthenelse{#1 > 13}{Greater }{}Banner +\DoMath{#1 / 5}}
	\ifthenelse{#1 > 5}{
		\addClassFeature{Cavalier Bonus Feat\ifthenelse{#1 > 11}{ $\times \DoMath{#1 / 6}$}
		\addtocounter{charBonusFeatsCount}{#1 / 6}
	\ifthenelse{#1 > 10}{
		\addClassFeature{Mighty Charge}
	\ifthenelse{#1 > 11}{
		\addClassFeature{Demanding Challenge}
	\ifthenelse{#1 > 19}{
		\addClassFeature{Supreme Charge}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}
}


\def\GunslingerBAB{g}
\def\GunslingerFort{g}
\def\GunslingerRef{g}
\def\GunslingerWill{p}
\NewCounter{GunslingerSkillRanksPerLevelCount}
\SetCounter{GunslingerSkillRanksPerLevelCount}{4}
\NewCounter{GunslingerHitDieSize}
\SetCounter{GunslingerHitDieSize}{10}
\edef\GunslingerClassSkillsList{}\forcsvlist\listadd{\GunslingerClassSkillsList}{Acrobatics, Bluff, Climb, Craft, HandleAnimal, Heal, Intimidate, KnowledgeEngineering, KnowledgeLocal, Perception, Profession, Ride, SleightOfHand, Survival, Swim}

\def\InquisitorBAB{a}
\def\InquisitorFort{g}
\def\InquisitorRef{p}
\def\InquisitorWill{g}
\NewCounter{InquisitorSkillRanksPerLevelCount}
\SetCounter{InquisitorSkillRanksPerLevelCount}{6}
\NewCounter{InquisitorHitDieSize}
\SetCounter{InquisitorHitDieSize}{8}
\edef\InquisitorClassSkillsList{}\forcsvlist\listadd{\InquisitorClassSkillsList}{Bluff, Climb, Craft, Diplomacy, Disguise, Heal, Intimidate, KnowledgeArcana, KnowledgeDungeoneering, KnowledgeNature, KnowledgePlanes, KnowledgeReligion, Perception, Profession, Ride, SenseMotive, Spellcraft, Stealth, Survival, Swim}

\def\MagusBAB{a}
\def\MagusFort{g}
\def\MagusRef{p}
\def\MagusWill{g}
\NewCounter{MagusSkillRanksPerLevelCount}
\SetCounter{MagusSkillRanksPerLevelCount}{2}
\NewCounter{MagusHitDieSize}
\SetCounter{MagusHitDieSize}{8}
\edef\MagusClassSkillsList{}\forcsvlist\listadd{\MagusClassSkillsList}{Climb, Craft, Fly, Intimidate, KnowledgeArcana, KnowledgeDungeoneering, KnowledgePlanes, Profession, Ride, Spellcraft, Swim, UseMagicDevice}

\def\OracleBAB{a}
\def\OracleFort{p}
\def\OracleRef{p}
\def\OracleWill{g}
\NewCounter{OracleSkillRanksPerLevelCount}
\SetCounter{OracleSkillRanksPerLevelCount}{4}
\NewCounter{OracleHitDieSize}
\SetCounter{OracleHitDieSize}{8}
\edef\OracleClassSkillsList{}\forcsvlist\listadd{\OracleClassSkillsList}{Craft, Diplomacy, Heal, KnowledgeHistory, KnowledgePlanes, KnowledgeReligion, Profession, SenseMotive, Spellcraft}

\def\SummonerBAB{a}
\def\SummonerFort{p}
\def\SummonerRef{p}
\def\SummonerWill{g}
\NewCounter{SummonerSkillRanksPerLevelCount}
\SetCounter{SummonerSkillRanksPerLevelCount}{2}
\NewCounter{SummonerHitDieSize}
\SetCounter{SummonerHitDieSize}{8}
\edef\SummonerClassSkillsList{}\forcsvlist\listadd{\SummonerClassSkillsList}{Craft, Fly, HandleAnimal, KnowledgeAll, Linguistics, Profession, Ride, Spellcraft, UseMagicDevice}

\def\VigilanteBAB{a}
\def\VigilanteFort{p}
\def\VigilanteRef{g}
\def\VigilanteWill{g}
\NewCounter{VigilanteSkillRanksPerLevelCount}
\SetCounter{VigilanteSkillRanksPerLevelCount}{6}
\NewCounter{VigilanteHitDieSize}
\SetCounter{VigilanteHitDieSize}{8}
\edef\VigilanteClassSkillsList{}\forcsvlist\listadd{\VigilanteClassSkillsList}{Acrobatics, Appraise, Bluff, Climb, Craft, Diplomacy, DisableDevice, Disguise, EscapeArtist, Intimidate, KnowledgeDungeoneering, KnowledgeEngineering, KnowledgeLocal, Perception, Perform, Profession, Ride, SenseMotive, SleightOfHand, Stealth, Survival, Swim, UseMagicDevice}

\def\WitchBAB{p}
\def\WitchFort{p}
\def\WitchRef{p}
\def\WitchWill{g}
\NewCounter{WitchSkillRanksPerLevelCount}
\SetCounter{WitchSkillRanksPerLevelCount}{2}
\NewCounter{WitchHitDieSize}
\SetCounter{WitchHitDieSize}{6}
\edef\WitchClassSkillsList{}\forcsvlist\listadd{\WitchClassSkillsList}{Craft, Fly, Heal, Intimidate, KnowledgeArcana, KnowledgeHistory, KnowledgeNature, KnowledgePlanes, Profession, Spellcraft, UseMagicDevice}

% % Prestige Classes

\newcommand{\addPrimarySpellcasting}[1]{
	\addSpellslots{0}{3}
	\addSpellslots{1}{1}
	\ifthenelse{#1 > 1}{
		\addSpellslots{0}{1}
		\addSpellslots{1}{1}
		\ifthenelse{#1 > 2}{
			\addSpellslots{2}{1}
			\ifthenelse{#1 > 3}{
				\addSpellslots{0}{1}
				\addSpellslots{1}{1}
				\addSpellslots{2}{1}
				\ifthenelse{#1 > 4}{
					\addSpellslots{3}{1}
					\ifthenelse{#1 > 5}{
						\addSpellslots{2}{1}
						\addSpellslots{3}{1}
						\ifthenelse{#1 > 6}{
							\addSpellslots{4}{1}
							\addSpellslots{0}{1}
							\addSpellslots{1}{1}
							\ifthenelse{#1 > 7}{
								\addSpellslots{3}{1}
								\addSpellslots{4}{1}
								\ifthenelse{#1 > 8}{
									\addSpellslots{5}{1}
									\addSpellslots{2}{1}
									\ifthenelse{#1 > 9}{
										\addSpellslots{4}{1}
										\addSpellslots{5}{1}	
										\ifthenelse{#1 > 10}{
											\addSpellslots{6}{1}
											\addSpellslots{3}{1}
											\addSpellslots{1}{1}
											\ifthenelse{#1 > 11}{
												\addSpellslots{5}{1}
												\addSpellslots{6}{1}
												\ifthenelse{#1 > 12}{
													\addSpellslots{7}{1}
													\addSpellslots{4}{1}
													\addSpellslots{2}{1}
													\ifthenelse{#1 > 13}{
														\addSpellslots{6}{1}
														\addSpellslots{7}{1}
														\ifthenelse{#1 > 14}{
															\addSpellslots{8}{1}
															\addSpellslots{5}{1}
															\addSpellslots{3}{1}
															\ifthenelse{#1 > 15}{
																\addSpellslots{7}{1}
																\addSpellslots{8}{1}
																\ifthenelse{#1 > 16}{
																	\addSpellslots{9}{1}
																	\addSpellslots{6}{1}
																	\addSpellslots{4}{1}
																	\ifthenelse{#1 > 17}{
																		\addSpellslots{8}{1}
																		\addSpellslots{9}{1}
																		\ifthenelse{#1 > 18}{
																			\addSpellslots{7}{1}
																			\addSpellslots{9}{1}
																			\addSpellslots{5}{1}
																			\ifthenelse{#1 > 19}{
																				\addSpellslots{8}{1}
																				\addSpellslots{9}{1}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\addSpontaneousPrimarySpellcasting}[1]{
	\addSpellslots{0}{5}
	\addSpellslots{1}{3}
	\ifthenelse{#1 > 1}{
		\addSpellslots{0}{1}
		\addSpellslots{1}{1}
		\ifthenelse{#1 > 2}{
			\addSpellslots{1}{1}
			\ifthenelse{#1 > 3}{
				\addSpellslots{1}{1}
				\addSpellslots{2}{3}
				\ifthenelse{#1 > 4}{
					\addSpellslots{2}{1}
					\ifthenelse{#1 > 5}{
						\addSpellslots{2}{1}
						\addSpellslots{3}{3}
						\ifthenelse{#1 > 6}{
							\addSpellslots{2}{1}
							\addSpellslots{3}{1}
							\ifthenelse{#1 > 7}{
								\addSpellslots{3}{1}
								\addSpellslots{4}{3}
								\ifthenelse{#1 > 8}{
									\addSpellslots{3}{1}
									\addSpellslots{4}{1}
									\ifthenelse{#1 > 9}{
										\addSpellslots{4}{1}
										\addSpellslots{5}{3}	
										\ifthenelse{#1 > 10}{
											\addSpellslots{4}{1}
											\addSpellslots{5}{1}
											\ifthenelse{#1 > 11}{
												\addSpellslots{5}{1}
												\addSpellslots{6}{3}
												\ifthenelse{#1 > 12}{
													\addSpellslots{5}{1}
													\addSpellslots{6}{1}
													\ifthenelse{#1 > 13}{
														\addSpellslots{6}{1}
														\addSpellslots{7}{3}
														\ifthenelse{#1 > 14}{
															\addSpellslots{6}{1}
															\addSpellslots{7}{1}
															\ifthenelse{#1 > 15}{
																\addSpellslots{7}{1}
																\addSpellslots{8}{3}
																\ifthenelse{#1 > 16}{
																	\addSpellslots{7}{1}
																	\addSpellslots{8}{1}
																	\ifthenelse{#1 > 17}{
																		\addSpellslots{8}{1}
																		\addSpellslots{9}{3}
																		\ifthenelse{#1 > 18}{
																			\addSpellslots{8}{1}
																			\addSpellslots{9}{1}
																			\ifthenelse{#1 > 19}{
																				\addSpellslots{9}{2}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
	
}
\newcommand{\addTwoThirdsSpellcasing}[1]{
	\addSpellslots{0}{2}
	\addSpellsKnown{0}{4}
	\ifthenelse{#1 > 1}{
		\addSpellslots{0}{1}
		\addSpellsKnown{0}{1}
		\addSpellsKnown{1}{2}
		\ifthenelse{#1 > 2}{
			\addSpellslots{1}{1}
			\addSpellsKnown{0}{1}
			\addSpellsKnown{1}{1}
			\ifthenelse{#1 > 3}{
				\addSpellslots{1}{1}
				\addSpellsKnown{2}{2}
				\ifthenelse{#1 > 4}{
					\addSpellslots{1}{1}
					\addSpellslots{2}{1}
					\addSpellsKnown{1}{1}
					\addSpellsKnown{2}{1}
					\ifthenelse{#1 > 5}{
						\addSpellslots{2}{1}
						\ifthenelse{#1 > 6}{
							\addSpellsKnown{2}{1}
							\addSpellsKnown{3}{2}
							\ifthenelse{#1 > 7}{
								\addSpellslots{2}{1}
								\addSpellslots{3}{1}
								\addSpellsKnown{3}{1}
								\ifthenelse{#1 > 8}{
									\addSpellslots{3}{1}
									\ifthenelse{#1 > 9}{
										\addSpellsKnown{3}{1}
										\addSpellsKnown{4}{2}
										\ifthenelse{#1 > 10}{
											\addSpellslots{3}{1}
											\addSpellslots{4}{1}
											\addSpellsKnown{4}{1}
											\ifthenelse{#1 > 11}{
												\addSpellslots{4}{1}
												\ifthenelse{#1 > 12}{
													\addSpellsKnown{4}{1}
													\addSpellsKnown{5}{2}
													\ifthenelse{#1 > 13}{
														\addSpellslots{0}{1}
														\addSpellslots{4}{1}
														\addSpellslots{5}{1}
														\addSpellsKnown{5}{1}
														\ifthenelse{#1 > 14}{
															\addSpellslots{1}{1}
															\addSpellslots{5}{1}
															\ifthenelse{#1 > 15}{
																\addSpellslots{2}{1}
																\addSpellsKnown{1}{1}
																\addSpellsKnown{5}{1}
																\addSpellsKnown{6}{2}
																\ifthenelse{#1 > 16}{
																	\addSpellslots{3}{1}
																	\addSpellslots{5}{1}
																	\addSpellslots{6}{1}
																	\addSpellsKnown{2}{1}
																	\addSpellsKnown{6}{1}
																	\ifthenelse{#1 > 17}{
																		\addSpellslots{4}{1}
																		\addSpellslots{6}{1}
																		\addSpellsKnown{3}{1}
																		\ifthenelse{#1 > 18}{
																			\addSpellslots{5}{1}
																			\addSpellslots{6}{1}
																			\addSpellsKnown{4}{1}
																			\addSpellsKnown{6}{1}
																			\ifthenelse{#1 > 19}{
																				\addSpellslots{6}{1}
																				\addSpellsKnown{5}{1}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\addHalfSpellcasting}[1]{
	\ifthenelse{#1 > 5}{
		\addSpellslots{1}{1}
		\ifthenelse{#1 > 9}{
			\addSpellslots{2}{1}
			\ifthenelse{#1 > 11}{
				\addSpellslots{3}{1}
				\ifthenelse{#1 > 13}{
					\addSpellslots{1}{1}
					\ifthenelse{#1 > 14}{
						\addSpellslots{4}{1}
						\ifthenelse{#1 > 15}{
							\addSpellslots{2}{1}
							\ifthenelse{#1 > 16}{
								\addSpellslots{3}{1}
								\ifthenelse{#1 > 17}{
									\addSpellslots{1}{1}
									\ifthenelse{#1 > 18}{
										\addSpellslots{2}{1}
										\addSpellslots{3}{1}
										\addSpellslots{4}{1}
										\ifthenelse{#1 > 19}{
											\addSpellslots{4}{1}
										}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
