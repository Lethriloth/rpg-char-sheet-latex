\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{SystemPathfinder}[2016/12/29 Pathfinder system-specific features for rpgcharsheet2.cls]


%%%% Character Attributes %%%%

%% Ability Scores %%
\edef\AbilityScoresList{}
\forcsvlist{\listadd\AbilityScoresList}{Str,Dex,Con,Int,Wis,Cha}

\renewcommand{\do}[1]{
	\NewCounter{Char#1Count}
	\NewCounter{Char#1BaseCount}
	\NewCounter{Char#1EnhancementCount}
	\NewCounter{Char#1MiscCount}
	\NewCounter{Char#1TmpCount}
	\NewCounter{Char#1ModCount}
	\expandafter\newcommand\csname SetChar#1\endcsname[1]{
		\SetCounter{Char#1BaseCount}{##1}
	}
}\dolistloop{\AbilityScoresList}
\newcommand{\ComputeAbilityScores}{
	\renewcommand{\do}[1]{
		\SetCounter{Char##1Count}{\value{Char##1BaseCount}}
		\AddToCounter{Char##1Count}{\value{Char##1EnhancementCount}}
		\AddToCounter{Char##1Count}{\value{Char##1MiscCount}}
		\AddToCounter{Char##1Count}{\value{Char##1TmpCount}}
		\SetCounter{Char##1ModCount}{0}
		\ifthenelse{10 > \value{Char##1Count}}{
			\AddToCounter{Char##1Count}{-1}
			\SetCounter{Char##1ModCount}{(\value{Char##1Count} - 10) / 2}
			\AddToCounter{Char##1Count}{1}
		}{
			\SetCounter{Char##1ModCount}{(\value{Char##1Count}-10)/2}
		}
	}\dolistloop{\AbilityScoresList}
	\SetCounter{CharCMDAbilityModCount}{\value{CharStrModCount}+\value{CharDexModCount}}
}

%% Armor Class %%
\NewCounter{CharArmorBonusCount}
	\newcommand{\AddArmorBonus}[1]{\ifthenelse{\value{CharArmorBonusCount}<#1}{\SetCounter{CharArmorBonusCount}{#1}}{}}
\NewCounter{CharShieldBonusCount}
	\newcommand{\AddShieldBonus}[1]{\ifthenelse{\value{CharShieldBonusCount}<#1}{\SetCounter{CharShieldBonusCount}{#1}}{}}
\NewCounter{CharNaturalArmorModCount}
	\newcommand{\AddNaturalArmorBonus}[1]{\ifthenelse{\value{CharNaturalArmorModCount}<#1}{\Setcounter{CharNaturalArmorModCount}{#1}}{}}
\NewCounter{CharDodgeModCount}
	\newcommand{\AddDodgeBonus}[1]{\AddToCounter{CharDodgeModCount}{#1}}
\NewCounter{CharSizeModCount}
\NewCounter{CharDeflectionModCount}
	\newcommand{\AddDeflectionBonus}[1]{\ifthenelse{\value{Chardeflectionmodcount}<#1}{\Setcounter{Chardeflectionmodcount}{#1}}{}}
\NewCounter{CharACMiscCount}\NewCounter{CharACTmpCount}
\NewCounter{CharTouchACMiscCount}\NewCounter{CharTouchACTmpCount}
\NewCounter{CharFlatFootedACMiscCount}\NewCounter{CharFlatFootedACTmpCount}

%% Saving Throws
\renewcommand{\do}[1]{
	\NewCounter{Char#1Count}
	\NewCounter{Char#1MiscCount}
	\NewCounter{Char#1TmpCount}
}\docsvlist{Fortitude, Reflex, Will}
\NewCounter{CharResistanceModCount}
\newcommand{\AddResistanceBonus}[1]{\ifthenelse{\value{CharResistanceModCount}<#1}{\SetCounter{CharResistanceModCount}{#1}}{}}

%% Special Defenses
\edef\CharResistancesList{}
\newcommand{\AddResistance}[2]{
	\ifinlist{#1}{\CharImmunitiesList}{}{
		\ifinlist{#1}{\CharResistancesList}{}{
			\NewCounter{CharResist#1Count}
			\listadd{\CharResistancesList}{#1}
		}
		\ifthenelse{\value{CharResist#1Count} < #2}{
			\SetCounter{CharResist#1Count}{#2}
		}{}
	}
}
\NewDocumentCommand{\PrintResistances}{O{, } O{}}{%
	\edef\@PrintList{}%
	\edef\@@PrintList{}%
	\edef\@PrintListlast{}
	\renewcommand{\do}[1]{%
		\ifthenelse{\value{CharResist##1Count} = 0}{}{%
			\let\@@PrintList\@PrintList%
			\edef\@PrintListlast{Resist ##1 \arabic{CharResist##1Count}}%
			\listadd{\@PrintList}{Resist ##1 \arabic{CharResist##1Count}}%
		}
	}\dolistloop{\CharResistancesList}%
	\renewcommand{\do}[1]{%
		##1#1%
	}\dolistloop{\@@PrintList}%
	\ifthenelse{\equal\@@PrintList{}}{}{#2}\@PrintListlast%
}
\edef\CharImmunitiesList{}
\newcommand{\AddImmunity}[1]{
	\ifinlist{#1}{\CharImmunitiesList}{}{
		\listinsert{\CharImmunitiesList}{#1}
		\ifinlist{#1}{\CharResistancesList}{
			\SetCounter{CharResist#1Count}{0}
		}{}
	}
}
\edef\CharDRTypesList{}
\newcommand{\AddDR}[2]{
	\ifinlist{#1}{\CharDRTypesList}{}{
		\NewCounter{CharDR/#1Count}
		\listadd{\CharDRTypesList}{#1}
	}
	\ifthenelse{\value{CharDR/#1Count} < #2}{
		\SetCounter{CharDR/#1Count}{#2}
	}{}
}
\NewDocumentCommand{\PrintDR}{O{, } O{}}{%
	\edef\@PrintList{}%
	\edef\@@PrintList{}%
	\edef\@PrintListlast{}
	\renewcommand{\do}[1]{%
		\let\@@PrintList\@PrintList%
		\edef\@PrintListlast{DR \arabic{CharDR/##1Count}/##1}%
		\listadd{\@PrintList}{DR \arabic{CharDR/##1Count}/##1}%
	}\dolistloop{\CharDRTypesList}%
	\renewcommand{\do}[1]{%
		##1#1%
	}\dolistloop{\@@PrintList}%
	\ifthenelse{\equal\@@PrintList{}}{}{#2}\@PrintListlast%
}

\edef\CharSpecialDefensesList{}
\newcommand{\AddSpecialDefense}[1]{
	\listinsert{\CharSpecialDefensesList}{#1}
}

%% BAB, attacks, combat maneuvers
\NewCounter{CharBABCount}
\NewCounter{CharIteratedAttacksCount}
\NewCounter{CharIteratedAttackBonusCount}
\NewCounter{CharExtraAttacksCount}
\renewcommand{\do}[1]{
	\NewCounter{Char#1MiscCount}
	\NewCounter{Char#1TmpCount}
}\docsvlist{Melee,Ranged,CMB,CMD}
\NewCounter{CharCMDBaseCount}
\NewCounter{CharCMDAbilityModCount}

%% Size
\NewCounter{CharSpecialSizeModCount}
\newcommand\SetSize[1]{
	\csname SetSize#1\endcsname
}
\newcommand\SetSizeFine{
	\renewcommand{\CharSize}{Fine}
	\SetCounter{CharSizeModCount}{8}
	\SetCounter{CharSpecialSizeModCount}{-8}
}
\newcommand\SetSizeDiminutive{
	\renewcommand{\CharSize}{Diminutive}
	\SetCounter{CharSizeModCount}{4}
	\SetCounter{CharSpecialSizeModCount}{-4}
}
\newcommand\SetSizeTiny{
	\renewcommand{\CharSize}{Tiny}
	\SetCounter{CharSizeModCount}{2}
	\SetCounter{CharSpecialSizeModCount}{-2}
}
\newcommand\SetSizeSmall{
	\renewcommand{\CharSize}{Small}
	\SetCounter{CharSizeModCount}{1}
	\SetCounter{CharSpecialSizeModCount}{-1}
}
\newcommand\SetSizeMedium{
	\renewcommand{\CharSize}{Medium}
	\SetCounter{CharSizeModCount}{0}
	\SetCounter{CharSpecialSizeModCount}{0}
}
\newcommand\SetSizeLarge{
	\renewcommand{\CharSize}{Large}
	\SetCounter{CharSizeModCount}{-1}
	\SetCounter{CharSpecialSizeModCount}{1}
}
\newcommand\SetSizeHuge{
	\renewcommand{\CharSize}{Huge}
	\SetCounter{CharSizeModCount}{-2}
	\SetCounter{CharSpecialSizeModCount}{2}
}
\newcommand\SetSizeGargantuan{
	\renewcommand{\CharSize}{Gargantuan}
	\SetCounter{CharSizeModCount}{-4}
	\SetCounter{CharSpecialSizeModCount}{4}
}
\newcommand\SetSizeColossal{
	\renewcommand{\CharSize}{Colossal}
	\SetCounter{CharSizeModCount}{-8}
	\SetCounter{CharSpecialSizeModCount}{8}
}

%% Speed
\NewCounter{CharSpeedReducibleBool}
\SetCounter{CharSpeedReducibleBool}{1}
\renewcommand{\do}[1]{
	\NewCounter{Char#1SpeedCount}
}
\docsvlist{Base, Fly, Swim, Burrow, Climb}
\newcommand{\SetCharSpeed}[1]{
	\SetCounter{CharBaseSpeedCount}{#1}
}
\NewCounter{CharManeuverabilityCount}
\newcommand{\AddFlySpeed}[2]{
	\SetCounter{CharFlySpeedCount}{#1}
	\SetCounter{CharManeuverabilityCount}{#2}
}
\newcommand{\AddClimbSpeed}[1]{
	\SetCounter{CharClimbSpeedCount}{#1}
}
\newcommand{\AddSwimSpeed}[1]{
	\SetCounter{CharSwimSpeedCount}{#1}
}
\newcommand{\AddBurrowSpeed}[1]{
	\SetCounter{CharBurrowSpeedCount}{#1}
}
\NewCounter{CharSpeedEnhancementCount}
\newcommand{\SpeedInitialize}{
	\renewcommand{\do}[1]{
		\ifthenelse{\value{Char##1SpeedCount}=0}{
		}{
			\AddToCounter{Char##1SpeedCount}{\value{CharSpeedEnhancementCount}}
		}
	}
	\docsvlist{Base, Fly, Swim, Burrow, Climb}
	\MiscBonus{Fly}{\value{CharManeuverabilityCount}}
	\MiscBonus{Fly}{\value{CharSizeModCount} * 2}
}


%%%% Feats, Class & Race Features %%%%

\edef\CharFeatsList{}
\edef\CharRaceFeaturesList{}
\edef\CharClassFeaturesList{}
\edef\CharLimitedUseList{}
\NewCounter{CharFeatsCount}
\NewCounter{CharBonusFeatsCount}
\NewCounter{CountFeats-Mode}

\NewDocumentCommand{\AddFeat}{s s O{1} m}{
	\IfBooleanTF #1 {
		\IfBooleanF #2 {
			\AddToCounter{CharBonusFeatsCount}{-#3}
		}
		\listadd\CharFeatsList{#4\textsuperscript{B} \ifthenelse{#3 = 1}{}{$\times#3$}}
	}{
		\listadd\CharFeatsList{#4 \ifthenelse{#3 = 1}{}{$\times#3$}}
		\AddToCounter{CharFeatsCount}{-#3}
	}
}
\newcommand\AddClassFeature[1]{\listadd\CharClassFeaturesList{#1}}
\newcommand\AddRaceFeature[1]{\listadd\CharRaceFeaturesList{#1}}
\newcommand\AddLimitedUse[2]{\listadd\CharLimitedUseList{#1 & #2}}


%% Favored Classes %%
\NewCounter{CheckFavoredClass-Mode}
\SetCounter{CheckFavoredClass-Mode}{1}
\NewCounter{CharSpareFavoredClassLevelsCount}

\newcommand{\AddFavoredClassHP}[1]{
	\ifthenelse{\equal{#1}{}}{
		\AddFavoredClassHP{\value{CharSpareFavoredClassLevelsCount}}
	}{
		\AddToCounter{CharHPCount}{#1}
		\AddToCounter{CharSpareFavoredClassLevelsCount}{-#1}
	}
}

\newcommand{\AddFavoredClassSkillRanks}[1]{
	\ifthenelse{\equal{#1}{}}{
		\AddFavoredClassSkillRanks{\value{CharSpareFavoredClassLevelsCount}}
	}{
		\AddToCounter{CharSpareSkillRanksCount}{#1}
		\AddToCounter{CharSpareFavoredClassLevelsCount}{-#1}
	}
}

\NewDocumentCommand{\AddFavoredClassSpecial}{m O{} O{*1}}{
	\ifthenelse{\equal{#1}{}}{
		\AddFavoredClassSpecial{\arabic{CharSpareFavoredClassLevelsCount}}[#2][#3]
	}{
		\newcommand\FavoredClassSpecialDo[1]{
			#2{##1}
		}
		\FavoredClassSpecialDo{#1#3}
		\AddToCounter{CharSpareFavoredClassLevelsCount}{-#1}
	}
}

\newcommand{\datafolder}{.}
%% Class Importing %%
\NewCounter{CharTotalLevelCount}
\SetCounter{CharTotalLevelCount}{0}
\NewCounter{CharSpareSkillRanksCount}
\NewCounter{HP-Mode}
\edef\CharClassesList{}
\NewDocumentCommand{\ImportCharClass}{s O{} m O{} m}{
	
	\AddDebug{IMPORTCHARCLASS: add #5 Levels of #4 #3}
	\ifthenelse{\equal{#4}{}}{
		\input{"\datafolder/Classes/#3.tex"}
	}{
		\input{"\datafolder/Classes/#3_#4.tex"}
	}
	\ifthenelse{\equal{#2}{}}{
		\appto\CharLevel{\capitalize{#3} #5 }
	}{
		\appto\CharLevel{#2 #5 }
	}
	\listadd{\CharClassesList}{#3}
	\if\csname#3BAB\endcsname g
		\AddToCounter{CharBABCount}{#5}
	\fi
	\if\csname#3BAB\endcsname a
		\AddToCounter{CharBABCount}{#5 * 3 / 4}
	\fi
	\if\csname#3BAB\endcsname p
		\AddToCounter{CharBABCount}{#5 / 2}
	\fi
	\if\csname#3Fort\endcsname g
		\AddToCounter{CharFortitudeCount}{2 + #5 / 2}
	\fi
	\if\csname#3Fort\endcsname p
		\AddToCounter{CharFortitudeCount}{#5 / 3}
	\fi
	\if\csname#3Ref\endcsname g
		\AddToCounter{CharReflexCount}{2 + #5 / 2}
	\fi
	\if\csname#3Ref\endcsname p
		\AddToCounter{CharReflexCount}{#5 / 3}
	\fi
	\if\csname#3Will\endcsname g
		\AddToCounter{CharWillCount}{2 + #5 / 2}
	\fi
	\if\csname#3Will\endcsname p
		\AddToCounter{CharWillCount}{#5 / 3}
	\fi
	\NewCounter{Char#3ClassLevelCount}
	\SetCounter{Char#3ClassLevelCount}{#5}
	\ifthenelse{\value{CharTotalLevelCount} = 0}{
		\ifthenelse{\value{HP-Mode} = 1}{
			\AddToCounter{CharHPCount}{\value{#3HitDieSize}}
			\AddToCounter{CharHPRollsCount}{1}
		}{
			\ifthenelse{\value{HP-Mode} = 2}{
				\AddToCounter{CharHPCount}{\value{#3HitDieSize} + (\value{#3HitDieSize} + 1) * (#5 - 1) / 2}
			}
			{}
		}
	}{
		\ifthenelse{\value{HP-Mode} = 1}{
		}{
			\ifthenelse{\value{HP-Mode} = 2}{
				\AddToCounter{CharHPCount}{(\value{#3HitDieSize} + 1) * #5 / 2}
			}
			{}
		}
	}
	\AddToCounter{CharTotalLevelCount}{#5}
	\AddToCounter{CharSpareSkillRanksCount}{(\value{#3SkillRanksPerLevelCount} + \value{CharBonusSkillRanksPerLevelCount})* #5}
	\renewcommand\do[1]{
		\isClassSkill{##1}
	}\expandafter\dolistloop\csname#3ClassSkillsList\endcsname
	\csname Add#3ClassFeatures\endcsname{#5}
	\IfBooleanT #1 {\AdddToCounter{CharSpareFavoredClassLevelsCount}{#5}}
}

\NewDocumentCommand{\ImportCharRace}{m}{
	\input{\datafolder/Races/#1.tex}
}

%%%% Skills %%%%

% Define Skills lists
\edef\SkillsList{}
\edef\KnowledgeSkillsList{}
\forcsvlist{\listadd\KnowledgeSkillsList}{KnowledgeArcana, KnowledgeDungeoneering, KnowledgeEngineering, KnowledgeGeography, KnowledgeHistory, KnowledgeLocal, KnowledgeNature, KnowledgeNobility, KnowledgePlanes, KnowledgeReligion}
\forcsvlist{\listadd\SkillsList}{Acrobatics, Appraise, Bluff, Climb, CraftOne, CraftTwo, CraftThree, Diplomacy, DisableDevice, Disguise, EscapeArtist, Fly, HandleAnimal, Heal, Intimidate, Linguistics, Perception, PerformOne, PerformTwo, PerformThree, ProfessionOne, ProfessionTwo, Ride, SenseMotive, SleightOfHand, Spellcraft, Stealth, Survival, Swim, UseMagicDevice}
\forlistloop{\listadd\SkillsList}{\KnowledgeSkillsList}

%Define lists for Armor check penalty and trained-only
\edef\ArmorCheckSkillsList{}
\forcsvlist{\listadd\ArmorCheckSkillsList}{Acrobatics, Climb, DisableDevice, EscapeArtist, Fly, Ride, SleightOfHand, Stealth, Swim}
\edef\TrainedSkillsList{}
\forcsvlist{\listadd\TrainedSkillsList}{DisableDevice, HandleAnimal, Linguistics, ProfessionOne, ProfessionTwo, SleightofHand, Spellcraft, UseMagicDevice}
\forlistloop{\listadd\TrainedSkillsList}{\KnowledgeSkillsList}


% Default "Optional" for Craft, Profession, Perform categories
\renewcommand\do[1]{
	\expandafter\newcommand\csname Char#1Name\endcsname{Optional}
}\docsvlist{CraftOne,CraftTwo,CraftThree,ProfessionOne,ProfessionTwo,PerformOne,PerformTwo}

%Initialize Skill variables
\renewcommand{\do}[1]{
	\NewCounter{Char#1Count}
	\NewCounter{Char#1ClassSkillBool}
	\NewCounter{Char#1RanksCount}
	\NewCounter{Char#1MiscCount}
}\dolistloop{\SkillsList}
\NewCounter{Tmpistrained}
\NewCounter{Tmptrainedvalue}

%Adds Skill to Class Skill list
\newcommand\isClassSkill[1]{
	\ifthenelse{\equal{#1}{KnowledgeAll}}{
		\forlistloop{\isClassSkill}{\KnowledgeSkillsList}
	}{\ifthenelse{\equal{#1}{Craft}}{
		\forcsvlist{\isClassSkill}{CraftOne, CraftTwo, CraftThree}
	}{\ifthenelse{\equal{#1}{Perform}}{
		\forcsvlist{\isClassSkill}{PerformOne, PerformTwo}
	}{\ifthenelse{\equal{#1}{Profession}}{
		\forcsvlist{\isClassSkill}{ProfessionOne, ProfessionTwo}
	}{
		\SetCounter{Char#1ClassSkillBool}{1}
	}}}}
}

%Command to add Skill Ranks
\newcommand\AddRanks[2]{
	\AddToCounter{Char#1RanksCount}{#2}
	\AddToCounter{CharSpareSkillRanksCount}{-#2}
}

\newCounter{CharBonusSkillRanksPerLevelCount}
%Commands to be run at sheet initialization
\NewCounter{AutoSkillRanks-Mode}
\newcommand{\AddIntToSkillRanks}{
	\ifthenelse{\value{AutoSkillRanks-Mode} = 1}{
		\SetCounter{@j}{(\value{CharIntCount} - \value{CharIntTmpCount}) / 2 - 5}
		\renewcommand\do[1]{
			\SetCounter{@k}{\value{@j} + \value{##1SkillRanksPerLevelCount}}
			\AddDebug{Class \# \arabic{@i} is: ##1}
			\ifthenelse{\value{@k} < 1}{
				\AddDebug{Min 1 rank per Level}
				\AddToCounter{CharSpareSkillRanksCount}{(1 - \value{##1SkillRanksPerLevelCount}) * \value{Char##1ClassLevelCount}}
			}{
				\AddToCounter{CharSpareSkillRanksCount}{\value{@j} * \value{Char##1ClassLevelCount}}
			}
		}\dolistloop{\CharClassesList}
	}{}
}


%%%% Character Name & Description %%%%

\newcommand\CharName{}
\newcommand\CharLevel{}
\newcommand\CharPlayerName{}
\newcommand\CharAlignment{}
\newcommand\CharReligion{}
\newcommand\CharRace{}
\newcommand\CharHomeland{}
\newcommand\CharSize{}
\newcommand\CharGender{}
\newcommand\CharAge{}
\newcommand\CharHeight{}
\newcommand\CharWeight{}
\newcommand\CharHair{}
\newcommand\CharEyes{}


%%%% Items %%%%

%%Gear%%
\edef\CharGearList{}
\newlength{\GearItemWeight}
\NewDocumentCommand{\AddGearItem}{s O{1} m m}{%
	\IfBooleanTF #1 {%
		\AddToLength{\ExtradimensionalGearWeight}{#2pt * #4}%
		\listadd{\CharGearList}{#3\ifnum #2 > 1{ (#2)}\fi &\SetLength{\GearItemWeight}{#2pt * #4} *\PrintWeight{\GearItemWeight}~lbs.}
	}{%
		\AddToLength{\TotalGearWeight}{#2pt * #4}%
		\listadd{\CharGearList}{#3\ifnum #2 > 1{ (#2)}\fi & \SetLength{\GearItemWeight}{#2pt * #4}\PrintWeight{\GearItemWeight}~lbs.}
	}
}
\newcommand\AddGearSubItem[3][1]{
	\listadd{\CharGearList}{---#2\ifnum #1 > 1{ (#1)} & (\DoMath{#1 * #3}~lbs.) \tabularnewline}
}

%%Stored Items%%
\edef\StoredItemsList{}
\newcommand\AddStoredItem[3][1]{
	\AddToLength{\TotalStoredWeight}{#1 pt * #3}%
	\listadd{\StoredItemsList}{#2\ifnum #1 > 1{ (#1)}\fi & \DoMath{#1 * #3}~lbs.}
}
\newcommand\AddStoredSubItem[3][1]{
	\listadd{\StoredItemsList}{---#2\ifnum #1 > 1{ (#1)} & (\DoMath{#1 * #3}~lbs.) \tabularnewline}
}

%%Weapons
\renewcommand\do[1]{%
	\expandafter\newcommand\csname CharWeapon#1Name\endcsname{}%
	\expandafter\newcommand\csname CharWeapon#1AttackBonus\endcsname{}%
	\NewCounter{CharWeapon#1MiscCount}%
	\expandafter\newcommand\csname CharWeapon#1Damage\endcsname{}%
	\expandafter\newcommand\csname CharWeapon#1Critical\endcsname{}%
	\expandafter\newcommand\csname CharWeapon#1Type\endcsname{}%
	\expandafter\newcommand\csname CharWeapon#1Range\endcsname{}%
	\expandafter\newcommand\csname CharWeapon#1Notes\endcsname{}%
	\expandafter\newcommand\csname AddWeapon#1\endcsname[7]{%
		\expandafter\renewcommand\csname CharWeapon#1Name\endcsname{##1}
		\expandafter\renewcommand\csname CharWeapon#1AttackBonus\endcsname{##2}
		\expandafter\renewcommand\csname CharWeapon#1Damage\endcsname{##3}
		\expandafter\renewcommand\csname CharWeapon#1Critical\endcsname{##4}
		\expandafter\renewcommand\csname CharWeapon#1Type\endcsname{##5}
		\expandafter\renewcommand\csname CharWeapon#1Range\endcsname{##6}
		\expandafter\renewcommand\csname CharWeapon#1Notes\endcsname{##7}
	}
	\expandafter\newcommand\csname AddAutoWeapon#1\endcsname[9][0]{%
		\expandafter\renewcommand\csname CharWeapon#1Name\endcsname{##2}
		\expandafter\renewcommand\csname CharWeapon#1AttackBonus\endcsname{%
			\ifthenelse{\equal{\lowercase{##7}}{\lowercase{Melee}}}{%
				\AddDebug{Weapon #1 is a Melee Weapon}
				\SetCounter{CharIteratedAttackBonusCount}{%
					\value{CharBABCount}+
					\value{Char##9ModCount}+%Ability score Mod
					\value{CharSizeModCount}+
					\value{CharMeleeMiscCount}+
					\value{CharMeleeTmpCount}+
					\value{CharWeapon#1MiscCount}+
					##3
				}
			}{%
				\AddDebug{Weapon #1 is a Ranged Weapon}
				\SetCounter{CharIteratedAttackBonusCount}{%
					\value{CharBABCount}+
					\value{Char##9ModCount}+%Ability score Mod
					\value{CharSizeModCount}+
					\value{CharRangedMiscCount}+
					\value{CharRangedTmpCount}+
					\value{CharWeapon#1MiscCount}+
					##3
				}
			}
			\ForLoop{@i}{0}{\value{@i}<##1}{%
				\ifthenelse{\value{@i}=0}{}{/}%
				\PlusMinus{CharIteratedAttackBonusCount}%
			}%
			\ForLoop{@i}{0}{\value{@i}<\value{CharIteratedAttacksCount}}{%
				\ifthenelse{\value{@i}=0}{\ifthenelse{##1 = 0}{}{/}}{/}%
				\PlusMinus{CharIteratedAttackBonusCount}%
				\SetCounter{CharIteratedAttackBonusCount}{\value{CharIteratedAttackBonusCount}-5}%
			}%
		}%
		\expandafter\renewcommand\csname CharWeapon#1Damage\endcsname{##4}%
		\expandafter\renewcommand\csname CharWeapon#1Critical\endcsname{##5}%
		\expandafter\renewcommand\csname CharWeapon#1Type\endcsname{##6}
		\expandafter\renewcommand\csname CharWeapon#1Range\endcsname{##7}
		\expandafter\renewcommand\csname CharWeapon#1Notes\endcsname{##8}
	}
}
\docsvlist{One,Two,Three}	

\newcommand\AddWeapon[7]{%
	\ifthenelse{\equal{\CharWeaponOneName}{}}
	{\AddWeaponOne{#1}{#2}{#3}{#4}{#5}{#6}{#7}}
	{\ifthenelse{\equal{\CharWeaponTwoName}{}}
		{\AddWeaponTwo{#1}{#2}{#3}{#4}{#5}{#6}{#7}}
		{\ifthenelse{\equal{\CharWeaponThreeName}{}}
			{\AddWeaponThree{#1}{#2}{#3}{#4}{#5}{#6}{#7}}
			{\AddWeaponOne{#1}{#2}{#3}{#4}{#5}{#6}{#7}
}}}}

\newcommand\AddAutoWeapon[9][0]{
	\ifthenelse{\equal{\CharWeaponOneName}{}}
	{\AddAutoWeaponOne[#1]{#2}{#3}{#4}{#5}{#6}{#7}{#8}{#9}}
	{\ifthenelse{\equal{\CharWeaponTwoName}{}}
		{\AddAutoWeaponTwo[#1]{#2}{#3}{#4}{#5}{#6}{#7}{#8}{#9}}
		{\ifthenelse{\equal{\CharWeaponThreeName}{}}
			{\AddAutoWeaponThree[#1]{#2}{#3}{#4}{#5}{#6}{#7}{#8}{#9}}
			{\AddAutoWeaponOne[#1]{#2}{#3}{#4}{#5}{#6}{#7}{#8}{#9}
}}}}

%Initialize Armor Item variables
\NewCounter{TotalACItemsSpellFailure}
\NewCounter{CharMaxDexArmorCount}
\SetCounter{CharMaxDexArmorCount}{100}
\NewCounter{CharMaxDexShieldCount}
\SetCounter{CharMaxDexShieldCount}{100}
\NewCounter{CharMaxDexBonusCount}
\SetCounter{CharMaxDexBonusCount}{100}
\NewCounter{CharDextoACCount}
\newcommand{\CharArmorName}{}
\newcommand{\CharArmorNotes}{}
\newcommand{\CharArmorType}{}
\NewCounter{CharArmorArmorCheckPenaltyCount}
\NewCounter{CharArmorSpellFailureCount}
\newcommand{\CharShieldName}{}
\newcommand{\CharShieldNotes}{}
\NewCounter{CharShieldArmorCheckPenaltyCount}
\NewCounter{CharShieldSpellFailureCount}

%Command to add an armor item
\newcommand\AddArmor[9]{
	\renewcommand{\CharArmorName}{#1}
	\AddArmorBonus{#2}
	\ifthenelse{\equal{#3}{}}{}{\SetCounter{CharMaxDexArmorCount}{#3}}
	\ifthenelse{\value{CharMaxDexArmorCount}<\value{CharMaxDexBonusCount}}
	{\SetCounter{CharMaxDexBonusCount}{\value{CharMaxDexArmorCount}}}{}
	\AddToCounter{CharArmorArmorCheckpenaltyCount}{#4}
	\renewcommand{\do}[1]{
		\MiscBonus{##1}{#4}
	}\dolistloop{\ArmorCheckSkillsList}
	\AddToCounter{CharArmorSpellFailureCount}{#5}
	\AddToCounter{TotalACItemsSpellFailure}{#5}
	\renewcommand{\CharArmorType}{#6}
	\renewcommand{\CharArmorNotes}{#8}
	\AddArmorItem{#1}{#9}{#7}
}

%Command to add a shield item
\newcommand\AddShield[7]{
	\AddShieldBonus{#2}
	\ifthenelse{\equal{#3}{}}{}{\SetCounter{CharMaxDexShieldCount}{#3}}
	\ifthenelse{\value{CharMaxDexShieldCount}<\value{CharMaxDexBonusCount}}
	{\SetCounter{CharMaxDexBonusCount}{\value{CharMaxDexShieldCount}}}{}
	\AddCounter{CharShieldArmorCheckPenaltyCount}{#4}
	\renewcommand{\do}[1]{
		\MiscBonus{##1}{#4}
	}\dolistloop{\ArmorCheckSkillsList}
	\SetCounter{CharShieldSpellFailureCount}{#5}
	\AddToCounter{TotalACItemsSpellFailure}{#5}
	\renewcommand{\CharShieldNotes}{#7}
	\AddGearItem{#1}{#6}
}

%Initialize variables for Item Slots
\let\ItemSlotNamesList\@empty
\forcsvlist{\listadd{\ItemSlotNamesList}}{Armor, Belt, Body, Chest, Eyes, Feet, Hands, Head, Headband, Neck, RingOne, RingTwo, Shoulders, Wrists}
\renewcommand{\do}[1]{
	\expandafter\newcommand\csname ItemInSlot#1Name\endcsname{}
	\expandafter\newcommand\csname ItemInSlot#1Description\endcsname{}
	\expandafter\newlength\csname ItemInSlot#1Weight\endcsname
	\expandafter\newcommand \csname Add#1Item\endcsname[3]{
		\expandafter\renewcommand\csname ItemInSlot#1Name\endcsname{\itshape ##1}
		\expandafter\renewcommand\csname ItemInSlot#1Description\endcsname{##2}
		\SetLength{\csname ItemInSlot#1Weight\endcsname}{##3pt}
		\AddToLength{\WornItemsWeight}{##3pt}
	}
}\dolistloop{\ItemSlotNamesList}
\newcommand{\AddRingItem}[3]{
	\ifthenelse{\not\equal{\ItemInSlotRingOneName}{}\and\equal{\ItemInSlotRingTwoName}{}}
	{\AddRingTwoItem{#1}{#2}{#3}}
	{\AddRingOneItem{#1}{#2}{#3}}}

%%Money
\renewcommand{\do}[1]{
	\NewCounter{Char#1Count}
	\NewCounter{Char#1WeightlessCount}
	\NewCounter{Char#1StoredCount}
	\expandafter\newcommand\csname Store#1\endcsname[1]{\AddToCounter{Char#1StoredCount}{##1}}
	
}\docsvlist{Platinum, Gold, Silver, Copper}
\expandafter\newcommand\csname AddPlatinum\endcsname{\@ifstar\@@addPlatinum\@addPlatinum}
\expandafter\newcommand\csname @addPlatinum\endcsname[1]{\AddToCounter{CharPlatinumCount}{#1}}
\expandafter\newcommand\csname @@addPlatinum\endcsname[1]{\AddToCounter{CharPlatinumWeightlessCount}{#1}}
\expandafter\newcommand\csname AddGold\endcsname{\@ifstar\@@addGold\@addGold}
\expandafter\newcommand\csname @addGold\endcsname[1]{\AddToCounter{CharGoldCount}{#1}}
\expandafter\newcommand\csname @@addGold\endcsname[1]{\AddToCounter{CharGoldWeightlessCount}{#1}}
\expandafter\newcommand\csname AddSilver\endcsname{\@ifstar\@@addSilver\@addSilver}
\expandafter\newcommand\csname @addSilver\endcsname[1]{\AddToCounter{CharSilverCount}{#1}}
\expandafter\newcommand\csname @@addSilver\endcsname[1]{\AddToCounter{CharSilverWeightlessCount}{#1}}
\expandafter\newcommand\csname AddCopper\endcsname{\@ifstar\@@addCopper\@addCopper}
\expandafter\newcommand\csname @addCopper\endcsname[1]{\AddToCounter{CharCopperCount}{#1}}
\expandafter\newcommand\csname @@addCopper\endcsname[1]{\AddToCounter{CharCopperWeightlessCount}{#1}}

%%Weight
\newlength{\TotalGearWeight}
\newlength{\TotalStoredWeight}
\newlength{\WornItemsWeight}
\newlength{\CurrencyWeight}
\newlength{\TotalCarriedWeight}
\newlength{\ExtradimensionalGearWeight}
\newlength{\ExtradimensionalCurrencyWeight}
\newlength{\TotalExtradimensionalWeight}
\newlength{\ExtradimensionalOverload}
\newcommand{\CalculateWeights}{
	\SetLength{\CurrencyWeight}{.02pt*\value{CharPlatinumCount}+.02pt*\value{CharGoldCount}+.02pt*\value{CharSilverCount}+.02pt*\value{CharCopperCount}}
	\SetLength{\ExtradimensionalCurrencyWeight}{.02pt*\value{CharPlatinumWeightlessCount}+.02pt*\value{CharGoldWeightlessCount}+.02pt*\value{CharSilverWeightlessCount}+.02pt*\value{CharCopperWeightlessCount}}
	\SetLength{\TotalExtradimensionalWeight}{\ExtradimensionalGearWeight+\ExtradimensionalCurrencyWeight}
	\SetLength{\ExtradimensionalOverload}{\TotalExtradimensionalWeight - \value{CharExtradimensionalCapacityCount}pt}
	\ifthenelse{\ExtradimensionalOverload > 0}{
		\AddToLength{\TotalGearWeight}{\ExtradimensionalOverload}
	}{}
	\SetLength{\TotalCarriedWeight}{\TotalGearWeight+\CurrencyWeight+\WornItemsWeight}
}

%%Carrying Capacity
\NewCounter{CharHeavyLoadCount}
\NewCounter{CharMediumLoadCount}
\NewCounter{CharLightLoadCount}
\NewCounter{CharStrCarryingMiscCount}
\NewCounter{CharStrCarryingCount}
\NewCounter{CharLiftLoadCount}
\NewCounter{CharDragLoadCount}
\NewCounter{CharExtradimensionalCapacityCount}

\NewCounter{CarryingCapacityMultiplierCount}
\SetCounter{CarryingCapacityMultiplierCount}{1}
\newcommand\SetHeavyLoad[1]{%
	\ifthenelse{\value{#1}>19}{%
		\SetCounter{@j}{\value{#1}-10}%
		\SetHeavyLoad{@j}
		\AddToCounter{@i}{\value{@i}}
		\AddToCounter{@i}{\value{@i}}
	}{%
		\SetCounter{@j}{\value{#1}}
		\ForLoop{@i}{0}{\value{@i}<10}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{10}\AddToCounter{@j}{-1}}{}}
		\ForLoop{@i}{0}{\value{@i}<2}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{15}\AddToCounter{@j}{-1}}{}}
		\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{20}\AddToCounter{@j}{-1}}{}
		\ForLoop{@i}{0}{\value{@i}<2}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{25}\AddToCounter{@j}{-1}}{}}
		\ForLoop{@i}{0}{\value{@i}<2}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{30}\AddToCounter{@j}{-1}}{}}
		\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{40}\AddToCounter{@j}{-1}}{}
		\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{50}\AddToCounter{@j}{-1}}{}
=======
		\setCounter{@j}{\value{#1}}
		\forloop{@k}{0}{\value{@k}<10}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{10}\AddToCounter{@j}{-1}}{}}
		\forloop{@k}{0}{\value{@k}<2}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{15}\AddToCounter{@j}{-1}}{}}
		\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{20}\AddToCounter{@j}{-1}}{}
		\forloop{@k}{0}{\value{@k}<2}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{25}\AddToCounter{@j}{-1}}{}}
		\forloop{@k}{0}{\value{@k}<2}{
			\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{30}\AddToCounter{@j}{-1}}{}}
		\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{40}\AddToCounter{@j}{-1}}{}
		\ifthenelse{\value{@j}>0}{\AddToCounter{@i}{50}\AddToCounter{@j}{-1}}{}
>>>>>>> .
	}
}
\newcommand\CalculateLoads{
	\SetCounter{@i}{0}
	\SetCounter{@j}{\value{CharStrCount}+\value{CharStrCarryingMiscCount}}
	\SetHeavyLoad{@j}
	\SetCounter{CharHeavyLoadCount}{\value{@i}*\value{CarryingCapacityMultiplierCount}}
	\SetCounter{CharMediumLoadCount}{\value{CharHeavyLoadCount}*2/3}
	\SetCounter{CharLightLoadCount}{\value{CharHeavyLoadCount}/3}
	\SetCounter{CharLiftLoadCount}{\value{CharHeavyLoadCount}*2}
	\SetCounter{CharDragLoadCount}{\value{CharHeavyLoadCount}*5}
}

\NewCounter{CharEncumberanceLevelCount}
\NewCounter{CharEncumberedMaxDexCount}
\SetCounter{CharEncumberedMaxDexCount}{100}
\NewCounter{CharEncumberedArmorCheckPenaltyCount}
\NewCounter{CharEncumberedSpeedReducedBool}
\newlength\loadaslength

\newcommand\CheckEncumberance{
	\SetLength\loadaslength{1pt*\value{CharLightLoadCount}}
	\ifthenelse{\lengthtest{\TotalCarriedWeight<\loadaslength}}{ 
		\SetCounter{CharEncumberanceLevelCount}{1}}{
		\SetLength\loadaslength{1pt*\value{CharMediumLoadCount}}
		\ifthenelse{\lengthtest{\TotalCarriedWeight<\loadaslength}}{
			\SetCounter{CharEncumberanceLevelCount}{2}
			\SetCounter{CharEncumberedArmorCheckPenaltyCount}{-3}
			\SetCounter{CharEncumberedMaxDexCount}{3}
			\SetCounter{CharEncumberedSpeedReducedBool}{\value{CharSpeedReducibleBool}}}{
			\SetLength\loadaslength{1pt*\value{CharHeavyLoadCount}}
			\ifthenelse{\lengthtest{\TotalCarriedWeight<\loadaslength}}{
				\SetCounter{CharEncumberanceLevelCount}{3}
				\SetCounter{CharEncumberedArmorCheckPenaltyCount}{-6}
				\SetCounter{CharEncumberedMaxDexCount}{1}
				\SetCounter{CharEncumberedSpeedReducedBool}{\value{CharSpeedReducibleBool}}}{
				\SetCounter{CharEncumberanceLevelCount}{4}
				\SetCounter{CharEncumberedArmorCheckPenaltyCount}{-10}
				\SetCounter{CharEncumberedMaxDexCount}{0}
				\SetCounter{CharEncumberedSpeedReducedBool}{\value{CharSpeedReducibleBool}}}}}
	\ifthenelse{\value{CharEncumberedMaxDexCount}<\value{CharMaxDexBonusCount}}
	{\SetCounter{CharMaxDexBonusCount}{\value{CharEncumberedMaxDexCount}}}{}
	\renewcommand{\do}[1]{
		\MiscBonus{##1}{\value{CharEncumberedArmorCheckPenaltyCount}}
	}\dolistloop{\ArmorCheckSkillsList}
}

\newcommand\EncumberanceBox[1]{
	\ifthenelse{#1 = \value{CharEncumberanceLevelCount}}{$\cancel{\square}$}{$\square$}
}

%%%% Spells %%%%

\renewcommand{\do}[1]{
	\expandafter\edef\csname CharCantripsList#1\endcsname{}
	\expandafter\edef\csname CharFirstSpellsList#1\endcsname{}
	\expandafter\edef\csname CharSecondSpellsList#1\endcsname{}
	\expandafter\edef\csname CharThirdSpellsList#1\endcsname{}
	\expandafter\edef\csname CharFourthSpellsList#1\endcsname{}
	\expandafter\edef\csname CharFifthSpellsList#1\endcsname{}
	\expandafter\edef\csname CharSixthSpellsList#1\endcsname{}
	\expandafter\edef\csname CharSeventhSpellsList#1\endcsname{}
	\expandafter\edef\csname CharEighthSpellsList#1\endcsname{}
	\expandafter\edef\csname CharNinthSpellsList#1\endcsname{}
}\docsvlist{One,Two}


\def\AddCantripOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharCantripsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{0& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddFirstSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharFirstSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{1& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddSecondSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharSecondSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{2& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddThirdSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharThirdSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{3& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddFourthSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharFourthSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{4& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddFifthSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharFifthSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{5& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddSixthSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharSixthSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{6& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddSeventhSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharSeventhSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{7& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddEighthSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharEighthSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{8& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddNinthSpellOne #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharNinthSpellsListOne}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{9& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}

\def\AddCantripTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharCantripsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{0& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddFirstSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharFirstSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{1& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddSecondSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharSecondSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{2& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddThirdSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharThirdSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{3& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddFourthSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharFourthSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{4& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddFifthSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharFifthSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{5& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddSixthSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharSixthSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{6& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddSeventhSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharSeventhSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{7& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddEighthSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharEighthSpellsListTwo}{#1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{8& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}
\def\AddNinthSpellTwo #1|#2|#3|#4|#5|#6|#7|#8|#9|{ %
	\listinsert{\CharNinthSpellsListTwo}{##1}
	\def\lastargs ##1|##2|{
		\expandafter\def\csname #1\endcsname{9& & & #1: #2 & #3 & #9 & #6 & ##1 & ##2\\\hline}
		\expandafter\def\csname Spell#1header\endcsname{
			\noindent{\bf\large#1}
			\\#3
			\\\textbf{Components} #4
			\\\textbf{Casting Time} #5
			\\\textbf{Range} #6
			\\\textbf{#7} #8
			\\\textbf{Duration} #9
			\\\textbf{Saving Throw} ##1; \textbf{Spell Resistance} ##2
		}
	}
	\lastargs
}

\newcommand{\AddCantrip}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddCantripOne#1}{\AddCantripTwo#1}
}
\newcommand{\AddFirstSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddFirstSpellOne#1}{\AddFirstSpellTwo#1}
}
\newcommand{\AddSecondSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddSecondSpellOne#1}{\AddSecondSpellTwo#1}
}
\newcommand{\AddThirdSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddThirdSpellOne#1}{\AddThirdSpellTwo#1}
}
\newcommand{\AddFourthSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddFourthSpellOne#1}{\AddFourthSpellTwo#1}
}
\newcommand{\AddFifthSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddFifthSpellOne#1}{\AddFifthSpellTwo#1}
}
\newcommand{\AddSixthSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddSixthSpellOne#1}{\AddSixthSpellTwo#1}
}
\newcommand{\AddSeventhSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddSeventhSpellOne#1}{\AddSeventhSpellTwo#1}
}
\newcommand{\AddEighthSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddEighthSpellOne#1}{\AddEighthSpellTwo#1}
}
\newcommand{\AddNinthSpell}[1]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddNinthSpellOne}{\AddNinthSpellTwo}
}
\newcommand\Spelldescription[2]{
	\expandafter\newcommand\csname Spell#1description\endcsname{#2}
}

\renewcommand{\do}[1]{
	\expandafter\newcommand\csname CharSpellcastingClass#1\endcsname{}
	\expandafter\newcommand\csname CharSpellcastingClass#1Ability\endcsname{}
	\NewCounter{CharCL#1Count}
	\NewCounter{CharSpellcastingClass#1maxSpellLevelCount}
	\SetCounter{CharSpellcastingClass#1maxSpellLevelCount}{-1}
	\NewCounter{CharSpellcasting#1hascantrips}
	\SetCounter{CharSpellcasting#1hascantrips}{0}
	\expandafter\NewDocumentCommand\csname NewSpellcasting#1\endcsname{s O{9} m m m}{
		\IfBooleanF ##1 {\SetCounter{CharSpellcasting#1hascantrips}{1}}
		\SetCounter{CharSpellcastingClass#1maxSpellLevelCount}{##2}
		\expandafter\renewcommand\csname CharSpellcastingClass#1\endcsname{##3}
		\expandafter\renewcommand\csname CharSpellcastingClass#1Ability\endcsname{##5}
		\SetCounter{CharCL#1Count}{##4}
	}
}\docsvlist{One,Two}

\NewDocumentCommand{\newSpellcasting}{s O{9} m m m}{
	\ifthenelse{\equal{\CharSpellcastingClassOne}{}}{
		\IfBooleanTF #1 {\newSpellcastingOne*[#2]{#3}{#4}{#5}} {\newSpellcastingOne[#2]{#3}{#4}{#5}}
	}{
		\IfBooleanTF #1 {\newSpellcastingTwo*[#2]{#3}{#4}{#5}} {\newSpellcastingTwo[#2]{#3}{#4}{#5}}
	}
}

\newcommand{\AddPrimarySpellcasting}[1]{
	\AddSpellslots{0}{3}
	\AddSpellslots{1}{1}
	\ifthenelse{#1 > 1}{
		\AddSpellslots{0}{1}
		\AddSpellslots{1}{1}
		\ifthenelse{#1 > 2}{
			\AddSpellslots{2}{1}
			\ifthenelse{#1 > 3}{
				\AddSpellslots{0}{1}
				\AddSpellslots{1}{1}
				\AddSpellslots{2}{1}
				\ifthenelse{#1 > 4}{
					\AddSpellslots{3}{1}
					\ifthenelse{#1 > 5}{
						\AddSpellslots{2}{1}
						\AddSpellslots{3}{1}
						\ifthenelse{#1 > 6}{
							\AddSpellslots{4}{1}
							\AddSpellslots{0}{1}
							\AddSpellslots{1}{1}
							\ifthenelse{#1 > 7}{
								\AddSpellslots{3}{1}
								\AddSpellslots{4}{1}
								\ifthenelse{#1 > 8}{
									\AddSpellslots{5}{1}
									\AddSpellslots{2}{1}
									\ifthenelse{#1 > 9}{
										\AddSpellslots{4}{1}
										\AddSpellslots{5}{1}	
										\ifthenelse{#1 > 10}{
											\AddSpellslots{6}{1}
											\AddSpellslots{3}{1}
											\AddSpellslots{1}{1}
											\ifthenelse{#1 > 11}{
												\AddSpellslots{5}{1}
												\AddSpellslots{6}{1}
												\ifthenelse{#1 > 12}{
													\AddSpellslots{7}{1}
													\AddSpellslots{4}{1}
													\AddSpellslots{2}{1}
													\ifthenelse{#1 > 13}{
														\AddSpellslots{6}{1}
														\AddSpellslots{7}{1}
														\ifthenelse{#1 > 14}{
															\AddSpellslots{8}{1}
															\AddSpellslots{5}{1}
															\AddSpellslots{3}{1}
															\ifthenelse{#1 > 15}{
																\AddSpellslots{7}{1}
																\AddSpellslots{8}{1}
																\ifthenelse{#1 > 16}{
																	\AddSpellslots{9}{1}
																	\AddSpellslots{6}{1}
																	\AddSpellslots{4}{1}
																	\ifthenelse{#1 > 17}{
																		\AddSpellslots{8}{1}
																		\AddSpellslots{9}{1}
																		\ifthenelse{#1 > 18}{
																			\AddSpellslots{7}{1}
																			\AddSpellslots{9}{1}
																			\AddSpellslots{5}{1}
																			\ifthenelse{#1 > 19}{
																				\AddSpellslots{8}{1}
																				\AddSpellslots{9}{1}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\AddSpontaneousPrimarySpellcasting}[1]{
	\AddSpellslots{0}{5}
	\AddSpellslots{1}{3}
	\ifthenelse{#1 > 1}{
		\AddSpellslots{0}{1}
		\AddSpellslots{1}{1}
		\ifthenelse{#1 > 2}{
			\AddSpellslots{1}{1}
			\ifthenelse{#1 > 3}{
				\AddSpellslots{1}{1}
				\AddSpellslots{2}{3}
				\ifthenelse{#1 > 4}{
					\AddSpellslots{2}{1}
					\ifthenelse{#1 > 5}{
						\AddSpellslots{2}{1}
						\AddSpellslots{3}{3}
						\ifthenelse{#1 > 6}{
							\AddSpellslots{2}{1}
							\AddSpellslots{3}{1}
							\ifthenelse{#1 > 7}{
								\AddSpellslots{3}{1}
								\AddSpellslots{4}{3}
								\ifthenelse{#1 > 8}{
									\AddSpellslots{3}{1}
									\AddSpellslots{4}{1}
									\ifthenelse{#1 > 9}{
										\AddSpellslots{4}{1}
										\AddSpellslots{5}{3}	
										\ifthenelse{#1 > 10}{
											\AddSpellslots{4}{1}
											\AddSpellslots{5}{1}
											\ifthenelse{#1 > 11}{
												\AddSpellslots{5}{1}
												\AddSpellslots{6}{3}
												\ifthenelse{#1 > 12}{
													\AddSpellslots{5}{1}
													\AddSpellslots{6}{1}
													\ifthenelse{#1 > 13}{
														\AddSpellslots{6}{1}
														\AddSpellslots{7}{3}
														\ifthenelse{#1 > 14}{
															\AddSpellslots{6}{1}
															\AddSpellslots{7}{1}
															\ifthenelse{#1 > 15}{
																\AddSpellslots{7}{1}
																\AddSpellslots{8}{3}
																\ifthenelse{#1 > 16}{
																	\AddSpellslots{7}{1}
																	\AddSpellslots{8}{1}
																	\ifthenelse{#1 > 17}{
																		\AddSpellslots{8}{1}
																		\AddSpellslots{9}{3}
																		\ifthenelse{#1 > 18}{
																			\AddSpellslots{8}{1}
																			\AddSpellslots{9}{1}
																			\ifthenelse{#1 > 19}{
																				\AddSpellslots{9}{2}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
	
}
\newcommand{\AddTwoThirdsSpellcasing}[1]{
	\AddSpellslots{0}{2}
	\AddSpellsKnown{0}{4}
	\ifthenelse{#1 > 1}{
		\AddSpellslots{0}{1}
		\AddSpellsKnown{0}{1}
		\AddSpellsKnown{1}{2}
		\ifthenelse{#1 > 2}{
			\AddSpellslots{1}{1}
			\AddSpellsKnown{0}{1}
			\AddSpellsKnown{1}{1}
			\ifthenelse{#1 > 3}{
				\AddSpellslots{1}{1}
				\AddSpellsKnown{2}{2}
				\ifthenelse{#1 > 4}{
					\AddSpellslots{1}{1}
					\AddSpellslots{2}{1}
					\AddSpellsKnown{1}{1}
					\AddSpellsKnown{2}{1}
					\ifthenelse{#1 > 5}{
						\AddSpellslots{2}{1}
						\ifthenelse{#1 > 6}{
							\AddSpellsKnown{2}{1}
							\AddSpellsKnown{3}{2}
							\ifthenelse{#1 > 7}{
								\AddSpellslots{2}{1}
								\AddSpellslots{3}{1}
								\AddSpellsKnown{3}{1}
								\ifthenelse{#1 > 8}{
									\AddSpellslots{3}{1}
									\ifthenelse{#1 > 9}{
										\AddSpellsKnown{3}{1}
										\AddSpellsKnown{4}{2}
										\ifthenelse{#1 > 10}{
											\AddSpellslots{3}{1}
											\AddSpellslots{4}{1}
											\AddSpellsKnown{4}{1}
											\ifthenelse{#1 > 11}{
												\AddSpellslots{4}{1}
												\ifthenelse{#1 > 12}{
													\AddSpellsKnown{4}{1}
													\AddSpellsKnown{5}{2}
													\ifthenelse{#1 > 13}{
														\AddSpellslots{0}{1}
														\AddSpellslots{4}{1}
														\AddSpellslots{5}{1}
														\AddSpellsKnown{5}{1}
														\ifthenelse{#1 > 14}{
															\AddSpellslots{1}{1}
															\AddSpellslots{5}{1}
															\ifthenelse{#1 > 15}{
																\AddSpellslots{2}{1}
																\AddSpellsKnown{1}{1}
																\AddSpellsKnown{5}{1}
																\AddSpellsKnown{6}{2}
																\ifthenelse{#1 > 16}{
																	\AddSpellslots{3}{1}
																	\AddSpellslots{5}{1}
																	\AddSpellslots{6}{1}
																	\AddSpellsKnown{2}{1}
																	\AddSpellsKnown{6}{1}
																	\ifthenelse{#1 > 17}{
																		\AddSpellslots{4}{1}
																		\AddSpellslots{6}{1}
																		\AddSpellsKnown{3}{1}
																		\ifthenelse{#1 > 18}{
																			\AddSpellslots{5}{1}
																			\AddSpellslots{6}{1}
																			\AddSpellsKnown{4}{1}
																			\AddSpellsKnown{6}{1}
																			\ifthenelse{#1 > 19}{
																				\AddSpellslots{6}{1}
																				\AddSpellsKnown{5}{1}
																			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}
\newcommand{\AddHalfSpellcasting}[1]{
	\ifthenelse{#1 > 5}{
		\AddSpellslots{1}{1}
		\ifthenelse{#1 > 9}{
			\AddSpellslots{2}{1}
			\ifthenelse{#1 > 11}{
				\AddSpellslots{3}{1}
				\ifthenelse{#1 > 13}{
					\AddSpellslots{1}{1}
					\ifthenelse{#1 > 14}{
						\AddSpellslots{4}{1}
						\ifthenelse{#1 > 15}{
							\AddSpellslots{2}{1}
							\ifthenelse{#1 > 16}{
								\AddSpellslots{3}{1}
								\ifthenelse{#1 > 17}{
									\AddSpellslots{1}{1}
									\ifthenelse{#1 > 18}{
										\AddSpellslots{2}{1}
										\AddSpellslots{3}{1}
										\AddSpellslots{4}{1}
										\ifthenelse{#1 > 19}{
											\AddSpellslots{4}{1}
										}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}

%Initialize Spellcasting variables
\ForLoop{@i}{0}{\value{@i}<10}{
	\NewCounter{CharAbilitySpellSlotsOne\arabic{@i}Count}
	\NewCounter{CharAbilitySpellSlotsTwo\arabic{@i}Count}
	\NewCounter{CharClassSpellSlotsOne\arabic{@i}Count}
	\NewCounter{CharClassSpellSlotsTwo\arabic{@i}Count}
	\NewCounter{CharBonusSpellSlotsOne\arabic{@i}Count}
	\NewCounter{CharBonusSpellSlotsTwo\arabic{@i}Count}
	\NewCounter{CharTotalSpellSlotsOne\arabic{@i}Count}
	\NewCounter{CharTotalSpellSlotsTwo\arabic{@i}Count}
	\NewCounter{CharSpellsKnownOne\arabic{@i}Count}
	\NewCounter{CharSpellsKnownTwo\arabic{@i}Count}
}

\newcommand{\InitializeSpellSlots}{
	\ifthenelse{\equal{\CharSpellcastingClassOneAbility}{}}{}{
		\SetCounter{CharTotalSpellSlotsOne0Count}{\value{CharClassSpellSlotsOne0Count} + \value{CharBonusSpellSlotsOne0Count}}
		\ForLoop{@i}{1}{\value{@i}<10}{
			\SetCounter{CharAbilitySpellSlotsOne\arabic{@i}Count}{(\value{Char\CharSpellcastingClassOneAbility ModCount}+4-\value{@i})/4}
			\SetCounter{CharTotalSpellSlotsOne\arabic{@i}Count}{
				\value{CharAbilitySpellSlotsOne\arabic{@i}Count} +
				\value{CharClassSpellSlotsOne\arabic{@i}Count} +
				\value{CharBonusSpellSlotsOne\arabic{@i}Count}
			}
		}
		\AddDebug{Adjusting max Spell Level for \CharSpellcastingClassOne}
		\AddDebug{-Ability score = \arabic{Char\CharSpellcastingClassOneAbility Count}}
		\AddDebug{-New max Spell Level = \DoMath{\value{Char\CharSpellcastingClassOneAbility Count} - 10}}
		\AddDebug{-Old max Spell Level = \arabic{CharSpellcastingClassOnemaxSpellLevelCount}}
		\DoMath*{\value{Char\CharSpellcastingClassOneAbility Count} - 10}
		\ifthenelse{\value{CharSpellcastingClassOnemaxSpellLevelCount} > \value{@DoMathCounter}}{
			\SetCounter{CharSpellcastingClassOnemaxSpellLevelCount}{\value{Char\CharSpellcastingClassOneAbility Count} - 10}
			\AddDebug{-Max Spell Level set to \arabic{CharSpellcastingClassOnemaxSpellLevelCount}}
		}{
			\AddDebug{-No adjustment needed}
		}
	}
	\ifthenelse{\equal{\CharSpellcastingClassTwoAbility}{}}{}{
		\SetCounter{CharTotalSpellSlotsTwo0Count}{\value{CharClassSpellSlotsTwo0Count} + \value{CharBonusSpellSlotsTwo0Count}}
		\ForLoop{@i}{1}{\value{@i}<10}{
			\SetCounter{CharAbilitySpellSlotsTwo\arabic{@i}Count}{(\value{Char\CharSpellcastingClassTwoAbility ModCount}+4-\value{@i})/4}
			\SetCounter{CharTotalSpellSlotsTwo\arabic{@i}Count}{
				\value{CharAbilitySpellSlotsTwo\arabic{@i}Count} +
				\value{CharClassSpellSlotsTwo\arabic{@i}Count} +
				\value{CharBonusSpellSlotsTwo\arabic{@i}Count}
			}
		}
		\AddDebug{Adjusting max Spell Level for \CharSpellcastingClassTwo}
		\AddDebug{-Ability score = \arabic{Char\CharSpellcastingClassTwoAbility Count}}
		\AddDebug{-New max Spell Level = \DoMath{\value{Char\CharSpellcastingClassTwoAbility Count} - 10}}
		\AddDebug{-Old max Spell Level = \arabic{CharSpellcastingClassTwomaxSpellLevelCount}}
		\DoMath*{\value{Char\CharSpellcastingClassTwoAbility Count} - 10}
		\ifthenelse{\value{CharSpellcastingClassTwomaxSpellLevelCount} > \value{@DoMathCounter}}{
			\SetCounter{CharSpellcastingClassTwomaxSpellLevelCount}{\value{Char\CharSpellcastingClassTwoAbility Count} - 10}
			\AddDebug{-Max Spell Level set to \arabic{CharSpellcastingClassTwomaxSpellLevelCount}}
		}{
			\AddDebug{-No adjustment needed}
		}
	}
}

\newcommand{\AddBonusSpellSlotsOne}[2]{
	\AddToCounter{CharBonusSpellSlotsOne#1Count}{#2}}
\newcommand{\AddBonusSpellSlotsTwo}[2]{
	\AddToCounter{CharBonusSpellSlotsTwo#1Count}{#2}}

\newcommand{\AddSpellSlotsOne}[2]{
	\AddToCounter{CharClassSpellSlotsOne#1Count}{#2}}
\newcommand{\AddSpellSlotsTwo}[2]{
	\AddToCounter{CharClassSpellSlotsTwo#1Count}{#2}}
\newcommand{\SetSpellSlotsOne}[2]{
	\SetCounter{CharClassSpellSlotsOne#1Count}{#2}}
\newcommand{\SetSpellSlotsTwo}[2]{
	\SetCounter{CharClassSpellSlotsTwo#1Count}{#2}}
\newcommand{\AddSpellsKnownOne}[2]{
	\AddToCounter{CharSpellsKnownOne#1Count}{#2}}
\newcommand{\AddSpellsKnownTwo}[2]{
	\AddToCounter{CharSpellsKnownTwo#1Count}{#2}}

\newcommand{\AddSpellSlots}[2]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddSpellSlotsOne{#1}{#2}}{\AddSpellSlotsTwo{#1}{#2}}}
\newcommand{\AddSpellsKnown}[2]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddSpellsKnownOne{#1}{#2}}{\AddSpellsKnownTwo{#1}{#2}}}
\newcommand{\AddBonusSpellSlots}[2]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddBonusSpellSlotsOne{#1}{#2}}{\AddBonusSpellSlotsTwo{#1}{#2}}
}

% Range
\NewCounter{CharSpellRangecloseCount}
\NewCounter{CharSpellRangemediumCount}
\NewCounter{CharSpellRangelongCount}
\newcommand{\calculateSpellRange}[1]{
	\SetCounter{CharSpellRangecloseCount}{25+\value{CharCL#1Count}/2*5}
	\SetCounter{CharSpellRangemediumCount}{100+\value{CharCL#1Count}*10}
	\SetCounter{CharSpellRangelongCount}{400+\value{CharCL#1Count}*40}
}

% Spells per day generation for full casters
\newcommand{\AddPrimarySpellcasting}[1]{
		\AddSpellSlots{0}{3}
		\AddSpellSlots{1}{1}
	\ifthenelse{#1 > 1}{
		\AddSpellSlots{0}{1}
		\AddSpellSlots{1}{1}
	\ifthenelse{#1 > 2}{
		\AddSpellSlots{2}{1}
	\ifthenelse{#1 > 3}{
		\AddSpellSlots{0}{1}
		\AddSpellSlots{1}{1}
		\AddSpellSlots{2}{1}
	\ifthenelse{#1 > 4}{
		\AddSpellSlots{3}{1}
	\ifthenelse{#1 > 5}{
		\AddSpellSlots{2}{1}
		\AddSpellSlots{3}{1}
	\ifthenelse{#1 > 6}{
		\AddSpellSlots{4}{1}
		\AddSpellSlots{0}{1}
		\AddSpellSlots{1}{1}
	\ifthenelse{#1 > 7}{
		\AddSpellSlots{3}{1}
		\AddSpellSlots{4}{1}
	\ifthenelse{#1 > 8}{
		\AddSpellSlots{5}{1}
		\AddSpellSlots{2}{1}
	\ifthenelse{#1 > 9}{
		\AddSpellSlots{4}{1}
		\AddSpellSlots{5}{1}
	\ifthenelse{#1 > 10}{
		\AddSpellSlots{6}{1}
		\AddSpellSlots{3}{1}
		\AddSpellSlots{1}{1}
	\ifthenelse{#1 > 11}{
		\AddSpellSlots{5}{1}
		\AddSpellSlots{6}{1}
	\ifthenelse{#1 > 12}{
		\AddSpellSlots{7}{1}
		\AddSpellSlots{4}{1}
		\AddSpellSlots{2}{1}
	\ifthenelse{#1 > 13}{
		\AddSpellSlots{6}{1}
		\AddSpellSlots{7}{1}
	\ifthenelse{#1 > 14}{
		\AddSpellSlots{8}{1}
		\AddSpellSlots{5}{1}
		\AddSpellSlots{3}{1}
	\ifthenelse{#1 > 15}{
		\AddSpellSlots{7}{1}
		\AddSpellSlots{8}{1}
	\ifthenelse{#1 > 16}{
		\AddSpellSlots{9}{1}
		\AddSpellSlots{6}{1}
		\AddSpellSlots{4}{1}
	\ifthenelse{#1 > 17}{
		\AddSpellSlots{8}{1}
		\AddSpellSlots{9}{1}
	\ifthenelse{#1 > 18}{
		\AddSpellSlots{7}{1}
		\AddSpellSlots{9}{1}
		\AdddSpellSlots{5}{1}
	\ifthenelse{#1 > 19}{
		\AddSpellSlots{8}{1}
		\AddSpellSlots{9}{1}
	}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
}

%Magic Specializations
\renewcommand{\do}[1]{
	\expandafter\newcommand\csname CharSpellcastingOneSpecialization#1\endcsname{}
	\expandafter\newcommand\csname CharSpellcastingOneSpecialization#1Type\endcsname{Specialization}
	\expandafter\newcommand\csname AddSpellcastingOneSpecialization#1\endcsname[2][Specialization]{
		\expandafter\renewcommand\csname CharSpellcastingOneSpecialization#1Type\endcsname{##1}
		\expandafter\renewcommand\csname CharSpellcastingOneSpecialization#1\endcsname{##2}
	}
	\expandafter\newcommand\csname CharSpellcastingTwoSpecialization#1\endcsname{}
	\expandafter\newcommand\csname CharSpellcastingTwoSpecialization#1Type\endcsname{Specialization}
	\expandafter\newcommand\csname AddSpellcastingTwoSpecialization#1\endcsname[2][Specialization]{
		\expandafter\renewcommand\csname CharSpellcastingTwoSpecialization#1Type\endcsname{##1}
		\expandafter\renewcommand\csname CharSpellcastingTwoSpecialization#1\endcsname{##2}
	}
}\docsvlist{One, Two}
\newcommand\AddSpellcastingOneSpecialization[2][Specialization]{
	\ifthenelse{\equal{\CharSpellcastingOneSpecializationOne}{}}{%
		\AddSpellcastingOneSpecializationOne[#1]{#2}%
	}{%
		\AddSpellcastingOneSpecializationTwo[#1]{#2}%
	}
}
\newcommand\AddSpellcastingTwoSpecialization[2][Specialization]{
	\ifthenelse{\equal{\CharSpellcastingTwoSpecializationOne}{}}{
		\AddSpellcastingTwoSpecializationOne[#1]{#2}
	}{
		\AddSpellcastingTwoSpecializationTwo[#1]{#2}
	}
}


\renewcommand{\do}[1]{
	\expandafter\newcommand\csname CharSpellcastingOneProhibition#1\endcsname{}
	\expandafter\newcommand\csname CharSpellcastingOneProhibition#1Type\endcsname{Prohibition}
	\expandafter\newcommand\csname AddSpellcastingOneProhibition#1\endcsname[2][Prohibition]{
		\expandafter\renewcommand\csname CharSpellcastingOneProhibition#1Type\endcsname{##1}
		\expandafter\renewcommand\csname CharSpellcastingOneProhibition#1\endcsname{##2}
	}
	\expandafter\newcommand\csname CharSpellcastingTwoProhibition#1\endcsname{}
	\expandafter\newcommand\csname CharSpellcastingTwoProhibition#1Type\endcsname{Prohibition}
	\expandafter\newcommand\csname AddSpellcastingTwoProhibition#1\endcsname[2][Prohibition]{
		\expandafter\renewcommand\csname CharSpellcastingTwoProhibition#1Type\endcsname{##1}
		\expandafter\renewcommand\csname CharSpellcastingTwoProhibition#1\endcsname{##2}
	}
}\docsvlist{One, Two, Three}
\newcommand\AddSpellcastingOneProhibition[2][Prohibition]{
	\ifthenelse{\equal{\CharSpellcastingOneProhibitionOne}{}}{\AddSpellcastingOneProhibitionOne[#1]{#2}}{
		\ifthenelse{\equal{\CharSpellcastingOneProhibitionTwo}{}}{\AddSpellcastingOneProhibitionTwo[#1]{#2}}{
			\AddSpellcastingOneProhibitionThree[#1]{#2}}}
}
\newcommand\AddSpellcastingTwoProhibition[2][Prohibition]{
	\ifthenelse{\equal{\CharSpellcastingTwoProhibitionOne}{}}{\AddSpellcastingTwoProhibitionOne[#1]{#2}}{
		\ifthenelse{\equal{\CharSpellcastingTwoProhibitionTwo}{}}{\AddSpellcastingTwoProhibitionTwo[#1]{#2}}{
			\AddSpellcastingTwoProhibitionThree[#1]{#2}}}
}

\newcommand{\AddSpellcastingSpecialization}[2][Specialization]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddSpellcastingOneSpecialization[#1]{#2}}{\AddSpellcastingTwoSpecialization[#1]{#2}}
}
\newcommand{\AddSpellcastingProhibition}[2][Prohibition]{
	\ifthenelse{\equal{\CharSpellcastingClassTwo}{}}{\AddSpellcastingOneProhibition[#1]{#2}}{\AddSpellcastingTwoProhibition[#1]{#2}}
}
%Spellcasting Notes
\renewcommand{\do}[1]{
	\expandafter\edef\csname CharSpellcasting#1NotesList\endcsname{}
	\expandafter\newcommand\csname AddSpellcasting#1Note\endcsname[1]{
		\expandafter\listadd\csname CharSpellcasting#1NotesList\endcsname{##1}
	}
}\docsvlist{One,Two}


%%%%Miscllany%%%%

%% Health Counter
\NewCounter{CharHPCount}
\NewCounter{CharTempHPCount}
\NewCounter{CharHPRollsCount}
\newcommand{\HProll}[1]{
	\AddToCounter{CharHPCount}{#1}
	\AddToCounter{CharHPRollsCount}{1}
}

%% Miscellaneous Bonus
\newcommand{\MiscBonus}[3][]{
	\ifthenelse{\equal{#1}{}}{
		\AddToCounter{Char#2MiscCount}{#3}
	}{
		\IfCounter{Char#2#1ModCount}{
			\ifthenelse{\value{Char#2#1ModCount} < #3}{
				\AddToCounter{Char#2MiscCount}{#3 - \value{Char#2#1ModCount}}
				\SetCounter{Char#2#1ModCount}{#3}
			}{}
		}{
			\NewCounter{Char#2#1ModCount}
			\SetCounter{Char#2#1ModCount}{#3}
			\AddToCounter{Char#2MiscCount}{#3}
		}
	}
}
\newcommand{\TmpBonus}[3][]{
	\ifthenelse{\equal{#1}{}}{
		\AddToCounter{Char#2TmpCount}{#3}
	}{
		\IfCounter{Char#2#1ModCount}{
			\ifthenelse{\value{Char#2#1ModCount} < #3}{
				\AddToCounter{Char#2TmpCount}{#3 - \value{Char#2#1ModCount}}
				\SetCounter{Char#2#1ModCount}{#3}
			}{}
		}{
			\NewCounter{Char#2#1ModCount}
			\SetCounter{Char#2#1ModCount}{#3}
			\AddToCounter{Char#2TmpCount}{#3}
		}
	}
}
\newcommand{\EnhancementBonus}[2]{
	\IfCounter{Char#1EnhancementCount}{
		\ifthenelse{\value{Char#1EnhancementCount} < #2}{
			\SetCounter{Char#1EnhancementCount}{#2}
		}{}
	}{
		\NewCounter{Char#1EnhancementCount}
		\SetCounter{Char#1EnhancementCount}{#2}
	}
}

%%Spell Resistance%%
\NewCounter{CharSpellResistanceCount}
\newcommand{\AddSpellResistance}[1]{
	\SetCounter{CharSpellResistanceCount}{\maxof{\value{CharSpellResistanceCount}}{#1}}
}

%%Initiative%%
\NewCounter{CharInitiativeMiscCount}

%%Conditional Modifiers
\edef\ConditionalSkillsModList{}
\edef\ConditionalAttackModList{}
\edef\ConditionalDefModList{}
\newcommand{\AddConditionalSkillMod}[1]{
	\listadd\ConditionalSkillsModList{#1}}
\newcommand{\AddConditionalAttackMod}[1]{
	\listadd\ConditionalAttackModList{#1}}
\newcommand{\AddConditionalDefMod}[1]{
	\listadd\ConditionalDefModList{#1}}

%% Languages
\edef\CharLanguagesList{}
\newcommand{\AddCharLanguage}[1]{
	\listinsert{\CharLanguagesList}{#1}
}

%% XP
\NewCounter{CharXPCount}
\NewCounter{CharNextLevelXPCount}
\NewCounter{XP-Mode}
\newcommand{\CalculateNextLevelXP}{
	\ifthenelse{\value{XP-Mode} = 0}{}{
		\ifthenelse{\value{XP-Mode} = 1}{
			\SetCounter{CharNextLevelXPCount}{0}
			\ifthenelse{\value{CharTotalLevelCount} > 0}{
				\AddToCounter{CharNextLevelXPCount}{1300}
			\ifthenelse{\value{CharTotalLevelCount} > 1}{
				\AddToCounter{CharNextLevelXPCount}{2000}
			\ifthenelse{\value{CharTotalLevelCount} > 2}{
				\AddToCounter{CharNextLevelXPCount}{2700}
			\ifthenelse{\value{CharTotalLevelCount} > 3}{
				\AddToCounter{CharNextLevelXPCount}{4000}
			\ifthenelse{\value{CharTotalLevelCount} > 4}{
				\AddToCounter{CharNextLevelXPCount}{5000}
			\ifthenelse{\value{CharTotalLevelCount} > 5}{
				\AddToCounter{CharNextLevelXPCount}{8000}
			\ifthenelse{\value{CharTotalLevelCount} > 6}{
				\AddToCounter{CharNextLevelXPCount}{11000}
			\ifthenelse{\value{CharTotalLevelCount} > 7}{
				\AddToCounter{CharNextLevelXPCount}{16000}
			\ifthenelse{\value{CharTotalLevelCount} > 8}{
				\AddToCounter{CharNextLevelXPCount}{21000}
			\ifthenelse{\value{CharTotalLevelCount} > 9}{
				\AddToCounter{CharNextLevelXPCount}{34000}
			\ifthenelse{\value{CharTotalLevelCount} > 10}{
				\AddToCounter{CharNextLevelXPCount}{40000}
			\ifthenelse{\value{CharTotalLevelCount} > 11}{
				\AddToCounter{CharNextLevelXPCount}{65000}
			\ifthenelse{\value{CharTotalLevelCount} > 12}{
				\AddToCounter{CharNextLevelXPCount}{85000}
			\ifthenelse{\value{CharTotalLevelCount} > 13}{
				\AddToCounter{CharNextLevelXPCount}{130000}
			\ifthenelse{\value{CharTotalLevelCount} > 14}{
				\AddToCounter{CharNextLevelXPCount}{175000}
			\ifthenelse{\value{CharTotalLevelCount} > 15}{
				\AddToCounter{CharNextLevelXPCount}{250000}
			\ifthenelse{\value{CharTotalLevelCount} > 16}{
				\AddToCounter{CharNextLevelXPCount}{350000}
			\ifthenelse{\value{CharTotalLevelCount} > 17}{
				\AddToCounter{CharNextLevelXPCount}{500000}
			\ifthenelse{\value{CharTotalLevelCount} > 0}{
				\AddToCounter{CharNextLevelXPCount}{700000}
			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
		}{
		\ifthenelse{\value{XP-Mode} = 2}{
			\ifthenelse{\value{CharTotalLevelCount} > 0}{
				\AddToCounter{CharNextLevelXPCount}{2000}
			\ifthenelse{\value{CharTotalLevelCount} > 1}{
				\AddToCounter{CharNextLevelXPCount}{3000}
			\ifthenelse{\value{CharTotalLevelCount} > 2}{
				\AddToCounter{CharNextLevelXPCount}{4000}
			\ifthenelse{\value{CharTotalLevelCount} > 3}{
				\AddToCounter{CharNextLevelXPCount}{6000}
			\ifthenelse{\value{CharTotalLevelCount} > 4}{
				\AddToCounter{CharNextLevelXPCount}{8000}
			\ifthenelse{\value{CharTotalLevelCount} > 5}{
				\AddToCounter{CharNextLevelXPCount}{12000}
			\ifthenelse{\value{CharTotalLevelCount} > 6}{
				\AddToCounter{CharNextLevelXPCount}{16000}
			\ifthenelse{\value{CharTotalLevelCount} > 7}{
				\AddToCounter{CharNextLevelXPCount}{24000}
			\ifthenelse{\value{CharTotalLevelCount} > 8}{
				\AddToCounter{CharNextLevelXPCount}{30000}
			\ifthenelse{\value{CharTotalLevelCount} > 9}{
				\AddToCounter{CharNextLevelXPCount}{50000}
			\ifthenelse{\value{CharTotalLevelCount} > 10}{
				\AddToCounter{CharNextLevelXPCount}{65000}
			\ifthenelse{\value{CharTotalLevelCount} > 11}{
				\AddToCounter{CharNextLevelXPCount}{95000}
			\ifthenelse{\value{CharTotalLevelCount} > 12}{
				\AddToCounter{CharNextLevelXPCount}{130000}
			\ifthenelse{\value{CharTotalLevelCount} > 13}{
				\AddToCounter{CharNextLevelXPCount}{190000}
			\ifthenelse{\value{CharTotalLevelCount} > 14}{
				\AddToCounter{CharNextLevelXPCount}{255000}
			\ifthenelse{\value{CharTotalLevelCount} > 15}{
				\AddToCounter{CharNextLevelXPCount}{410000}
			\ifthenelse{\value{CharTotalLevelCount} > 16}{
				\AddToCounter{CharNextLevelXPCount}{500000}
			\ifthenelse{\value{CharTotalLevelCount} > 17}{
				\AddToCounter{CharNextLevelXPCount}{750000}
			\ifthenelse{\value{CharTotalLevelCount} > 0}{
				\AddToCounter{CharNextLevelXPCount}{1050000}
			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
		}{
		\ifthenelse{\value{XP-Mode} = 3}{
			\ifthenelse{\value{CharTotalLevelCount} > 0}{
				\AddToCounter{CharNextLevelXPCount}{3000}
			\ifthenelse{\value{CharTotalLevelCount} > 1}{
				\AddToCounter{CharNextLevelXPCount}{4500}
			\ifthenelse{\value{CharTotalLevelCount} > 2}{
				\AddToCounter{CharNextLevelXPCount}{6500}
			\ifthenelse{\value{CharTotalLevelCount} > 3}{
				\AddToCounter{CharNextLevelXPCount}{9000}
			\ifthenelse{\value{CharTotalLevelCount} > 4}{
				\AddToCounter{CharNextLevelXPCount}{11000}
			\ifthenelse{\value{CharTotalLevelCount} > 5}{
				\AddToCounter{CharNextLevelXPCount}{18000}
			\ifthenelse{\value{CharTotalLevelCount} > 6}{
				\AddToCounter{CharNextLevelXPCount}{24000}
			\ifthenelse{\value{CharTotalLevelCount} > 7}{
				\AddToCounter{CharNextLevelXPCount}{38000}
			\ifthenelse{\value{CharTotalLevelCount} > 8}{
				\AddToCounter{CharNextLevelXPCount}{45000}
			\ifthenelse{\value{CharTotalLevelCount} > 9}{
				\AddToCounter{CharNextLevelXPCount}{75000}
			\ifthenelse{\value{CharTotalLevelCount} > 10}{
				\AddToCounter{CharNextLevelXPCount}{95000}
			\ifthenelse{\value{CharTotalLevelCount} > 11}{
				\AddToCounter{CharNextLevelXPCount}{145000}
			\ifthenelse{\value{CharTotalLevelCount} > 12}{
				\AddToCounter{CharNextLevelXPCount}{190000}
			\ifthenelse{\value{CharTotalLevelCount} > 13}{
				\AddToCounter{CharNextLevelXPCount}{290000}
			\ifthenelse{\value{CharTotalLevelCount} > 14}{
				\AddToCounter{CharNextLevelXPCount}{395000}
			\ifthenelse{\value{CharTotalLevelCount} > 15}{
				\AddToCounter{CharNextLevelXPCount}{550000}
			\ifthenelse{\value{CharTotalLevelCount} > 16}{
				\AddToCounter{CharNextLevelXPCount}{800000}
			\ifthenelse{\value{CharTotalLevelCount} > 17}{
				\AddToCounter{CharNextLevelXPCount}{1150000}
			\ifthenelse{\value{CharTotalLevelCount} > 0}{
				\AddToCounter{CharNextLevelXPCount}{1500000}
			}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}}{}
		}}}
	}
}


%%%%Initialization%%%%
\newcommand{\Initialize}{
	\CalculateNextLevelXP
	\ComputeAbilityScores
	% Size bonus to Stealth
	\MiscBonus{Stealth}{\value{CharSizeModCount} * 4}
	% Add Con to HP
	\ifthenelse{\value{HP-Mode} > 0}{\AddToCounter{CharHPCount}{\value{CharConModCount} * \value{CharTotalLevelCount}}}{}
	% Add feats from levels
	\AddToCounter{CharFeatsCount}{(\value{CharTotalLevelCount} + 1) / 2}
	% Add INT to Skill Ranks
	\AddIntToSkillRanks
	\SetCounter{CharIteratedAttacksCount}{(\value{CharBABCount}-1)/5+1}
	\InitializeSpellSlots
	\CalculateLoads
	\CalculateWeights
	\CheckEncumberance
	\SpeedInitialize
	\SetCounter{CharDextoACCount}{\minof{\value{CharDexModCount}}{\value{CharMaxDexBonusCount}}}
	\RunChecks
}

%%Pathfinder System Checks
\newcommand{\RunChecks}{
	\AddDebug{Running checks}
	\AddDebug{Checking HP Rolls}
	%CHECK HP ROLLS
	\ifthenelse{\value{HP-Mode} = 1}{ %Only run if we are in rolls Mode for HP
		\AddDebug{HP Mode == 1. Checking that the number of HP rolls is correct:\\
				  Number of HP rolls: \arabic{CharHPRollsCount}\\
				  Level: \arabic{CharTotalLevelCount}}
		\ifthenelse{\arabic{CharHPRollsCount} < \arabic{CharTotalLevelCount}}{
			\AddDebug{Num HP rolls less than expected}
			\AddWarning{\DoMath{\value{CharTotalLevelCount} - \value{CharHPRollsCount}} HP rolls missing}
		}{
			\ifthenelse{\arabic{CharHPRollsCount} > \arabic{CharTotalLevelCount}}{
				\AddDebug{Num HP rolls more than expected}
				\AddWarning{\DoMath{\value{CharHPRollsCount} - \value{CharTotalLevelCount}} Extra HP rolls}
			}{\AddDebug{Num HP rolls is correct}}
		}
	}{\AddDebug{HP Mode != 1. No need to check HP rolls}}
	%CHECK SKILL RANKS
	\ifthenelse{\value{AutoSkillRanks-Mode} = 1}{
		\AddDebug{Checking Skill Ranks}
		\ifthenelse{\value{CharSpareSkillRanksCount} > 0}{
			\AddWarning{Character has \arabic{CharSpareSkillRanksCount} Skill Ranks left to spend}
		}{\ifthenelse{\value{CharSpareSkillRanksCount} < 0}{
			\AddWarning{Character has spent \DoMath{-\value{CharSpareSkillRanksCount}} too many Skill Ranks}
		}{}}
	}{}
	%CHECK FEATS
	\ifthenelse{\value{CountFeats-Mode} = 1}{
		\AddDebug{Checking Feats}
		\ifthenelse{\value{CharBonusFeatsCount} < 0}{
			\AddWarning{\DoMath{-\value{CharBonusFeatsCount}} too many Bonus Feats selected}
		}{
		\ifthenelse{\value{CharBonusFeatsCount} > 0}{
			\AddWarning{\arabic{CharBonusFeatsCount} Bonus Feats left to select}
		}{}}
		\ifthenelse{\value{CharFeatsCount} < 0}{
			\AddWarning{\DoMath{-\value{CharFeatsCount}} too many Feats selected}
		}{
		\ifthenelse{\value{CharFeatsCount} > 0}{
			\AddWarning{\arabic{CharFeatsCount} Feats left to select}
		}{}}
	}{}
	%CHECK FAVORED CLASS LEVELS
	\ifthenelse{\value{CheckFavoredClass-Mode} = 1}{
		\AddDebug{Checking Favored Class Levels}
		\ifthenelse{\value{CharSpareFavoredClassLevelsCount} < 0}{
			\AddWarning{\DoMath{-\value{CharSpareFavoredClassLevelsCount}} too many favored class bonuses assigned}
		}{
		\ifthenelse{\value{CharSpareFavoredClassLevelsCount} > 0}{
			\AddWarning{\arabic{CharSpareFavoredClassLevelsCount} favored class bonuses left to assign}
		}{}}
	}{}
}
