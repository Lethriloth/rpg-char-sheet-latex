\documentclass{rpgcharsheet2}
\usepackage{longtable}
\usepackage{multicol}
\begin{document}
\input{player.tex}
\unitlength\textwidth
\divide\unitlength 432
\initialize

\centering\begin{picture}(420,558)

  % \put(0,0){\framebox(420,594)}

  \put(135,510){\renewcommand{\arraystretch}{1.5}
    \begin{tabular}[b]{D{46} D{23}  D{23}  D{23}  D{23}  D{23}  D{23}  D{23} }
      \multicolumn{3}{D{69}}{\charname} & \charalignment & \multicolumn{4}{D{92}}{\charplayername} \\\cmidrule(rl){1-3}\cmidrule(rl){4-4}\cmidrule(rl){5-8}
      \multicolumn{4}{D{92}}{\charlevel} &\multicolumn{2}{D{46}}{\chardiety} & \multicolumn{2}{D{46}}{\charhomeland} \\\cmidrule(rl){1-4}\cmidrule(rl){5-6}\cmidrule(rl){7-8}
      \charrace & \charsize & \chargender & \charage & \charheight & \charweight & \charhair & \chareyes \\\cmidrule(rl){1-1}\cmidrule(rl){2-2}\cmidrule(rl){3-3}\cmidrule(rl){4-4}\cmidrule(rl){5-5}\cmidrule(rl){6-6}\cmidrule(rl){7-7}\cmidrule(rl){8-8}
    \end{tabular}}
  \put(135,509){\renewcommand{\arraystretch}{1.9}
    \begin{tabular}[b]{D{46} D{23}  D{23}  D{23}  D{23}  D{23}  D{23}  D{23} }
      \multicolumn{3}{D{69}}{\lfont character name} & \lfont alignment & \multicolumn{4}{D{92}}{\lfont player name} \\
      \multicolumn{4}{D{92}}{\lfont character level} &\multicolumn{2}{D{46}}{\lfont deity} & \multicolumn{2}{D{46}}{\lfont homeland} \\
      \lfont race & \lfont size & \lfont gender & \lfont age & \lfont height & \lfont weight & \lfont hair & \lfont eyes \\
    \end{tabular}}

{ % % Ability Scores
  %% Labels
  \put(0,552){\makebox(28,3){\tiny\scshape attribute}}
  \stretchlabels{30}{552}{137}{Ability Score,  Ability Modifier, Base\\ Score, Enhancement Bonus, Misc.\\ Bonus, Temp.\\ Bonus}
  %% Line
  {\linethickness{1.3pt}
  \put(64.5,478){\line(0,1){77}}}
  %% STR
  \titlebox{0}{540}{28}{STR}{strength}
\stretchattributes{30}{540}{137}{\arabic{charstrcount},\plusminus{charstrmodcount},\arabic{charstrbasecount},\plusminus{charstrenhcount},\plusminus{charstrmisccount},\plusminus{charstrtmpcount}}

  %% DEX
  \titlebox{0}{528}{28}{DEX}{dexterity}
  \stretchattributes{30}{528}{137}{\arabic{chardexcount},\plusminus{chardexmodcount},\arabic{chardexbasecount},\plusminus{chardexenhcount},\plusminus{chardexmisccount},\plusminus{chardextmpcount}}
  
  %% CON
  \titlebox{0}{516}{28}{CON}{constitution}
  \stretchattributes{30}{516}{137}{\arabic{charconcount},\plusminus{charconmodcount},\arabic{charconbasecount},\plusminus{charconenhcount},\plusminus{charconmisccount},\plusminus{charcontmpcount}}
  
  %% INT
  \titlebox{0}{504}{28}{INT}{intelligence}
  \stretchattributes{30}{504}{137}{\arabic{charintcount},\plusminus{charintmodcount},\arabic{charintbasecount},\plusminus{charintenhcount},\plusminus{charintmisccount},\plusminus{charinttmpcount}}

  %% WIS
  \titlebox{0}{492}{28}{WIS}{wisdom}
  \stretchattributes{30}{492}{137}{\arabic{charwiscount},\plusminus{charwismodcount},\arabic{charwisbasecount},\plusminus{charwisenhcount},\plusminus{charwismisccount},\plusminus{charwistmpcount}}

  %% CHA
  \titlebox{0}{480}{28}{CHA}{charisma}
  \stretchattributes{30}{480}{137}{\arabic{charchacount},\plusminus{charchamodcount},\arabic{charchabasecount},\plusminus{charchaenhcount},\plusminus{charchamisccount},\plusminus{charchatmpcount}}}

{  %% HP
  \titlebox{0}{465}{35}{HP}{Hit Points}
  % \put(107,505){\framebox(26,12){}}
  % \put(107,508){\makebox(26,9){HP}}
  % \put(107,506){\makebox(26,3){\tiny\scshape hit points}}
  \put(38,463){\framebox(45,12){}}
  \put(38,470){\makebox(14,4){\tiny\scshape Total}}
  \put(38,461){\parbox[b][12\unitlength][c]{43\unitlength}{\raggedleft \arabic{charhpcount}}}}

{  %% little HP boxes
  \put(1,459){\makebox(36,4){\tiny\scshape wounds/current hp}}
  \put(0,439){\framebox(83,20){}}
  \put(1,434){\makebox(36,4){\tiny\scshape nonleathal damage}}
  \put(0,416){\framebox(83,18){}}}

{  %% SR, DR, and resistances
%  \titlebox{140}{501}{40}{SR}{Spell Resistance}
%  \put(182,500){\framebox(23,11){0}}
  \titlebox{85}{466}{40}{DR}{Damage Reduction}
  \put(127,465){\framebox(78,11){}}
  \put(129,465){\parbox[b][10\unitlength][c]{74\unitlength}{\scriptsize\printdamagereduction}}
  \singletitlebox{85}{449}{52}{11}{Resistances}
  \put(139,450){\framebox(66,11){}}
  \put(141,450){\parbox[b][10\unitlength][c]{62\unitlength}{\scriptsize\printresistances}}
  \singletitlebox{85}{435}{52}{11}{Immunities}
  \put(139,435){\framebox(66,11){}}
  \put(141,435){\parbox[b][10\unitlength][c]{62\unitlength}{\scriptsize\printlist{\charimmunitylist}}}
  \singletitlebox{85}{418}{80}{11}{Spell Resistance}
  \put(166,419){\framebox(39,11){\cleanarabic{charspellresistancecount}}}
}
 
{  %% AC
  \titlebox{0}{401}{27}{AC}{armour class}
  \equalattributes{25}{401}{10,\arabic{chararmorbonuscount},\arabic{charshieldbonuscount},\arabic{chardextoACcount},\arabic{chardodgemodcount},\arabic{charsizemodcount},\arabic{charnaturalarmormodcount},\arabic{chardeflectionmodcount},\arabic{charACmiscmodcount}}{18}
  \scaleattributelabels{25}{407}{TOTAL,default,armor,shield,dex,dodge,size,natural,deflection,misc }{18}
  %% Touch, Flat footed
  \titlebox{0}{389}{27}{TOUCH}{armour class}
  \equalattributes{25}{389}{10,,,\arabic{chardextoACcount},\arabic{chardodgemodcount},\arabic{charsizemodcount},,\arabic{chardeflectionmodcount},\arabic{chartouchmiscmodcount}}{18}
  \titlebox{0}{377}{27}{FF}{Flat-Footed}
  \equalattributes{25}{377}{10,\arabic{chararmorbonuscount},\arabic{charshieldbonuscount},,,\arabic{charsizemodcount},\arabic{charnaturalarmormodcount},\arabic{chardeflectionmodcount},\arabic{charflatfootedmiscmodcount}}{18}}

{  %% fort, reflex and will
  \stretchlabels{50}{369}{160}{TOTAL, base, ability, resistance, misc,temp}
  \titlebox{0}{360}{48}{fortitude}{(constitution)}
  \stretchequalattributes{50}{360}{160}{\arabic{charfortitudecount},\arabic{charconmodcount},\arabic{charresistancemodcount},\arabic{charfortitudemisccount},\arabic{charfortitudetmpcount}}
  \titlebox{0}{345}{48}{reflex}{(dexterity)}
  \stretchequalattributes{50}{345}{160}{\arabic{charreflexcount},\arabic{chardexmodcount},\arabic{charresistancemodcount},\arabic{charreflexmisccount},\arabic{charreflextmpcount}}
  \titlebox{0}{330}{48}{will}{(wisdom)}  
  \stretchequalattributes{50}{330}{160}{\arabic{charwillcount},\arabic{charwismodcount},\arabic{charresistancemodcount},\arabic{charwillmisccount},\arabic{charwilltmpcount}}}
  
{  %% Defensive Conditional Modifiers
  \put(165,330){\framebox(40,39){}}
  \put(165,360){\parbox[b][8\unitlength][t]{38\unitlength}{\raggedleft \lfont Conditional Modifiers}}
  \put(166,335){\parbox[b][30\unitlength][t]{38\unitlength}{\scriptsize \printlist{\conditionaldefmodlist}}}}

{  %%Base attack bonus CMD/CMB
	\setcounter{charCMDbasecount}{\value{charbabcount}+10}
  \singletitlebox{165}{313}{23}{11}{BAB}
  \attributes{190}{314}{\arabic{charbabcount}}
  \scaleattributelabels{53}{318}{TOTAL,BAB+\\Base,Ability,Size,Misc,Temp}{18}
  \titlebox{0}{310}{55}{Melee}{Attack Modifier}
  \equalattributes{53}{310}{\arabic{charbabcount},\arabic{charstrmodcount},\arabic{charsizemodcount},\arabic{charmeleemiscmodcount},\arabic{charmeleetmpmodcount}}{18}
  \titlebox{0}{297}{55}{Ranged}{Attack Modifier}
  \equalattributes{53}{297}{\arabic{charbabcount},\arabic{chardexmodcount},\arabic{charsizemodcount},\arabic{charrangedmiscmodcount},\arabic{charrangedtmpmodcount}}{18}
  \titlebox{0}{284}{55}{CMB}{Combat Maneuver Bonus}
  \equalattributes{53}{284}{\arabic{charbabcount},\arabic{charstrmodcount},\arabic{charspecialsizemodcount},\arabic{charCMBmiscmodcount},\arabic{charCMBtmpmodcount}}{18}
  \titlebox{0}{271}{55}{CMD}{Combat Maneuver Defense}
  \equalattributes{53}{271}{\arabic{charCMDbasecount},\arabic{charcmdabilitymodcount},\arabic{charspecialsizemodcount},\arabic{charCMDmiscmodcount},\arabic{charCMDtmpmodcount}}{18}}

{  %% Offensive Conditional Modifiers
  \put(165,271){\framebox(40,39){}}
  \put(165,301){\parbox[b][8\unitlength][t]{38\unitlength}{\raggedleft \lfont Conditional Modifiers}}
  \put(166,276){\parbox[b][30\unitlength][t]{38\unitlength}{\scriptsize \printlist{\conditionalattackmodlist}}}}

{  %% INIT
  \titlebox{0}{257}{55}{INITIATIVE}{modifier}
  \stretchequalattributes{0}{245}{55}{\arabic{chardexmodcount},\arabic{charinitiativemisccount}}
  \stretchlabels{0}{241}{55}{TOTAL, dex, misc}}

{  %% Speed
  \singletitlebox{63}{243}{25}{24}{speed}
  \put(92,257){\framebox(35,\boxheight){}}
  \put(92,258){\begin{tabular}[b]{F{15}E{2}F{12}E{0}}\arabic{charbasespeedcount} &ft. & \arabic{charbasespeedsqcount}& sq.\end{tabular}}
  \put(92,254){\parbox[b][3\unitlength][b]{32\unitlength}{\centering\lfont base speed}}
  \put(92,243){\framebox(35,\boxheight){}}
  \put(92,244){\begin{tabular}[b]{F{15}E{2}F{12}E{0}}0 &ft. & 0& sq.\end{tabular}}
  \put(92,240){\parbox[b][3\unitlength][b]{32\unitlength}{\centering\lfont with armour}}
  \put(131,257){\framebox(35,\boxheight){}}
  \put(131,258){\begin{tabular}[b]{F{15}E{2}F{12}E{0}}\arabic{charflyspeedcount} &ft. & \arabic{charflyspeedsqcount}& sq.\end{tabular}}
  \put(131,254){\parbox[b][3\unitlength][b]{32\unitlength}{\lfont\centering fly}}
  \put(131,243){\framebox(35,\boxheight){}}
  \put(131,244){\begin{tabular}[b]{F{15}E{2}F{12}E{0}}\arabic{charswimspeedcount} &ft. & \arabic{charswimspeedsqcount}& sq.\end{tabular}}
  \put(131,240){\parbox[b][3\unitlength][b]{32\unitlength}{\centering\lfont swim}}
  \put(170,257){\framebox(35,\boxheight){}}
  \put(170,258){\begin{tabular}[b]{F{15}E{2}F{12}E{0}}\arabic{charclimbspeedcount} &ft. & \arabic{charclimbspeedsqcount}& sq.\end{tabular}}
  \put(170,254){\parbox[b][3\unitlength][b]{32\unitlength}{\centering\lfont climb}}
  \put(170,243){\framebox(35,\boxheight){}}
  \put(170,244){\begin{tabular}[b]{F{15}E{2}F{12}E{0}}\arabic{charburrowspeedcount} &ft. & \arabic{charburrowspeedsqcount}& sq.\end{tabular}}
  \put(170,240){\parbox[b][3\unitlength][b]{32\unitlength}{\centering\lfont burrow}}}
  
  \weapononetable
  \weapontwotable
  \weaponthreetable
  {\linethickness{1.3pt}
    \put(0,95){\line(1,0){205}}}
  \armor{0}{50}
  \shield{0}{0}

 %skills
  \put(216,130){
  \begin{tabular}[b]{A{10}B{78}A{14}B{20}A{14}A{6}A{14}A{6}A{14}A{6}A{14}}
  &\footnotesize \scshape Skill Names   &\lfont Total Bonus& &\lfont Ability Mod. &  &\lfont Ranks & & \lfont Trained&  &\lfont Misc.\ Mod.\ \tabularnewline\hline
  \skill{acrobatics}{Acrobatics}{dex}
  \skill{appraise}{Appraise}{int}
  \skill{bluff}{Bluff}{cha}
  \skill{climb}{Climb}{str}
  \skill{craftone}{Craft (\charcraftonename)}{int}
  \skill{crafttwo}{Craft (\charcrafttwoname)}{int}
  \skill{craftthree}{Craft (\charcraftthreename)}{int}
  \skill{diplomacy}{Diplomacy}{cha}
  \trainskill{disabledevice}{Disable Device}{dex}
  \skill{disguise}{Disguise}{cha}
  \skill{escapeartist}{Escape Artist}{dex}
  \skill{fly}{Fly}{dex}
  \trainskill{handleanimal}{Handle Animal}{cha}
  \skill{heal}{Heal}{wis}
  \skill{intimidate}{Intimidate}{cha}
  \trainskill{knowledgearcana}{Know (arcana)}{int}
  \trainskill{knowledgedungeoneering}{Know (dungeoneering)}{int}
  \trainskill{knowledgeengineering}{Know (engineering)}{int}
  \trainskill{knowledgegeography}{Know (geography)}{int}
  \trainskill{knowledgehistory}{Know (history)}{int}
  \trainskill{knowledgelocal}{Know (local)}{int}
  \trainskill{knowledgenature}{Know (nature)}{int}
  \trainskill{knowledgenobility}{Know (nobility)}{int}
  \trainskill{knowledgeplanes}{Know (planes)}{int}
  \trainskill{knowledgereligion}{Know (religion)}{int}
  \trainskill{linguistics}{Linguistics}{int}
  \skill{perception}{Perception}{wis}
  \skill{performone}{Perform (\charperformonename)}{cha}
  \skill{performtwo}{Perform (\charperformtwoname)}{cha}
  \trainskill{professionone}{Prof (\charprofessiononename)}{wis}
  \trainskill{professiontwo}{Prof (\charprofessiontwoname)}{wis}
  \skill{ride}{Ride}{dex}
  \skill{sensemotive}{Sense Motive}{wis}
  \trainskill{sleightofhand}{Sleight of Hand}{dex}
  \trainskill{spellcraft}{Spellcraft}{int}
  \skill{stealth}{Stealth}{dex}
  \skill{survival}{Survival}{wis}
  \skill{swim}{Swim}{str}
  \trainskill{usemagicdevice}{Use Magic Device}{cha}
  \end{tabular}}
{ %skills trailer
  \put(220.5,122){\parbox[b][10\unitlength][c]{150\unitlength}{ \tiny\scshape $\footnotesize\cancel\square$  Class Skill\hspace{2ex} $\dagger$ Armor Check Penalty applies\hspace{2ex}* trained only}}

  \put(215,114){\parbox[b][10\unitlength][c]{200\unitlength}{\small\scshape Conditional Modifiers:}}
  \put(215,59){\parbox[b][53\unitlength][t]{200\unitlength}{\printlist{\conditionalskillsmodlist}}}
  \put(211,59){\framebox(207,55){}}
  \put(215,49){\parbox[b][10\unitlength][c]{199\unitlength}{\small\scshape Languages Spoken:}}
  \put(215,0){\parbox[b][42\unitlength][t]{199\unitlength}{\itshape \printlanguages }}
  \put(211,0){\framebox(207,49){}}}

\end{picture}

\newpage

\centering\begin{picture}(420,558)
	
	\renewcommand\do[1]{
	#1 \tabularnewline\hline
	}	
	 \singletitlebox{255}{552}{165}{10}{Limited Use Abilities and Equipment}
	  \put(255,546){\begin{tabular}[t]{@{}p{117\unitlength}@{\hspace{2\unitlength}}>{\centering}p{22\unitlength}@{\hspace{1\unitlength}}|@{\hspace{1\unitlength}}>{\centering}p{22\unitlength}@{}}
	  \vspace{\fill}\small\scshape Ability or Item & \small\scshape Uses\\(/Day) & \small\scshape \vspace{\fill}Used \tabularnewline\hline
	  \dolistloop{\charlimiteduselist}
  	 \end{tabular}}

		\renewcommand\do[1]{%
		#1 \tabularnewline
		}	

	 \singletitlebox{0}{552}{120}{10}{Class and Race Features}
	  \put(0,546){\begin{tabular}[t]{@{}>{\small\itshape}p{120\unitlength}@{}}
	  \dolistloop{\charracefeatureslist}\hline
  	  \dolistloop{\charclassfeatureslist}
	  \end{tabular}}
	 \singletitlebox{125}{552}{120}{10}{Feats}
	  \put(125,546){\begin{tabular}[t]{@{}>{\itshape}p{120\unitlength}@{}}
  	  \dolistloop{\charfeatslist}
  	  \end{tabular}}

	
  \singletitlebox{0}{231}{205}{10}{Carried Items}
  \put(0,225){\begin{tabular}[t]{@{}p{175\unitlength} @{\hspace{1\unitlength}}>{\raggedleft}p{29\unitlength}@{}}
  \scshape\scriptsize item& \centering\scshape\scriptsize wt.\tabularnewline\hline
  \dolistloop{\gearlist}\end{tabular}}
  \put(0,66){\begin{tabular}[t]{@{}p{175\unitlength} @{\hspace{1\unitlength}}>{\raggedleft}p{29\unitlength}@{}}
  \textsc{Total} & \printweight{\totalgearweight}~lbs. \tabularnewline\hline
  \end{tabular}}
    
  \singletitlebox{215}{231}{205}{10}{Items Not Carried}
  \put(215,225){\begin{tabular}[t]{@{}p{175\unitlength} @{\hspace{1\unitlength}}>{\raggedleft}p{29\unitlength}@{}}
  \scshape\scriptsize item& \centering\scshape\scriptsize wt.\tabularnewline\hline
   \dolistloop{\storeditemslist}\end{tabular}}
  \put(215,66){\begin{tabular}[t]{@{}p{175\unitlength} @{\hspace{1\unitlength}}>{\raggedleft}p{29\unitlength}@{}}
  \textsc{Total} & \printweight{\totalstoredweight}~lbs. \tabularnewline\hline
  \end{tabular}}
	
	\renewcommand{\do}[1]{
  	\scshape\ifthenelse{\equal{#1}{ringone}\or\equal{#1}{ringtwo}}{ring}{#1} & {\csname iteminslot#1isname\endcsname}\ifthenelse{\not\equal{\csname iteminslot#1description\endcsname}{}}{:}{} \csname iteminslot#1description\endcsname & \ifthenelse{\equal{\csname iteminslot#1isname\endcsname}{}}{}{\printweight{\csname iteminslot#1weight\endcsname} lbs.}\tabularnewline
  	}
  \singletitlebox{0}{380}{420}{12}{Worn Items}
  \put(0,376){
  \begin{tabular}[t]{@{}>{\raggedleft}p{40\unitlength}@{\hspace{3\unitlength}}p{344\unitlength}@{\hspace{1\unitlength}}>{\raggedleft}p{30\unitlength}@{}}
	\small\scshape slot &\centering \small\scshape item & \centering\small \scshape wt.\tabularnewline\hline
	\dolistloop{\itemslotnames}\hline
  \end{tabular}
  }

  
  \singletitlebox{0}{52.5}{121.5}{9}{Money}
  \put(0,0){\begin{tabular}[b]{@{}|@{}>{\centering\scriptsize\scshape}p{30\unitlength}@{}|@{}>{\centering\scriptsize}p{30\unitlength}@{}|@{}>{\centering\scriptsize}p{30\unitlength}@{}|@{}>{\centering\scriptsize}p{30\unitlength}@{}|@{}}
& \scshape\tiny Carried & \scshape\tiny Carried (Weightless) & \tiny\scshape Stored\tabularnewline
Platinum &\cleanarabic{charplatinumcount} &\cleanarabic{charplatinumweightlesscount} & \cleanarabic{charplatinumstoredcount}\tabularnewline\hline
Gold &\cleanarabic{chargoldcount} &\cleanarabic{chargoldweightlesscount} & \cleanarabic{chargoldstoredcount}\tabularnewline\hline
Silver &\cleanarabic{charsilvercount} &\cleanarabic{charsilverweightlesscount} & \cleanarabic{charsilverstoredcount}\tabularnewline\hline
Copper &\cleanarabic{charcoppercount} &\cleanarabic{charcopperweightlesscount} & \cleanarabic{charcopperstoredcount}\tabularnewline\hline
  \end{tabular}}
  
{  \singletitlebox{125}{20}{130}{10}{Carried Weight}
  \scaleattributelabels{117}{10}{Worn\\Items,Gear,Currency}{30}
  \put(215,14){\parbox{40\unitlength}{\scriptsize\centering\scshape Total}}
  \put(126,0){\framebox(28,10){\small\printweight{\wornitemsweight} lbs.}}
  \put(156,0){\framebox(28,10){\small\printweight{\totalgearweight} lbs.}}
  \put(186,0){\framebox(28,10){\small\printweight{\currencyweight} lbs.}}
  \put(216,0){\framebox(38,12){\printweight{\totalcarriedweight} lbs.}}}
  
  \singletitlebox{260}{42}{158}{10}{Carrying Capacity}
  \scaleattributelabels{255}{34}{light\\load,medium\\load,heavy\\load,lift above\\head,lift off\\ground,drag \&\\push}{26}
  \put(262,27){\framebox(24,8){\footnotesize\cleanarabic{charlightloadcount} lbs.}}
  \put(288,27){\framebox(24,8){\footnotesize\cleanarabic{charmediumloadcount} lbs.}}
  \put(314,27){\framebox(24,8){\footnotesize\cleanarabic{charheavyloadcount} lbs.}}
  \put(340,27){\framebox(24,8){\footnotesize\cleanarabic{charheavyloadcount} lbs.}}
  \put(366,27){\framebox(24,8){\footnotesize\cleanarabic{charliftloadcount} lbs.}}
  \put(392,27){\framebox(24,8){\footnotesize\cleanarabic{chardragloadcount} lbs.}}
  
  \put(262,18){\parbox[t]{38\unitlength}{\scshape\scriptsize Current Load}}
  \put(308,18){\begin{tabular}{@{}>{\centering\scshape\scriptsize}p{28\unitlength}@{}>{\centering\scshape\scriptsize}p{28\unitlength}@{}>{\centering\scshape\scriptsize}p{28\unitlength}@{}>{\scshape\scriptsize\centering}p{28\unitlength}@{}}
  light& medium&heavy&overload\tabularnewline[-5pt]
  \encumberancebox{1}&\encumberancebox{2}&\encumberancebox{3}&\encumberancebox{4}
  \end{tabular}}
  \put(262,5){\parbox[t]{38\unitlength}{\scshape\scriptsize Consequences}}
  \put(306,0){\begin{tabular}[b]{@{}>{\footnotesize\centering}p{20\unitlength}@{}p{26\unitlength}@{}>{\footnotesize\centering}p{20\unitlength}@{}p{26\unitlength}@{}>{\footnotesize\centering}p{20\unitlength}@{}}
  \ifthenelse{\value{charencumberedmaxdexcount}>5}{}{\arabic{charencumberedmaxdexcount}} & & \arabic{charencumberedcheckpenaltycount} & & \ifthenelse{\value{charencumberedspeedreductioncount}=1}{Yes}{No}
  \tabularnewline[-3pt]
  \cline{1-1}\cline{3-3}\cline{5-5}\tabularnewline[-15pt]
	\scshape\tiny max dex & & \scshape\tiny check penalty & & \scshape\tiny speed reduced
  \end{tabular}}
  
\end{picture}

\newpage

\centering\begin{picture}(420,200)

\singletitlebox{0}{188}{140}{10}{Spells per Day}
\put(0,180){\parbox{20\unitlength}{\scshape\large Class}}
\put(30,177){\framebox(45,10){\charspellcastingclassone}}
\put(77,180){\parbox{20\unitlength}{\scshape\large Level}}
\put(106,177){\framebox(34,10){\cleanarabic{charCLonecount}}}
\stretchlabels{3}{170}{140}{Save DC, Level, Total, Class, Ability Bonus, Misc, Spells Known}
\setlength{\extrarowheight}{5pt}
\put(-2,158){
\begin{tabular}[t]{@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}}
\framebox(18,10){\saveDCone{0}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{0}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone0count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone0count}} & & \framebox(18,10){\cleanarabic{charbonusspellslotsone0count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{1}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{1st}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone1count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone1count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone1count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone1count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{2}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{2nd}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone2count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone2count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone2count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone2count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{3}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{3rd}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone3count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone3count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone3count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone3count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{4}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{4th}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone4count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone4count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone4count}}& \framebox(18,10){\cleanarabic{charbonusspellslotsone4count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{5}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{5th}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone5count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone5count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone5count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone5count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{6}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{6th}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone6count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone6count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone6count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone6count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{7}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{7th}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone7count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone7count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone7count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone7count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{8}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{8th}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone8count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone8count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone8count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone8count}} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCone{9}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{9th}} &\framebox(18,10){\cleanarabic{chartotalspellslotsone9count}} & \framebox(18,10){\cleanarabic{charclassspellslotsone9count}} &\framebox(18,10){\cleanarabic{charabilityspellslotsone9count}} & \framebox(18,10){\cleanarabic{charbonusspellslotsone9count}} &\framebox(18,10){}\tabularnewline
\end{tabular}
}
\calculatespellrange{one}
\put(0,25){\parbox{20\unitlength}{\centering\tiny\scshape Close:\\25 ft+\\5ft/2 lvl}}
\put(21,21){\framebox(22,12){\ifthenelse{\equal{\charspellcastingclassone}{}}{}{
\arabic{charspellrangeclosecount} ft.}}}
\put(44,25){\parbox{20\unitlength}{\centering\tiny\scshape Medium:\\100 ft+\\10ft/lvl}}
\put(65,21){\framebox(25,12){\ifthenelse{\equal{\charspellcastingclassone}{}}{}{
\arabic{charspellrangemediumcount} ft.}}}
\put(91,25){\parbox{20\unitlength}{\centering\tiny\scshape Long:\\400 ft+\\40ft/lvl}}
\put(111,21){\framebox(29,12){\ifthenelse{\equal{\charspellcastingclassone}{}}{}{
\arabic{charspellrangelongcount} ft.}}}

\singletitlebox{280}{188}{140}{10}{Spells per Day}
\put(280,180){\parbox{20\unitlength}{\scshape\large Class}}
\put(310,177){\framebox(45,10){\charspellcastingclasstwo}}
\put(357,180){\parbox{20\unitlength}{\scshape\large Level}}
\put(386,177){\framebox(34,10){\cleanarabic{charCLtwocount}}}
\stretchlabels{283}{170}{420}{Save DC, Level, Total, Class, Ability Bonus, Misc, Spells Known}
\setlength{\extrarowheight}{5pt}
\put(278,158){
\begin{tabular}[t]{@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}@{}>{\centering}p{20\unitlength}}
\framebox(18,10){\saveDCtwo{0}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{0}} &\framebox(18,10){} & \framebox(18,10){} & & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{1}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{1st}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{2}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{2nd}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{3}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{3rd}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{4}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{4th}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{5}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{5th}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{6}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{6th}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{7}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{7th}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{8}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{8th}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}\tabularnewline
\framebox(18,10){\saveDCtwo{9}} & \parbox[t]{18\unitlength}{\vspace{-9pt}\centering\textbf{9th}} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){} & \framebox(18,10){} &\framebox(18,10){}
\end{tabular}
}
\calculatespellrange{two}
\put(280,25){\parbox{20\unitlength}{\centering\tiny\scshape Close:\\25 ft+\\5ft/2 lvl}}
\put(301,21){\framebox(22,12){\ifthenelse{\equal{\charspellcastingclasstwo}{}}{}{
\arabic{charspellrangeclosecount} ft.}}}
\put(324,25){\parbox{20\unitlength}{\centering\tiny\scshape Medium:\\100 ft+\\10ft/lvl}}
\put(345,21){\framebox(25,12){\ifthenelse{\equal{\charspellcastingclasstwo}{}}{}{
\arabic{charspellrangemediumcount} ft.}}}
\put(371,25){\parbox{20\unitlength}{\centering\tiny\scshape Long:\\400 ft+\\40ft/lvl}}
\put(391,21){\framebox(29,12){\ifthenelse{\equal{\charspellcastingclasstwo}{}}{}{
\arabic{charspellrangelongcount} ft.}}}


\singletitlebox{145}{188}{130}{10}{Bloodlines, Domains, Etc.}
\put(145,180){\parbox{54\unitlength}{\raggedleft\scshape\small \spellspecializationonetype}}
\put(200,177){\framebox(75,10){\spellspecializationone}}
\put(145,168){\parbox{54\unitlength}{\raggedleft\scshape\small \spellspecializationtwotype}}
\put(200,165){\framebox(75,10){\spellspecializationtwo}}
\put(145,156){\parbox{54\unitlength}{\raggedleft\scshape\small \spellspecializationthreetype}}
\put(200,153){\framebox(75,10){\spellspecializationthree}}
\put(145,142){\parbox{54\unitlength}{\raggedleft\scshape\small \spellprohibitiononetype}}
\put(200,139){\framebox(75,10){\spellprohibitionone}}
\put(145,130){\parbox{54\unitlength}{\raggedleft\scshape\small \spellprohibitiontwotype}}
\put(200,127){\framebox(75,10){\spellprohibitiontwo}}
\put(147,115){\parbox{20\unitlength}{\scshape Notes}}
\put(145,21){\framebox(130,100){}}
\renewcommand{\do}[1]{
#1;\\}
\put(147,107){\parbox[t]{126\unitlength}{\dolistloop{\spellcastingnoteslist}}}

\singletitlebox{2}{6}{420}{12}{Spells}
\end{picture}
\noindent\vspace{-15.5\unitlength}
\renewcommand*{\do}[1]{ %
\csname #1\endcsname
}
\setlength{\tabcolsep}{.1cm}
\centering
\begin{longtable}{@{}|>{\centering}p{.7cm}|>{\centering}p{.7cm}|>{\centering}p{.7cm}|p{6cm}|>{\centering}p{2cm}|>{\centering}p{2.6cm}|>{\centering}p{1.6cm}|>{\centering}p{1.5cm}|>{\centering\arraybackslash}p{1.3cm}|@{}}
\hline
Lvl &Prep&Used& Name and Description & School & Duration & Range & Save & SR\\\hline
\endfirsthead
\hline
Lvl &Prep&Used& Name and Description & School & Duration & Range & Save & SR\\\hline
\endhead
\endfoot
\endlastfoot
\dolistloop{\cantrips}
\dolistloop{\firstspells}
\dolistloop{\secondspells}
\dolistloop{\thirdspells}
\dolistloop{\fourthspells}
\dolistloop{\fifthspells}
\dolistloop{\sixthspells}
\dolistloop{\seventhspells}
\dolistloop{\eighthspells}
\dolistloop{\ninthspells}
\end{longtable}

%%% Unfortunately, right now I don't have this set up to generate spell lists for multiple classes (For a Mystic Theurge, for example).  It wouldn't be a lot of extra work to add that though.

\newlength{\currentparindent}
\setlength{\currentparindent}{\parindent}
\renewcommand{\do}[1]{
\noindent
\begin{minipage}{\columnwidth}
\setlength{\parindent}{\currentparindent}
\expandafter\csname spell#1header\endcsname
\end{minipage}

\expandafter\csname spell#1description\endcsname

\vspace{10pt}
}
\justifying
\ifthenelse{-1<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc Cantrips}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\cantrips} \end{multicols}
\ifthenelse{0<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 1\textup{st} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\firstspells} \end{multicols}
\ifthenelse{1<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 2\textup{nd} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\secondspells} \end{multicols}
\ifthenelse{2<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 3\textup{rd} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\thirdspells} \end{multicols}
\ifthenelse{3<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 4\textup{th} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\fourthspells} \end{multicols}
\ifthenelse{4<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 5\textup{th} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\fifthspells} \end{multicols}
\ifthenelse{5<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 6\textup{th} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\sixthspells} \end{multicols}
\ifthenelse{6<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 7\textup{th} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\seventhspells} \end{multicols}
\ifthenelse{7<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 8\textup{th} Level Spells}\vspace{1pt}\hrule}{}
\begin{multicols}{2} \dolistloop{\eighthspells} \end{multicols}
\ifthenelse{8<\value{charspellcastingclassonemaxspelllevelcount}}{\newpage\noindent\hrule\vspace{2pt} {\huge\bf\sc 9\textup{th} Level Spells}\vspace{1pt}\hrule}{}
\dolistloop{\ninthspells}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 



